<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aide-m√©moire Windows Terminal : workflows pratiques PowerShell et CMD pour l'administration syst√®me.">
    <title>Windows Terminal - IT Cheatsheets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body class="dark-theme text-slate-200">

    <header class="bg-slate-900/50 border-b border-white/5 py-8 px-4 relative overflow-hidden header-glow">
        <div class="max-w-4xl mx-auto relative z-10">
            <div class="flex items-center justify-between mb-4">
                <a href="../index.html" class="nav-back inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-arrow-left mr-2"></i>Retour
                </a>
                <a href="../index.html" class="inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-home mr-2"></i>Accueil
                </a>
            </div>
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-xl bg-blue-500/20 mb-4 icon-glow">
                    <i class="fab fa-windows text-3xl text-blue-400"></i>
                </div>
                <h1 class="text-3xl font-bold mb-2 gradient-text">Windows Terminal</h1>
                <p class="text-slate-400">Workflows pratiques PowerShell et CMD pour l'administration</p>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-4 relative z-10">
        <div class="mb-8 relative">
            <input type="text" id="searchInput" placeholder="Rechercher un workflow..."
                   class="search-dark w-full p-4 pl-12 rounded-lg outline-none transition">
            <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-500"></i>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="categoriesGrid"></div>
    </main>

    <div id="detailModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50 p-4 modal-overlay" onclick="closeModal(event)">
        <div class="modal-content-dark rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl modal-content" onclick="event.stopPropagation()">
            <div id="modalContent"></div>
        </div>
    </div>

    <footer class="border-t border-white/5 text-center text-slate-500 py-8 text-sm relative z-10">
        <p>¬© 2026 - Dr FENOHASINA Toto Jean Felicien</p>
    </footer>

    <script>
        const cheatsheetData = [
            {
                id: 'start-terminal',
                title: 'üöÄ D√©marrer avec le Terminal',
                icon: 'fa-terminal',
                color: 'border-l-4 border-blue-500',
                commands: [
                    {
                        cmd: 'Naviguer dans les dossiers',
                        desc: 'cd, Set-Location, chemins',
                        details: {
                            explanation: 'Se d√©placer dans l\'arborescence des fichiers avec CMD ou PowerShell.',
                            syntax: 'cd [chemin]\nSet-Location [chemin]',
                            options: [
                                { flag: 'cd ..', desc: 'Remonter d\'un niveau' },
                                { flag: 'cd \\', desc: 'Aller √† la racine du lecteur' },
                                { flag: 'cd /d D:', desc: 'Changer de lecteur (CMD)' },
                                { flag: 'Push-Location / Pop-Location', desc: 'Pile de r√©pertoires (PS)' }
                            ],
                            examples: [
                                { code: 'cd C:\\Users\\Documents', desc: 'Chemin absolu' },
                                { code: 'cd ..\\projet', desc: 'Chemin relatif' },
                                { code: 'Set-Location D:\\Data', desc: 'PowerShell complet' },
                                { code: 'Push-Location C:\\Temp\n# ... travailler ...\nPop-Location', desc: 'Revenir automatiquement' }
                            ],
                            tips: ['En PowerShell, cd est un alias de Set-Location', 'Tab pour l\'autocompl√©tion des chemins'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Lister le contenu d\'un dossier',
                        desc: 'dir, Get-ChildItem, ls',
                        details: {
                            explanation: 'Afficher les fichiers et dossiers du r√©pertoire courant ou sp√©cifi√©.',
                            syntax: 'dir [chemin] [options]\nGet-ChildItem [chemin] [options]',
                            options: [
                                { flag: '/a ou -Force', desc: 'Afficher les fichiers cach√©s' },
                                { flag: '/s ou -Recurse', desc: 'R√©cursif (sous-dossiers)' },
                                { flag: '/b', desc: 'Format simple (noms seulement)' },
                                { flag: '-Filter *.txt', desc: 'Filtrer par extension (PS)' }
                            ],
                            examples: [
                                { code: 'dir', desc: 'Liste du dossier courant' },
                                { code: 'dir /a /s *.log', desc: 'Tous les .log r√©cursivement' },
                                { code: 'Get-ChildItem -Recurse -Filter *.ps1', desc: 'Scripts PowerShell' },
                                { code: 'Get-ChildItem | Sort-Object LastWriteTime -Descending', desc: 'Tri√©s par date' }
                            ],
                            tips: ['ls et gci sont des alias de Get-ChildItem en PowerShell'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Obtenir de l\'aide sur une commande',
                        desc: 'Get-Help, /?, man',
                        details: {
                            explanation: 'Afficher la documentation d\'une commande ou cmdlet.',
                            syntax: 'Get-Help commande [-Full] [-Examples]\ncommande /?',
                            options: [
                                { flag: '-Full', desc: 'Aide compl√®te' },
                                { flag: '-Examples', desc: 'Exemples seulement' },
                                { flag: '-Online', desc: 'Ouvrir l\'aide en ligne' },
                                { flag: 'Update-Help', desc: 'T√©l√©charger l\'aide locale' }
                            ],
                            examples: [
                                { code: 'Get-Help Get-Process', desc: 'Aide basique' },
                                { code: 'Get-Help Get-Service -Examples', desc: 'Voir les exemples' },
                                { code: 'Get-Help *process*', desc: 'Chercher par mot-cl√©' },
                                { code: 'robocopy /?', desc: 'Aide CMD classique' }
                            ],
                            tips: ['Ex√©cutez Update-Help en admin pour t√©l√©charger l\'aide compl√®te'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'G√©rer les processus en cours',
                        desc: 'Get-Process, Stop-Process, tasklist',
                        details: {
                            explanation: 'Afficher et contr√¥ler les processus en cours d\'ex√©cution.',
                            syntax: 'Get-Process [nom]\nStop-Process -Name nom',
                            options: [
                                { flag: '-Name', desc: 'Filtrer par nom' },
                                { flag: '-Id', desc: 'Filtrer par PID' },
                                { flag: 'Sort-Object CPU', desc: 'Trier par CPU' }
                            ],
                            examples: [
                                { code: 'Get-Process', desc: 'Tous les processus' },
                                { code: 'Get-Process chrome', desc: 'Processus Chrome' },
                                { code: 'Get-Process | Sort-Object CPU -Descending | Select-Object -First 10', desc: 'Top 10 CPU' },
                                { code: 'Stop-Process -Name notepad', desc: 'Fermer Notepad' },
                                { code: 'tasklist /fi "memusage gt 100000"', desc: 'CMD: processus > 100MB' }
                            ],
                            tips: ['Ctrl+C pour annuler une commande en cours'],
                            warnings: ['Stop-Process tue le processus sans sauvegarde']
                        }
                    },
                    {
                        cmd: 'G√©rer les services Windows',
                        desc: 'Get-Service, Start-Service, Stop-Service',
                        details: {
                            explanation: 'Afficher et contr√¥ler les services Windows.',
                            syntax: 'Get-Service [nom]\nStart-Service -Name nom',
                            options: [
                                { flag: '-Name', desc: 'Filtrer par nom' },
                                { flag: '-Status Running', desc: 'Services en cours' },
                                { flag: 'Restart-Service', desc: 'Red√©marrer un service' }
                            ],
                            examples: [
                                { code: 'Get-Service', desc: 'Tous les services' },
                                { code: 'Get-Service -Status Running', desc: 'Services actifs' },
                                { code: 'Get-Service wuauserv | Select-Object *', desc: 'D√©tails Windows Update' },
                                { code: 'Restart-Service -Name Spooler', desc: 'Red√©marrer le spooler d\'impression' }
                            ],
                            tips: ['sc query (CMD) pour une alternative'],
                            warnings: ['N√©cessite les droits administrateur']
                        }
                    }
                ]
            },
            {
                id: 'manage-files',
                title: 'üìÅ Organiser mes Fichiers',
                icon: 'fa-folder-open',
                color: 'border-l-4 border-green-500',
                commands: [
                    {
                        cmd: 'Copier des fichiers',
                        desc: 'copy, Copy-Item, xcopy',
                        details: {
                            explanation: 'Copier un ou plusieurs fichiers vers une destination.',
                            syntax: 'copy source destination [options]\nCopy-Item source -Destination dest',
                            options: [
                                { flag: '/y', desc: 'Sans confirmation (CMD)' },
                                { flag: '-Recurse', desc: 'Inclure sous-dossiers (PS)' },
                                { flag: '-Force', desc: '√âcraser sans demander (PS)' }
                            ],
                            examples: [
                                { code: 'copy fichier.txt D:\\backup\\', desc: 'Copier vers backup' },
                                { code: 'copy *.txt documents\\', desc: 'Copier tous les .txt' },
                                { code: 'Copy-Item -Path C:\\Data -Destination D:\\Backup -Recurse', desc: 'Copier un dossier entier' },
                                { code: 'xcopy C:\\Source D:\\Dest /E /H /C /I', desc: 'xcopy robuste' }
                            ],
                            tips: ['robocopy pour des copies avanc√©es avec reprise'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'D√©placer et renommer',
                        desc: 'move, Move-Item, Rename-Item',
                        details: {
                            explanation: 'D√©placer ou renommer des fichiers et dossiers.',
                            syntax: 'move source destination\nMove-Item source -Destination dest',
                            options: [
                                { flag: '/y', desc: 'Sans confirmation (CMD)' },
                                { flag: 'Rename-Item', desc: 'Renommer sur place' }
                            ],
                            examples: [
                                { code: 'move ancien.txt nouveau.txt', desc: 'Renommer' },
                                { code: 'move fichier.txt D:\\dossier\\', desc: 'D√©placer' },
                                { code: 'Move-Item *.log -Destination D:\\Archives', desc: 'D√©placer tous les logs' },
                                { code: 'Get-ChildItem *.txt | Rename-Item -NewName { $_.Name -replace ".txt",".bak" }', desc: 'Renommer en masse' }
                            ],
                            tips: ['Fonctionne aussi pour les dossiers'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Supprimer des fichiers',
                        desc: 'del, Remove-Item, rmdir',
                        details: {
                            explanation: 'Supprimer des fichiers ou dossiers.',
                            syntax: 'del fichier [options]\nRemove-Item chemin [-Recurse]',
                            options: [
                                { flag: '/q', desc: 'Mode silencieux (CMD)' },
                                { flag: '/f', desc: 'Forcer (fichiers readonly)' },
                                { flag: '-Recurse', desc: 'Supprimer r√©cursivement (PS)' },
                                { flag: '-WhatIf', desc: 'Simuler sans supprimer (PS)' }
                            ],
                            examples: [
                                { code: 'del fichier.txt', desc: 'Supprimer un fichier' },
                                { code: 'del /q *.tmp', desc: 'Supprimer les .tmp sans confirmation' },
                                { code: 'Remove-Item C:\\Temp\\* -Recurse -WhatIf', desc: 'Simuler suppression' },
                                { code: 'rmdir /s /q dossier', desc: 'Supprimer dossier et contenu' }
                            ],
                            tips: ['-WhatIf permet de voir ce qui serait supprim√©'],
                            warnings: ['Pas de corbeille en ligne de commande !']
                        }
                    },
                    {
                        cmd: 'Rechercher des fichiers',
                        desc: 'where, Get-ChildItem -Recurse, findstr',
                        details: {
                            explanation: 'Trouver des fichiers par nom ou contenu.',
                            syntax: 'where /r chemin pattern\nGet-ChildItem -Recurse -Filter pattern',
                            options: [
                                { flag: '/r', desc: 'Recherche r√©cursive (CMD)' },
                                { flag: '-Filter', desc: 'Pattern de fichier (PS)' },
                                { flag: 'Select-String', desc: 'Recherche dans le contenu' }
                            ],
                            examples: [
                                { code: 'where /r C:\\ *.log', desc: 'Trouver tous les .log' },
                                { code: 'Get-ChildItem -Recurse -Filter "config*"', desc: 'Fichiers commen√ßant par config' },
                                { code: 'Get-ChildItem -Recurse | Where-Object { $_.Length -gt 100MB }', desc: 'Fichiers > 100MB' },
                                { code: 'Select-String -Path *.log -Pattern "error" -SimpleMatch', desc: 'Chercher "error" dans les logs' }
                            ],
                            tips: ['Select-String est le grep de PowerShell'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Copie robuste avec robocopy',
                        desc: 'robocopy, miroir, reprise',
                        details: {
                            explanation: 'Outil de copie avanc√© avec reprise, miroir et options de filtrage.',
                            syntax: 'robocopy source destination [options]',
                            options: [
                                { flag: '/E', desc: 'Copier sous-dossiers (m√™me vides)' },
                                { flag: '/MIR', desc: 'Mode miroir (synchronisation)' },
                                { flag: '/Z', desc: 'Mode reprise (restartable)' },
                                { flag: '/MT:N', desc: 'Multi-thread (N threads)' },
                                { flag: '/XD dossier', desc: 'Exclure des dossiers' },
                                { flag: '/LOG:file', desc: 'Journaliser' }
                            ],
                            examples: [
                                { code: 'robocopy C:\\Data D:\\Backup /E', desc: 'Copier tout le contenu' },
                                { code: 'robocopy C:\\Data D:\\Backup /MIR', desc: 'Synchroniser (miroir exact)' },
                                { code: 'robocopy C:\\Data D:\\Backup /E /Z /MT:8 /R:3 /W:10', desc: 'Copie multi-thread avec retry' },
                                { code: 'robocopy C:\\Web D:\\Backup /E /XD node_modules .git', desc: 'Exclure node_modules et .git' }
                            ],
                            tips: ['/MT:8 am√©liore consid√©rablement les performances'],
                            warnings: ['/MIR supprime les fichiers de destination qui n\'existent plus dans la source']
                        }
                    }
                ]
            },
            {
                id: 'configure-env',
                title: 'üîß Configurer mon Environnement',
                icon: 'fa-cog',
                color: 'border-l-4 border-yellow-500',
                commands: [
                    {
                        cmd: 'G√©rer les variables d\'environnement',
                        desc: '$env:, set, setx',
                        details: {
                            explanation: 'Lire et d√©finir des variables d\'environnement (session ou permanentes).',
                            syntax: 'set VAR=value (CMD)\n$env:VAR = "value" (PS)',
                            options: [
                                { flag: 'set', desc: 'Variable pour la session (CMD)' },
                                { flag: 'setx', desc: 'Variable permanente (CMD)' },
                                { flag: '$env:VAR', desc: 'Acc√©der/d√©finir en PowerShell' },
                                { flag: '/M', desc: 'Variable machine (syst√®me)' }
                            ],
                            examples: [
                                { code: 'echo %PATH%', desc: 'Afficher PATH (CMD)' },
                                { code: '$env:PATH', desc: 'Afficher PATH (PowerShell)' },
                                { code: 'set MY_VAR=hello', desc: 'Variable temporaire (CMD)' },
                                { code: 'setx MY_VAR "hello" /M', desc: 'Variable syst√®me permanente' },
                                { code: '[Environment]::SetEnvironmentVariable("MY_VAR", "hello", "User")', desc: 'Variable permanente (PS)' }
                            ],
                            tips: ['setx n√©cessite une nouvelle fen√™tre pour prendre effet'],
                            warnings: ['setx tronque les valeurs > 1024 caract√®res']
                        }
                    },
                    {
                        cmd: 'Modifier le PATH',
                        desc: 'Ajouter des chemins d\'ex√©cution',
                        details: {
                            explanation: 'Ajouter un r√©pertoire au PATH pour ex√©cuter des programmes sans chemin complet.',
                            syntax: 'setx PATH "%PATH%;nouveau_chemin"',
                            options: [
                                { flag: '/M', desc: 'Variable Machine (syst√®me)' },
                                { flag: 'User', desc: 'Variable utilisateur (d√©faut)' }
                            ],
                            examples: [
                                { code: '$env:PATH -split ";"', desc: 'Afficher PATH ligne par ligne' },
                                { code: 'setx PATH "%PATH%;C:\\Tools\\bin"', desc: 'Ajouter au PATH utilisateur (CMD)' },
                                { code: '$newPath = $env:PATH + ";C:\\Tools\\bin"\n[Environment]::SetEnvironmentVariable("PATH", $newPath, "User")', desc: 'PowerShell permanent' },
                                { code: '$env:PATH += ";C:\\Tools\\bin"', desc: 'PowerShell session seulement' }
                            ],
                            tips: ['Red√©marrez le terminal apr√®s setx'],
                            warnings: ['Attention √† ne pas √©craser le PATH existant']
                        }
                    },
                    {
                        cmd: 'Lister toutes les variables',
                        desc: 'Get-ChildItem Env:, set',
                        details: {
                            explanation: 'Afficher toutes les variables d\'environnement du syst√®me.',
                            syntax: 'Get-ChildItem Env:\nset',
                            options: [],
                            examples: [
                                { code: 'Get-ChildItem Env: | Sort-Object Name', desc: 'Toutes les variables (PS)' },
                                { code: 'Get-ChildItem Env: | Where-Object Name -like "*PATH*"', desc: 'Filtrer par nom' },
                                { code: 'set', desc: '√âquivalent CMD' },
                                { code: '[Environment]::GetEnvironmentVariables("Machine")', desc: 'Variables syst√®me uniquement' }
                            ],
                            tips: ['Env: est un provider PowerShell comme un lecteur'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Personnaliser le profil PowerShell',
                        desc: '$PROFILE, prompt, alias',
                        details: {
                            explanation: 'Configurer le d√©marrage de PowerShell avec des alias et fonctions personnalis√©es.',
                            syntax: 'notepad $PROFILE',
                            options: [
                                { flag: '$PROFILE', desc: 'Chemin du profil utilisateur' },
                                { flag: 'Set-Alias', desc: 'Cr√©er un alias' },
                                { flag: 'function', desc: 'Cr√©er une fonction' }
                            ],
                            examples: [
                                { code: 'Test-Path $PROFILE', desc: 'V√©rifier si le profil existe' },
                                { code: 'New-Item -Path $PROFILE -ItemType File -Force', desc: 'Cr√©er le profil' },
                                { code: '# Dans $PROFILE:\nSet-Alias -Name np -Value notepad\nSet-Alias -Name ll -Value Get-ChildItem\n\nfunction prompt {\n    "$PWD> "\n}', desc: 'Exemple de profil' },
                                { code: '. $PROFILE', desc: 'Recharger le profil' }
                            ],
                            tips: ['Le profil est ex√©cut√© √† chaque ouverture de PowerShell'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'diagnose-network',
                title: 'üåê Diagnostiquer le R√©seau',
                icon: 'fa-network-wired',
                color: 'border-l-4 border-orange-500',
                commands: [
                    {
                        cmd: 'Voir ma configuration IP',
                        desc: 'ipconfig, Get-NetIPAddress',
                        details: {
                            explanation: 'Afficher la configuration r√©seau de toutes les interfaces.',
                            syntax: 'ipconfig [options]\nGet-NetIPAddress',
                            options: [
                                { flag: '/all', desc: 'Informations d√©taill√©es' },
                                { flag: '/release', desc: 'Lib√©rer l\'adresse IP DHCP' },
                                { flag: '/renew', desc: 'Renouveler l\'adresse IP DHCP' },
                                { flag: '/flushdns', desc: 'Vider le cache DNS' }
                            ],
                            examples: [
                                { code: 'ipconfig', desc: 'Config basique' },
                                { code: 'ipconfig /all', desc: 'Tout voir (MAC, DNS, etc.)' },
                                { code: 'ipconfig /flushdns', desc: 'R√©soudre probl√®mes DNS' },
                                { code: 'Get-NetIPAddress | Where-Object AddressFamily -eq "IPv4"', desc: 'IPs v4 uniquement (PS)' }
                            ],
                            tips: ['Get-NetAdapter pour voir l\'√©tat des cartes r√©seau'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Tester la connectivit√©',
                        desc: 'ping, Test-Connection, tracert',
                        details: {
                            explanation: 'V√©rifier si une machine est accessible sur le r√©seau.',
                            syntax: 'ping [options] adresse\nTest-Connection adresse',
                            options: [
                                { flag: '-t', desc: 'Ping continu (Ctrl+C pour arr√™ter)' },
                                { flag: '-n count', desc: 'Nombre de pings' },
                                { flag: '-Count (PS)', desc: 'Nombre de pings en PowerShell' }
                            ],
                            examples: [
                                { code: 'ping google.com', desc: 'Tester connexion internet' },
                                { code: 'ping -t 192.168.1.1', desc: 'Ping continu vers la box' },
                                { code: 'Test-Connection google.com -Count 4', desc: 'PowerShell' },
                                { code: 'tracert google.com', desc: 'Tracer la route' }
                            ],
                            tips: ['ping localhost pour tester la pile TCP/IP locale'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'R√©soudre les noms DNS',
                        desc: 'nslookup, Resolve-DnsName',
                        details: {
                            explanation: 'Interroger les serveurs DNS pour r√©soudre des noms de domaine.',
                            syntax: 'nslookup domaine [serveur]\nResolve-DnsName domaine',
                            options: [
                                { flag: '-type=MX', desc: 'Enregistrements mail' },
                                { flag: '-type=TXT', desc: 'Enregistrements texte' },
                                { flag: '-Type (PS)', desc: 'Type d\'enregistrement' }
                            ],
                            examples: [
                                { code: 'nslookup google.com', desc: 'R√©solution basique' },
                                { code: 'nslookup -type=MX gmail.com', desc: 'Serveurs mail' },
                                { code: 'Resolve-DnsName google.com', desc: 'PowerShell' },
                                { code: 'Resolve-DnsName google.com -Type A -Server 8.8.8.8', desc: 'Avec DNS Google' }
                            ],
                            tips: ['Utile pour diagnostiquer les probl√®mes DNS'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Voir les connexions actives',
                        desc: 'netstat, Get-NetTCPConnection',
                        details: {
                            explanation: 'Afficher les connexions r√©seau et les ports ouverts.',
                            syntax: 'netstat [options]\nGet-NetTCPConnection',
                            options: [
                                { flag: '-a', desc: 'Toutes les connexions' },
                                { flag: '-n', desc: 'Adresses num√©riques' },
                                { flag: '-o', desc: 'Afficher les PID' },
                                { flag: '-b', desc: 'Afficher les ex√©cutables' }
                            ],
                            examples: [
                                { code: 'netstat -ano', desc: 'Connexions avec PID' },
                                { code: 'netstat -ano | findstr :80', desc: 'Qui √©coute sur le port 80' },
                                { code: 'Get-NetTCPConnection | Where-Object State -eq "Listen"', desc: 'Ports en √©coute (PS)' },
                                { code: 'Get-NetTCPConnection -LocalPort 443 | Select-Object OwningProcess', desc: 'Processus sur port 443' }
                            ],
                            tips: ['Combinez avec tasklist pour voir le nom du processus'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Tester un port distant',
                        desc: 'Test-NetConnection, telnet',
                        details: {
                            explanation: 'V√©rifier si un port est ouvert sur une machine distante.',
                            syntax: 'Test-NetConnection -ComputerName host -Port port',
                            options: [
                                { flag: '-Port', desc: 'Port √† tester' },
                                { flag: '-InformationLevel Detailed', desc: 'D√©tails complets' }
                            ],
                            examples: [
                                { code: 'Test-NetConnection google.com -Port 443', desc: 'Tester HTTPS' },
                                { code: 'Test-NetConnection 192.168.1.1 -Port 22', desc: 'Tester SSH' },
                                { code: 'Test-NetConnection -ComputerName mail.server.com -Port 25 -InformationLevel Detailed', desc: 'Test SMTP d√©taill√©' },
                                { code: '1..1024 | ForEach-Object { if ((Test-NetConnection localhost -Port $_ -WarningAction SilentlyContinue).TcpTestSucceeded) { $_ } }', desc: 'Scanner les ports ouverts' }
                            ],
                            tips: ['TcpTestSucceeded = $true si le port est ouvert'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'manage-disks',
                title: 'üíæ G√©rer mes Disques',
                icon: 'fa-hdd',
                color: 'border-l-4 border-cyan-500',
                commands: [
                    {
                        cmd: 'Voir l\'espace disque',
                        desc: 'Get-Volume, Get-Disk, wmic',
                        details: {
                            explanation: 'Afficher les informations sur les volumes et l\'espace disponible.',
                            syntax: 'Get-Volume\nGet-Disk',
                            options: [
                                { flag: 'Get-Volume', desc: 'Liste tous les volumes' },
                                { flag: 'Get-Disk', desc: 'Liste tous les disques physiques' },
                                { flag: 'Get-Partition', desc: 'Liste les partitions' }
                            ],
                            examples: [
                                { code: 'Get-Volume', desc: 'Tous les volumes avec taille et espace libre' },
                                { code: 'Get-Volume | Where-Object {$_.SizeRemaining -lt 10GB}', desc: 'Volumes avec moins de 10 Go' },
                                { code: 'Get-Disk | Format-Table Number, FriendlyName, Size, PartitionStyle', desc: 'Info disques physiques' },
                                { code: 'wmic logicaldisk get size,freespace,caption', desc: 'CMD classique' }
                            ],
                            tips: ['Utilisez Format-Table pour personnaliser l\'affichage'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'G√©rer les partitions',
                        desc: 'diskpart, Get-Partition',
                        details: {
                            explanation: 'G√©rer les disques et partitions du syst√®me.',
                            syntax: 'diskpart (mode interactif)',
                            options: [
                                { flag: 'list disk', desc: 'Lister les disques' },
                                { flag: 'select disk N', desc: 'S√©lectionner un disque' },
                                { flag: 'list partition', desc: 'Lister les partitions' },
                                { flag: 'clean', desc: 'Effacer le disque s√©lectionn√©' }
                            ],
                            examples: [
                                { code: 'diskpart\nlist disk\nselect disk 1\nlist partition', desc: 'Voir les partitions du disque 1' },
                                { code: 'Get-Partition -DiskNumber 0 | Format-Table', desc: 'PowerShell' },
                                { code: 'Resize-Partition -DriveLetter C -Size 100GB', desc: 'Redimensionner C: √† 100GB' },
                                { code: 'echo list disk | diskpart', desc: 'Commande non-interactive' }
                            ],
                            tips: ['clean efface TOUT le disque sans confirmation'],
                            warnings: ['Attention: actions irr√©versibles ! V√©rifiez le disque s√©lectionn√©']
                        }
                    },
                    {
                        cmd: 'Nettoyer l\'espace disque',
                        desc: 'cleanmgr, Remove-Item temporaires',
                        details: {
                            explanation: 'Lib√©rer de l\'espace en supprimant les fichiers temporaires.',
                            syntax: 'cleanmgr /d C:\nRemove-Item $env:TEMP\\* -Recurse',
                            options: [
                                { flag: '/d', desc: 'Lecteur √† nettoyer' },
                                { flag: '/sageset:N', desc: 'Configurer les options' },
                                { flag: '/sagerun:N', desc: 'Ex√©cuter avec options sauvegard√©es' }
                            ],
                            examples: [
                                { code: 'cleanmgr /d C:', desc: 'Nettoyage de disque classique' },
                                { code: 'Remove-Item "$env:TEMP\\*" -Recurse -Force -ErrorAction SilentlyContinue', desc: 'Vider le dossier temp utilisateur' },
                                { code: 'Remove-Item "C:\\Windows\\Temp\\*" -Recurse -Force -ErrorAction SilentlyContinue', desc: 'Vider le temp syst√®me (admin)' },
                                { code: 'Clear-RecycleBin -Force', desc: 'Vider la corbeille' }
                            ],
                            tips: ['DISM /Online /Cleanup-Image /StartComponentCleanup pour nettoyer les anciens composants Windows'],
                            warnings: ['V√©rifiez ce que vous supprimez']
                        }
                    },
                    {
                        cmd: 'Analyser l\'utilisation du disque',
                        desc: 'Taille des dossiers, gros fichiers',
                        details: {
                            explanation: 'Trouver ce qui consomme de l\'espace disque.',
                            syntax: 'Get-ChildItem -Recurse | Measure-Object -Property Length -Sum',
                            options: [],
                            examples: [
                                { code: '(Get-ChildItem C:\\Users -Recurse -ErrorAction SilentlyContinue | Measure-Object -Property Length -Sum).Sum / 1GB', desc: 'Taille du dossier Users en GB' },
                                { code: 'Get-ChildItem C:\\ -Recurse -ErrorAction SilentlyContinue | \n  Sort-Object Length -Descending | \n  Select-Object -First 20 FullName, @{N="SizeMB";E={[math]::Round($_.Length/1MB,2)}}', desc: 'Top 20 plus gros fichiers' },
                                { code: 'Get-ChildItem C:\\ -Directory | ForEach-Object {\n  $size = (Get-ChildItem $_.FullName -Recurse -ErrorAction SilentlyContinue | \n           Measure-Object -Property Length -Sum).Sum / 1GB\n  [PSCustomObject]@{Folder=$_.Name; SizeGB=[math]::Round($size,2)}\n} | Sort-Object SizeGB -Descending', desc: 'Taille de chaque dossier racine' }
                            ],
                            tips: ['Utilisez TreeSize ou WinDirStat pour une analyse graphique'],
                            warnings: ['Le scan r√©cursif peut prendre du temps']
                        }
                    }
                ]
            },
            {
                id: 'admin-users',
                title: 'üë• Administrer le Syst√®me',
                icon: 'fa-user-shield',
                color: 'border-l-4 border-red-500',
                commands: [
                    {
                        cmd: 'G√©rer les utilisateurs locaux',
                        desc: 'Get-LocalUser, New-LocalUser',
                        details: {
                            explanation: 'Cr√©er et g√©rer les utilisateurs locaux du syst√®me.',
                            syntax: 'Get-LocalUser\nNew-LocalUser -Name nom',
                            options: [
                                { flag: 'Get-LocalUser', desc: 'Lister les utilisateurs' },
                                { flag: 'New-LocalUser', desc: 'Cr√©er un utilisateur' },
                                { flag: 'Remove-LocalUser', desc: 'Supprimer un utilisateur' },
                                { flag: 'Set-LocalUser', desc: 'Modifier un utilisateur' }
                            ],
                            examples: [
                                { code: 'Get-LocalUser', desc: 'Lister tous les utilisateurs' },
                                { code: 'Get-LocalUser | Where-Object Enabled', desc: 'Utilisateurs actifs' },
                                { code: 'New-LocalUser -Name "dev" -Password (ConvertTo-SecureString "P@ssw0rd" -AsPlainText -Force) -FullName "D√©veloppeur"', desc: 'Cr√©er un utilisateur' },
                                { code: 'Add-LocalGroupMember -Group "Administrators" -Member "dev"', desc: 'Ajouter aux admins' }
                            ],
                            tips: ['Ex√©cutez en tant qu\'Administrateur'],
                            warnings: ['Les mots de passe en clair dans les scripts sont un risque de s√©curit√©']
                        }
                    },
                    {
                        cmd: 'Consulter les logs Windows',
                        desc: 'Get-WinEvent, Get-EventLog',
                        details: {
                            explanation: 'Acc√©der aux journaux d\'√©v√©nements Windows pour le diagnostic.',
                            syntax: 'Get-WinEvent -LogName "System" -MaxEvents 50',
                            options: [
                                { flag: '-LogName', desc: 'Journal (System, Application, Security)' },
                                { flag: '-MaxEvents', desc: 'Limiter le nombre de r√©sultats' },
                                { flag: '-FilterHashtable', desc: 'Filtrage avanc√©' }
                            ],
                            examples: [
                                { code: 'Get-WinEvent -LogName System -MaxEvents 20', desc: 'Derniers √©v√©nements syst√®me' },
                                { code: 'Get-WinEvent -FilterHashtable @{LogName="System"; Level=2}', desc: 'Erreurs syst√®me seulement' },
                                { code: 'Get-WinEvent -LogName Application | Where-Object {$_.Message -like "*error*"} | Select-Object -First 10', desc: 'Filtrer par message' },
                                { code: 'Get-EventLog -LogName Security -Newest 10', desc: '√âv√©nements s√©curit√© r√©cents' }
                            ],
                            tips: ['Level: 1=Critical, 2=Error, 3=Warning, 4=Information'],
                            warnings: ['Le journal Security n√©cessite des droits Admin']
                        }
                    },
                    {
                        cmd: 'R√©parer le syst√®me',
                        desc: 'sfc /scannow, DISM',
                        details: {
                            explanation: 'V√©rifier et r√©parer les fichiers syst√®me Windows corrompus.',
                            syntax: 'sfc /scannow\nDISM /Online /Cleanup-Image /RestoreHealth',
                            options: [
                                { flag: 'sfc /scannow', desc: 'V√©rifier et r√©parer les fichiers syst√®me' },
                                { flag: 'sfc /verifyonly', desc: 'V√©rifier sans r√©parer' },
                                { flag: 'DISM /RestoreHealth', desc: 'R√©parer le magasin de composants' }
                            ],
                            examples: [
                                { code: 'sfc /scannow', desc: 'Scan et r√©paration automatique' },
                                { code: 'DISM /Online /Cleanup-Image /CheckHealth', desc: 'V√©rifier l\'√©tat de l\'image' },
                                { code: 'DISM /Online /Cleanup-Image /RestoreHealth', desc: 'R√©parer l\'image Windows' },
                                { code: 'DISM /Online /Cleanup-Image /StartComponentCleanup', desc: 'Nettoyer les anciens composants' }
                            ],
                            tips: ['Ex√©cutez DISM avant sfc pour de meilleurs r√©sultats'],
                            warnings: ['Ces commandes n√©cessitent les droits Administrateur']
                        }
                    },
                    {
                        cmd: 'Informations syst√®me',
                        desc: 'systeminfo, Get-ComputerInfo',
                        details: {
                            explanation: 'Afficher les informations d√©taill√©es sur le syst√®me.',
                            syntax: 'systeminfo\nGet-ComputerInfo',
                            options: [],
                            examples: [
                                { code: 'systeminfo', desc: 'Infos compl√®tes (CMD)' },
                                { code: 'systeminfo | findstr /C:"OS"', desc: 'Filtrer par OS' },
                                { code: 'Get-ComputerInfo | Select-Object WindowsVersion, OsArchitecture, CsTotalPhysicalMemory', desc: 'Infos s√©lectionn√©es' },
                                { code: '(Get-ComputerInfo).WindowsProductName', desc: 'Nom du produit Windows' }
                            ],
                            tips: ['Get-ComputerInfo est plus complet que systeminfo'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'automate-powershell',
                title: '‚ö° Automatiser avec PowerShell',
                icon: 'fa-code',
                color: 'border-l-4 border-indigo-500',
                commands: [
                    {
                        cmd: 'Variables et types',
                        desc: '$variable, [type], @(), @{}',
                        details: {
                            explanation: 'PowerShell utilise $ pour les variables et supporte les types .NET.',
                            syntax: '$variable = valeur\n[type]$variable = valeur',
                            options: [
                                { flag: '[string]', desc: 'Cha√Æne de caract√®res' },
                                { flag: '[int]', desc: 'Entier' },
                                { flag: '@()', desc: 'Tableau' },
                                { flag: '@{}', desc: 'Table de hachage' }
                            ],
                            examples: [
                                { code: '$name = "John"\n$age = 30\n$enabled = $true', desc: 'Variables de base' },
                                { code: '[int]$port = "8080"\n[datetime]$date = "2024-01-15"', desc: 'Variables typ√©es' },
                                { code: '$array = @(1, 2, 3, 4, 5)\n$array[0]  # Premier √©l√©ment', desc: 'Tableau' },
                                { code: '$hash = @{\n  Name = "Server01"\n  IP = "192.168.1.1"\n}\n$hash.Name', desc: 'Hashtable' }
                            ],
                            tips: ['$null, $true, $false sont des valeurs sp√©ciales'],
                            warnings: ['Les guillemets doubles interpr√®tent les variables, les simples non']
                        }
                    },
                    {
                        cmd: 'Conditions et boucles',
                        desc: 'if, switch, foreach, while',
                        details: {
                            explanation: 'Structures de contr√¥le pour la logique de script.',
                            syntax: 'if (condition) { } else { }\nforeach ($item in $collection) { }',
                            options: [
                                { flag: '-eq, -ne', desc: '√âgal, non √©gal' },
                                { flag: '-gt, -lt', desc: 'Plus grand, plus petit' },
                                { flag: '-like, -match', desc: 'Pattern matching' },
                                { flag: '-and, -or', desc: 'Op√©rateurs logiques' }
                            ],
                            examples: [
                                { code: 'if ($age -ge 18) {\n  Write-Host "Majeur"\n} else {\n  Write-Host "Mineur"\n}', desc: 'Condition if/else' },
                                { code: 'switch ($status) {\n  "Running" { "OK" }\n  "Stopped" { "Arr√™t√©" }\n  default { "Inconnu" }\n}', desc: 'Switch' },
                                { code: 'foreach ($file in Get-ChildItem *.txt) {\n  Write-Host $file.Name\n}', desc: 'Boucle foreach' },
                                { code: '1..10 | ForEach-Object { $_ * 2 }', desc: 'Pipeline ForEach' }
                            ],
                            tips: ['$_ repr√©sente l\'objet courant dans le pipeline'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Cr√©er des fonctions',
                        desc: 'function, param, return',
                        details: {
                            explanation: 'Cr√©er des fonctions r√©utilisables avec param√®tres.',
                            syntax: 'function Nom-Fonction {\n  param([type]$param)\n  # code\n}',
                            options: [
                                { flag: 'param()', desc: 'D√©claration des param√®tres' },
                                { flag: '[Parameter(Mandatory)]', desc: 'Param√®tre obligatoire' },
                                { flag: '[ValidateSet()]', desc: 'Valeurs autoris√©es' }
                            ],
                            examples: [
                                { code: 'function Get-Greeting {\n  param([string]$Name = "World")\n  return "Hello, $Name!"\n}\nGet-Greeting -Name "Jean"', desc: 'Fonction simple' },
                                { code: 'function Get-DiskSpace {\n  param(\n    [Parameter(Mandatory)]\n    [string]$DriveLetter\n  )\n  Get-Volume -DriveLetter $DriveLetter | \n    Select-Object DriveLetter, @{N="FreeGB";E={[math]::Round($_.SizeRemaining/1GB,2)}}\n}', desc: 'Avec param√®tre obligatoire' },
                                { code: 'function Set-LogLevel {\n  param(\n    [ValidateSet("Debug","Info","Warning","Error")]\n    [string]$Level = "Info"\n  )\n  Write-Host "Log level: $Level"\n}', desc: 'Validation de param√®tre' }
                            ],
                            tips: ['Utilisez le verbe-nom standard PowerShell (Get-, Set-, New-, Remove-)'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'G√©rer les erreurs',
                        desc: 'try/catch, -ErrorAction',
                        details: {
                            explanation: 'Capturer et g√©rer les erreurs dans les scripts.',
                            syntax: 'try { } catch { } finally { }',
                            options: [
                                { flag: '$_', desc: 'L\'exception dans le bloc catch' },
                                { flag: '$_.Exception.Message', desc: 'Message d\'erreur' },
                                { flag: '-ErrorAction Stop', desc: 'Transformer les erreurs en exceptions' }
                            ],
                            examples: [
                                { code: 'try {\n  Get-Content "fichier_inexistant.txt" -ErrorAction Stop\n} catch {\n  Write-Host "Erreur: $_"\n}', desc: 'Gestion d\'erreur simple' },
                                { code: 'try {\n  $result = 1/0\n} catch [System.DivideByZeroException] {\n  Write-Host "Division par z√©ro!"\n} catch {\n  Write-Host "Autre erreur: $_"\n} finally {\n  Write-Host "Nettoyage..."\n}', desc: 'Catch typ√© et finally' },
                                { code: '$ErrorActionPreference = "Stop"\n# Toutes les erreurs deviennent des exceptions', desc: 'Mode strict global' }
                            ],
                            tips: ['-ErrorAction Stop est n√©cessaire pour que try/catch fonctionne avec les cmdlets'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Travailler avec les pipelines',
                        desc: '|, Where-Object, Select-Object, ForEach-Object',
                        details: {
                            explanation: 'Cha√Æner les commandes pour filtrer et transformer les donn√©es.',
                            syntax: 'commande1 | commande2 | commande3',
                            options: [
                                { flag: 'Where-Object', desc: 'Filtrer les objets' },
                                { flag: 'Select-Object', desc: 'S√©lectionner des propri√©t√©s' },
                                { flag: 'ForEach-Object', desc: 'Ex√©cuter pour chaque objet' },
                                { flag: 'Sort-Object', desc: 'Trier' }
                            ],
                            examples: [
                                { code: 'Get-Process | Where-Object CPU -gt 100 | Sort-Object CPU -Descending', desc: 'Processus par CPU' },
                                { code: 'Get-Service | Where-Object Status -eq "Running" | Select-Object Name, DisplayName', desc: 'Services actifs' },
                                { code: 'Get-ChildItem *.log | ForEach-Object { $_.Name.ToUpper() }', desc: 'Transformer les noms' },
                                { code: 'Get-Process | Group-Object ProcessName | Sort-Object Count -Descending | Select-Object -First 5', desc: 'Top 5 processus par nombre' }
                            ],
                            tips: ['Utilisez les alias: ? pour Where-Object, % pour ForEach-Object'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'schedule-tasks',
                title: '‚è∞ Planifier des T√¢ches',
                icon: 'fa-clock',
                color: 'border-l-4 border-amber-500',
                commands: [
                    {
                        cmd: 'Voir les t√¢ches planifi√©es',
                        desc: 'Get-ScheduledTask, schtasks /query',
                        details: {
                            explanation: 'Afficher toutes les t√¢ches planifi√©es sur le syst√®me.',
                            syntax: 'Get-ScheduledTask [-TaskName nom]',
                            options: [
                                { flag: '-TaskName', desc: 'Filtrer par nom' },
                                { flag: '-TaskPath', desc: 'Filtrer par chemin' },
                                { flag: 'Get-ScheduledTaskInfo', desc: 'Infos d\'ex√©cution' }
                            ],
                            examples: [
                                { code: 'Get-ScheduledTask', desc: 'Toutes les t√¢ches' },
                                { code: 'Get-ScheduledTask | Where-Object State -eq "Ready"', desc: 'T√¢ches actives' },
                                { code: 'Get-ScheduledTask "MyTask" | Get-ScheduledTaskInfo', desc: 'Derni√®re ex√©cution' },
                                { code: 'schtasks /query /fo TABLE', desc: 'CMD: lister les t√¢ches' }
                            ],
                            tips: ['Combinez avec Get-ScheduledTaskInfo pour voir les derni√®res ex√©cutions'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Cr√©er une t√¢che planifi√©e',
                        desc: 'Register-ScheduledTask, d√©clencheurs',
                        details: {
                            explanation: 'Cr√©er une nouvelle t√¢che avec action et d√©clencheur.',
                            syntax: 'Register-ScheduledTask -TaskName nom -Action action -Trigger trigger',
                            options: [
                                { flag: 'New-ScheduledTaskAction', desc: 'D√©finir l\'action' },
                                { flag: 'New-ScheduledTaskTrigger', desc: 'D√©finir le d√©clencheur' },
                                { flag: 'New-ScheduledTaskPrincipal', desc: 'Contexte d\'ex√©cution' }
                            ],
                            examples: [
                                { code: '$action = New-ScheduledTaskAction -Execute "PowerShell.exe" -Argument "-File C:\\Scripts\\backup.ps1"\n$trigger = New-ScheduledTaskTrigger -Daily -At 2am\nRegister-ScheduledTask -TaskName "DailyBackup" -Action $action -Trigger $trigger', desc: 'T√¢che quotidienne √† 2h' },
                                { code: '$trigger = New-ScheduledTaskTrigger -Weekly -DaysOfWeek Sunday -At 3am\n$principal = New-ScheduledTaskPrincipal -UserId "SYSTEM" -RunLevel Highest\nRegister-ScheduledTask -TaskName "WeeklyCleanup" -Action $action -Trigger $trigger -Principal $principal', desc: 'T√¢che hebdomadaire en SYSTEM' },
                                { code: '$trigger = New-ScheduledTaskTrigger -AtStartup\nRegister-ScheduledTask -TaskName "StartupScript" -Action $action -Trigger $trigger', desc: 'T√¢che au d√©marrage' }
                            ],
                            tips: ['Utilisez -RunLevel Highest pour les t√¢ches admin'],
                            warnings: ['Les t√¢ches SYSTEM s\'ex√©cutent sans interface utilisateur']
                        }
                    },
                    {
                        cmd: 'G√©rer une t√¢che existante',
                        desc: 'Start, Stop, Disable, Unregister',
                        details: {
                            explanation: 'Ex√©cuter, arr√™ter ou supprimer une t√¢che planifi√©e.',
                            syntax: 'Start-ScheduledTask -TaskName nom',
                            options: [
                                { flag: 'Start-ScheduledTask', desc: 'Ex√©cuter maintenant' },
                                { flag: 'Stop-ScheduledTask', desc: 'Arr√™ter l\'ex√©cution' },
                                { flag: 'Disable-ScheduledTask', desc: 'D√©sactiver la t√¢che' },
                                { flag: 'Unregister-ScheduledTask', desc: 'Supprimer la t√¢che' }
                            ],
                            examples: [
                                { code: 'Start-ScheduledTask -TaskName "DailyBackup"', desc: 'Ex√©cuter maintenant' },
                                { code: 'Disable-ScheduledTask -TaskName "DailyBackup"', desc: 'D√©sactiver' },
                                { code: 'Enable-ScheduledTask -TaskName "DailyBackup"', desc: 'R√©activer' },
                                { code: 'Unregister-ScheduledTask -TaskName "DailyBackup" -Confirm:$false', desc: 'Supprimer sans confirmation' }
                            ],
                            tips: ['schtasks /run /tn "TaskName" pour CMD'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'T√¢ches planifi√©es avec CMD',
                        desc: 'schtasks /create, /delete, /run',
                        details: {
                            explanation: 'Commande CMD classique pour g√©rer les t√¢ches planifi√©es.',
                            syntax: 'schtasks /create /tn nom /tr commande /sc schedule',
                            options: [
                                { flag: '/create', desc: 'Cr√©er une t√¢che' },
                                { flag: '/query', desc: 'Lister les t√¢ches' },
                                { flag: '/run', desc: 'Ex√©cuter imm√©diatement' },
                                { flag: '/delete', desc: 'Supprimer une t√¢che' },
                                { flag: '/sc', desc: 'Type (daily, weekly, monthly)' }
                            ],
                            examples: [
                                { code: 'schtasks /create /tn "Backup" /tr "C:\\backup.bat" /sc daily /st 02:00', desc: 'T√¢che quotidienne √† 2h' },
                                { code: 'schtasks /create /tn "Cleanup" /tr "C:\\cleanup.bat" /sc weekly /d SUN /st 03:00', desc: 'T√¢che hebdomadaire dimanche' },
                                { code: 'schtasks /run /tn "Backup"', desc: 'Ex√©cuter maintenant' },
                                { code: 'schtasks /delete /tn "Backup" /f', desc: 'Supprimer sans confirmation' }
                            ],
                            tips: ['Utile pour les scripts batch et la compatibilit√©'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'remote-admin',
                title: 'üñ•Ô∏è Administrer √† Distance',
                icon: 'fa-network-wired',
                color: 'border-l-4 border-teal-500',
                commands: [
                    {
                        cmd: 'Session PowerShell distante',
                        desc: 'Enter-PSSession, session interactive',
                        details: {
                            explanation: 'Ouvrir une session PowerShell interactive sur une machine distante.',
                            syntax: 'Enter-PSSession -ComputerName serveur',
                            options: [
                                { flag: '-ComputerName', desc: 'Nom ou IP du serveur' },
                                { flag: '-Credential', desc: 'Credentials pour l\'authentification' },
                                { flag: 'Exit-PSSession', desc: 'Quitter la session' }
                            ],
                            examples: [
                                { code: 'Enter-PSSession -ComputerName Server01', desc: 'Session interactive' },
                                { code: '$cred = Get-Credential\nEnter-PSSession -ComputerName Server01 -Credential $cred', desc: 'Avec credentials' },
                                { code: 'Exit-PSSession', desc: 'Quitter la session' }
                            ],
                            tips: ['Le prompt change pour indiquer [Server01]: PS>'],
                            warnings: ['WinRM doit √™tre configur√© sur la machine cible']
                        }
                    },
                    {
                        cmd: 'Ex√©cuter des commandes √† distance',
                        desc: 'Invoke-Command, plusieurs serveurs',
                        details: {
                            explanation: 'Ex√©cuter des commandes sur une ou plusieurs machines distantes.',
                            syntax: 'Invoke-Command -ComputerName serveur -ScriptBlock { }',
                            options: [
                                { flag: '-ComputerName', desc: 'Nom ou IP (peut √™tre une liste)' },
                                { flag: '-ScriptBlock', desc: 'Bloc de code √† ex√©cuter' },
                                { flag: '-FilePath', desc: 'Script local √† ex√©cuter √† distance' },
                                { flag: '-AsJob', desc: 'Ex√©cuter en arri√®re-plan' }
                            ],
                            examples: [
                                { code: 'Invoke-Command -ComputerName Server01 -ScriptBlock { Get-Service }', desc: 'Lister les services' },
                                { code: 'Invoke-Command -ComputerName Server01,Server02 -ScriptBlock { Get-Process | Select-Object -First 5 }', desc: 'Sur plusieurs serveurs' },
                                { code: 'Invoke-Command -ComputerName Server01 -FilePath C:\\Scripts\\deploy.ps1', desc: 'Ex√©cuter un script local' },
                                { code: '$servers = "SRV01","SRV02","SRV03"\nInvoke-Command -ComputerName $servers -ScriptBlock { Restart-Service -Name Spooler }', desc: 'Red√©marrer un service sur plusieurs serveurs' }
                            ],
                            tips: ['Les r√©sultats incluent la propri√©t√© PSComputerName pour identifier le serveur'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Configurer WinRM',
                        desc: 'Enable-PSRemoting, TrustedHosts',
                        details: {
                            explanation: 'Activer et configurer Windows Remote Management pour le remoting.',
                            syntax: 'Enable-PSRemoting -Force\nwinrm quickconfig',
                            options: [
                                { flag: 'Enable-PSRemoting', desc: 'Activer le remoting' },
                                { flag: 'winrm quickconfig', desc: 'Configuration rapide WinRM' },
                                { flag: 'TrustedHosts', desc: 'Machines de confiance' }
                            ],
                            examples: [
                                { code: 'Enable-PSRemoting -Force', desc: 'Activer le remoting (en admin)' },
                                { code: 'winrm quickconfig', desc: 'Configuration rapide WinRM' },
                                { code: 'winrm get winrm/config', desc: 'Voir la configuration' },
                                { code: 'Set-Item WSMan:\\localhost\\Client\\TrustedHosts -Value "Server01,Server02"', desc: 'Ajouter des h√¥tes de confiance' },
                                { code: 'Get-Item WSMan:\\localhost\\Client\\TrustedHosts', desc: 'Voir les TrustedHosts' }
                            ],
                            tips: ['Sur un r√©seau de domaine, WinRM fonctionne automatiquement'],
                            warnings: ['TrustedHosts * est un risque de s√©curit√©']
                        }
                    },
                    {
                        cmd: 'Sessions persistantes',
                        desc: 'New-PSSession, r√©utilisation',
                        details: {
                            explanation: 'Cr√©er des sessions r√©utilisables pour plusieurs commandes.',
                            syntax: 'New-PSSession -ComputerName serveur',
                            options: [
                                { flag: 'New-PSSession', desc: 'Cr√©er une session' },
                                { flag: 'Get-PSSession', desc: 'Lister les sessions' },
                                { flag: 'Remove-PSSession', desc: 'Fermer une session' }
                            ],
                            examples: [
                                { code: '$session = New-PSSession -ComputerName Server01', desc: 'Cr√©er une session' },
                                { code: 'Invoke-Command -Session $session -ScriptBlock { Get-Process }', desc: 'Utiliser la session' },
                                { code: 'Enter-PSSession -Session $session', desc: 'Entrer dans la session' },
                                { code: '$sessions = New-PSSession -ComputerName Server01,Server02,Server03\nInvoke-Command -Session $sessions -ScriptBlock { hostname }', desc: 'Sessions multiples' },
                                { code: 'Remove-PSSession -Session $session', desc: 'Fermer la session' }
                            ],
                            tips: ['Les sessions persistantes sont plus efficaces pour plusieurs commandes'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'project-admin',
                title: 'üéØ Projet: Script d\'Administration',
                icon: 'fa-rocket',
                color: 'border-l-4 border-emerald-500',
                commands: [
                    {
                        cmd: '√âtape 1: Structure du script',
                        desc: 'Template professionnel avec param√®tres',
                        details: {
                            explanation: 'Cr√©er un script PowerShell avec structure professionnelle.',
                            syntax: '#Requires -Version 5.1\n#Requires -RunAsAdministrator',
                            options: [],
                            examples: [
                                { code: '#Requires -Version 5.1\n#Requires -RunAsAdministrator\n<#\n.SYNOPSIS\n    Script d\'administration syst√®me\n.DESCRIPTION\n    Effectue des t√¢ches de maintenance et monitoring\n.PARAMETER Action\n    Action √† effectuer: Check, Cleanup, Backup, Report\n.EXAMPLE\n    .\\admin-script.ps1 -Action Check\n#>\n\n[CmdletBinding()]\nparam(\n    [Parameter(Mandatory)]\n    [ValidateSet("Check", "Cleanup", "Backup", "Report")]\n    [string]$Action,\n    \n    [switch]$WhatIf\n)\n\n$ErrorActionPreference = "Stop"\n$ScriptName = $MyInvocation.MyCommand.Name\n$LogPath = "C:\\Logs\\$ScriptName.log"', desc: 'En-t√™te avec param√®tres' }
                            ],
                            tips: ['#Requires garantit les pr√©requis avant ex√©cution'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 2: Fonctions de logging',
                        desc: 'Journalisation avec niveaux et couleurs',
                        details: {
                            explanation: 'Fonctions pour logger les actions avec horodatage.',
                            syntax: 'function Write-Log { }',
                            options: [],
                            examples: [
                                { code: 'function Write-Log {\n    param(\n        [string]$Message,\n        [ValidateSet("INFO", "WARN", "ERROR")]\n        [string]$Level = "INFO"\n    )\n    $timestamp = Get-Date -Format "yyyy-MM-dd HH:mm:ss"\n    $logEntry = "[$timestamp] [$Level] $Message"\n    \n    switch ($Level) {\n        "INFO"  { Write-Host $logEntry -ForegroundColor Green }\n        "WARN"  { Write-Host $logEntry -ForegroundColor Yellow }\n        "ERROR" { Write-Host $logEntry -ForegroundColor Red }\n    }\n    Add-Content -Path $LogPath -Value $logEntry\n}\n\nfunction Write-Info  { param($Msg) Write-Log $Msg "INFO" }\nfunction Write-Warn  { param($Msg) Write-Log $Msg "WARN" }\nfunction Write-Err   { param($Msg) Write-Log $Msg "ERROR" }', desc: 'Fonctions de log' }
                            ],
                            tips: ['Utilisez des couleurs pour distinguer les niveaux'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 3: Health Check syst√®me',
                        desc: 'V√©rifier disque, m√©moire, services',
                        details: {
                            explanation: 'Fonction pour v√©rifier l\'√©tat du syst√®me.',
                            syntax: 'function Test-SystemHealth { }',
                            options: [],
                            examples: [
                                { code: 'function Test-SystemHealth {\n    Write-Info "=== V√©rification syst√®me ===\"\n    $issues = @()\n    \n    # Check espace disque\n    Get-Volume | Where-Object { $_.DriveLetter } | ForEach-Object {\n        $freePercent = [math]::Round(($_.SizeRemaining / $_.Size) * 100, 1)\n        if ($freePercent -lt 10) {\n            $issues += "Disque $($_.DriveLetter): $freePercent% libre"\n            Write-Warn "Disque $($_.DriveLetter): $freePercent% - CRITIQUE"\n        } else {\n            Write-Info "Disque $($_.DriveLetter): $freePercent% libre - OK"\n        }\n    }\n    \n    # Check m√©moire\n    $os = Get-CimInstance Win32_OperatingSystem\n    $memUsed = [math]::Round((($os.TotalVisibleMemorySize - $os.FreePhysicalMemory) / $os.TotalVisibleMemorySize) * 100, 1)\n    if ($memUsed -gt 90) {\n        $issues += "M√©moire: $memUsed% utilis√©e"\n    }\n    Write-Info "M√©moire: $memUsed% utilis√©e"\n    \n    return $issues\n}', desc: 'Fonction de health check' }
                            ],
                            tips: ['Retournez un tableau d\'issues pour un traitement ult√©rieur'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 4: Nettoyage automatis√©',
                        desc: 'Supprimer fichiers temporaires',
                        details: {
                            explanation: 'Fonction pour nettoyer les fichiers temporaires.',
                            syntax: 'function Invoke-Cleanup { }',
                            options: [],
                            examples: [
                                { code: 'function Invoke-Cleanup {\n    param([switch]$WhatIf)\n    \n    Write-Info "=== Nettoyage syst√®me ===\"\n    $totalFreed = 0\n    \n    $cleanupPaths = @(\n        "$env:TEMP",\n        "C:\\Windows\\Temp"\n    )\n    \n    foreach ($path in $cleanupPaths) {\n        if (Test-Path $path) {\n            $files = Get-ChildItem $path -Recurse -Force -ErrorAction SilentlyContinue | \n                     Where-Object { !$_.PSIsContainer -and $_.LastWriteTime -lt (Get-Date).AddDays(-7) }\n            \n            $size = ($files | Measure-Object -Property Length -Sum).Sum / 1MB\n            \n            if ($WhatIf) {\n                Write-Info "[WhatIf] Supprimerait $([math]::Round($size, 2)) MB de $path"\n            } else {\n                $files | Remove-Item -Force -ErrorAction SilentlyContinue\n                Write-Info "Nettoy√© $([math]::Round($size, 2)) MB de $path"\n                $totalFreed += $size\n            }\n        }\n    }\n    \n    return $totalFreed\n}', desc: 'Fonction de nettoyage' }
                            ],
                            tips: ['Impl√©mentez toujours -WhatIf pour tester sans risque'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 5: Backup avec compression',
                        desc: 'Sauvegarder et rotation',
                        details: {
                            explanation: 'Fonction pour sauvegarder des dossiers avec rotation.',
                            syntax: 'function Invoke-Backup { }',
                            options: [],
                            examples: [
                                { code: 'function Invoke-Backup {\n    param(\n        [string[]]$Paths = @("C:\\Data"),\n        [string]$Destination = "D:\\Backups",\n        [int]$RetentionDays = 7\n    )\n    \n    Write-Info "=== Sauvegarde ===\"\n    $date = Get-Date -Format "yyyyMMdd_HHmmss"\n    $backupPath = Join-Path $Destination "backup_$date.zip"\n    \n    if (!(Test-Path $Destination)) {\n        New-Item -ItemType Directory -Path $Destination -Force | Out-Null\n    }\n    \n    try {\n        Compress-Archive -Path $Paths -DestinationPath $backupPath -CompressionLevel Optimal\n        $size = (Get-Item $backupPath).Length / 1MB\n        Write-Info "Backup cr√©√©: $backupPath ($([math]::Round($size, 2)) MB)"\n    } catch {\n        Write-Err "√âchec du backup: $_"\n        return\n    }\n    \n    # Rotation\n    Get-ChildItem $Destination -Filter "backup_*.zip" | \n        Where-Object { $_.LastWriteTime -lt (Get-Date).AddDays(-$RetentionDays) } | \n        ForEach-Object {\n            Remove-Item $_.FullName -Force\n            Write-Info "Ancien backup supprim√©: $($_.Name)"\n        }\n}', desc: 'Fonction de backup' }
                            ],
                            tips: ['Compress-Archive est int√©gr√© depuis PowerShell 5.0'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 6: Point d\'entr√©e',
                        desc: 'Orchestration et ex√©cution',
                        details: {
                            explanation: 'Fonction main qui orchestre l\'ex√©cution.',
                            syntax: 'switch ($Action) { }',
                            options: [],
                            examples: [
                                { code: '# Point d\'entr√©e principal\nWrite-Info "========================================"\nWrite-Info "  Script d\'Administration - $Action"\nWrite-Info "  Ex√©cut√© par: $env:USERNAME"\nWrite-Info "========================================"\n\ntry {\n    switch ($Action) {\n        "Check" {\n            $issues = Test-SystemHealth\n            if ($issues.Count -eq 0) {\n                Write-Info "Aucun probl√®me d√©tect√©!"\n            } else {\n                Write-Warn "$($issues.Count) probl√®me(s) d√©tect√©(s)"\n            }\n        }\n        "Cleanup" {\n            $freed = Invoke-Cleanup -WhatIf:$WhatIf\n        }\n        "Backup" {\n            Invoke-Backup\n        }\n    }\n    \n    Write-Info "Script termin√© avec succ√®s"\n    exit 0\n} catch {\n    Write-Err "Erreur fatale: $_"\n    exit 1\n}', desc: 'Main et orchestration' },
                                { code: '# Utilisation:\n# .\\admin-script.ps1 -Action Check\n# .\\admin-script.ps1 -Action Cleanup -WhatIf\n# .\\admin-script.ps1 -Action Backup', desc: 'Exemples d\'utilisation' }
                            ],
                            tips: ['Retournez des codes de sortie (0=succ√®s, 1=erreur)'],
                            warnings: []
                        }
                    }
                ]
            }
        ];
    </script>
    <script src="../js/cheatsheet.js"></script>
</body>
</html>
