<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aide-m√©moire Configuration Serveur : workflows pratiques pour Nginx, Apache, SSL, d√©ploiement et administration.">
    <title>Configuration Serveur - IT Cheatsheets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body class="dark-theme text-slate-200">

    <header class="bg-slate-900/50 border-b border-white/5 py-8 px-4 relative overflow-hidden header-glow">
        <div class="max-w-4xl mx-auto relative z-10">
            <div class="flex items-center justify-between mb-4">
                <a href="../index.html" class="nav-back inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-arrow-left mr-2"></i>Retour
                </a>
                <a href="../index.html" class="inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-home mr-2"></i>Accueil
                </a>
            </div>
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-xl bg-indigo-500/20 mb-4 icon-glow">
                    <i class="fas fa-server text-3xl text-indigo-400"></i>
                </div>
                <h1 class="text-3xl font-bold mb-2 gradient-text">Configuration Serveur</h1>
                <p class="text-slate-400">Workflows pratiques pour l'administration serveur</p>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-4 relative z-10">
        <div class="mb-8 relative">
            <input type="text" id="searchInput" placeholder="Rechercher un workflow..."
                   class="search-dark w-full p-4 pl-12 rounded-lg outline-none transition">
            <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-500"></i>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="categoriesGrid"></div>
    </main>

    <div id="detailModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50 p-4 modal-overlay" onclick="closeModal(event)">
        <div class="modal-content-dark rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl modal-content" onclick="event.stopPropagation()">
            <div id="modalContent"></div>
        </div>
    </div>

    <footer class="border-t border-white/5 text-center text-slate-500 py-8 text-sm relative z-10">
        <p>¬© 2026 - Dr FENOHASINA Toto Jean Felicien</p>
    </footer>

    <script>
        const cheatsheetData = [
            {
                id: 'setup-webserver',
                title: 'üåê Configurer un Serveur Web',
                icon: 'fa-globe',
                color: 'border-l-4 border-green-500',
                commands: [
                    {
                        cmd: 'Installer et d√©marrer Nginx',
                        desc: 'Setup initial du serveur web',
                        details: {
                            explanation: 'Installation et configuration de base de Nginx comme serveur web.',
                            syntax: 'apt install nginx && systemctl enable nginx',
                            options: [
                                { flag: 'nginx -t', desc: 'Tester la configuration' },
                                { flag: 'nginx -s reload', desc: 'Recharger sans arr√™ter' },
                                { flag: 'systemctl status nginx', desc: 'V√©rifier l\'√©tat' },
                                { flag: 'systemctl enable nginx', desc: 'Activer au d√©marrage' }
                            ],
                            examples: [
                                { code: 'sudo apt update && sudo apt install -y nginx', desc: 'Installation sur Debian/Ubuntu' },
                                { code: 'sudo systemctl enable --now nginx', desc: 'Activer et d√©marrer imm√©diatement' },
                                { code: 'sudo nginx -t && sudo systemctl reload nginx', desc: 'Tester puis recharger la config' },
                                { code: 'curl -I http://localhost', desc: 'V√©rifier que Nginx r√©pond' }
                            ],
                            tips: ['Toujours tester avec nginx -t avant de recharger'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Cr√©er un site Nginx (server block)',
                        desc: 'H√©berger un site statique',
                        details: {
                            explanation: 'Configuration d\'un server block Nginx pour servir un site web statique.',
                            syntax: '/etc/nginx/sites-available/monsite.conf',
                            options: [
                                { flag: 'listen', desc: 'Port d\'√©coute (80, 443)' },
                                { flag: 'server_name', desc: 'Domaine(s) du site' },
                                { flag: 'root', desc: 'R√©pertoire racine des fichiers' },
                                { flag: 'index', desc: 'Fichiers index par d√©faut' },
                                { flag: 'location', desc: 'R√®gles par chemin URL' }
                            ],
                            examples: [
                                { code: 'server {\n    listen 80;\n    listen [::]:80;\n    server_name example.com www.example.com;\n    root /var/www/example.com;\n    index index.html;\n\n    location / {\n        try_files $uri $uri/ =404;\n    }\n}', desc: 'Site statique simple' },
                                { code: 'sudo mkdir -p /var/www/example.com\nsudo chown -R www-data:www-data /var/www/example.com', desc: 'Cr√©er le r√©pertoire du site' },
                                { code: 'sudo ln -s /etc/nginx/sites-available/example.com /etc/nginx/sites-enabled/', desc: 'Activer le site' }
                            ],
                            tips: ['Cr√©ez un lien symbolique vers sites-enabled pour activer'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Installer et configurer Apache',
                        desc: 'Alternative √† Nginx avec Apache',
                        details: {
                            explanation: 'Installation et configuration de base d\'Apache HTTP Server.',
                            syntax: 'apt install apache2 && systemctl enable apache2',
                            options: [
                                { flag: 'apachectl -t', desc: 'Tester la configuration' },
                                { flag: 'a2ensite', desc: 'Activer un site' },
                                { flag: 'a2dissite', desc: 'D√©sactiver un site' },
                                { flag: 'a2enmod', desc: 'Activer un module' }
                            ],
                            examples: [
                                { code: 'sudo apt install -y apache2\nsudo systemctl enable --now apache2', desc: 'Installation Apache' },
                                { code: '<VirtualHost *:80>\n    ServerName example.com\n    ServerAlias www.example.com\n    DocumentRoot /var/www/example.com/public\n\n    <Directory /var/www/example.com/public>\n        Options -Indexes +FollowSymLinks\n        AllowOverride All\n        Require all granted\n    </Directory>\n\n    ErrorLog ${APACHE_LOG_DIR}/example_error.log\n    CustomLog ${APACHE_LOG_DIR}/example_access.log combined\n</VirtualHost>', desc: 'VirtualHost Apache' },
                                { code: 'sudo a2ensite example.conf && sudo apachectl -t && sudo systemctl reload apache2', desc: 'Activer et recharger' }
                            ],
                            tips: ['AllowOverride All permet les fichiers .htaccess'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Configurer PHP-FPM',
                        desc: 'Ex√©cuter des applications PHP',
                        details: {
                            explanation: 'Configuration de PHP-FPM pour de meilleures performances PHP.',
                            syntax: 'apt install php-fpm && systemctl enable php-fpm',
                            options: [
                                { flag: 'fastcgi_pass', desc: 'Socket PHP-FPM (Nginx)' },
                                { flag: 'SetHandler', desc: 'Handler PHP (Apache)' },
                                { flag: 'pool.d/', desc: 'Configuration des pools' }
                            ],
                            examples: [
                                { code: 'sudo apt install php8.2-fpm php8.2-mysql php8.2-mbstring', desc: 'Installation PHP-FPM' },
                                { code: '# Nginx - dans le server block\nlocation ~ \\.php$ {\n    include snippets/fastcgi-php.conf;\n    fastcgi_pass unix:/run/php/php8.2-fpm.sock;\n}', desc: 'Config PHP dans Nginx' },
                                { code: '# Apache - activer PHP-FPM\nsudo a2enmod proxy_fcgi setenvif\nsudo a2enconf php8.2-fpm\nsudo systemctl reload apache2', desc: 'Config PHP dans Apache' }
                            ],
                            tips: ['PHP-FPM est plus performant que mod_php'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Consulter les logs du serveur web',
                        desc: 'D√©boguer les erreurs',
                        details: {
                            explanation: 'Localisation et lecture des logs Nginx et Apache.',
                            syntax: 'tail -f /var/log/nginx/error.log',
                            options: [
                                { flag: 'access.log', desc: 'Requ√™tes re√ßues' },
                                { flag: 'error.log', desc: 'Erreurs serveur' },
                                { flag: 'tail -f', desc: 'Suivre en temps r√©el' }
                            ],
                            examples: [
                                { code: 'sudo tail -f /var/log/nginx/error.log', desc: 'Erreurs Nginx en temps r√©el' },
                                { code: 'sudo tail -f /var/log/apache2/error.log', desc: 'Erreurs Apache en temps r√©el' },
                                { code: 'sudo grep "404" /var/log/nginx/access.log | tail -20', desc: 'Derni√®res erreurs 404' },
                                { code: 'sudo journalctl -u nginx -f', desc: 'Logs systemd Nginx' }
                            ],
                            tips: ['Configurez des logs personnalis√©s par site pour mieux d√©boguer'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'https-ssl',
                title: 'üîí S√©curiser avec HTTPS',
                icon: 'fa-lock',
                color: 'border-l-4 border-yellow-500',
                commands: [
                    {
                        cmd: 'Obtenir un certificat Let\'s Encrypt',
                        desc: 'SSL gratuit avec Certbot',
                        details: {
                            explanation: 'Certbot obtient et renouvelle automatiquement des certificats SSL gratuits.',
                            syntax: 'certbot --nginx -d domain.com',
                            options: [
                                { flag: '--nginx', desc: 'Plugin Nginx (configure auto)' },
                                { flag: '--apache', desc: 'Plugin Apache' },
                                { flag: '-d domain', desc: 'Domaine √† certifier' },
                                { flag: '--dry-run', desc: 'Test sans modifier' }
                            ],
                            examples: [
                                { code: 'sudo apt install certbot python3-certbot-nginx', desc: 'Installation Certbot pour Nginx' },
                                { code: 'sudo certbot --nginx -d example.com -d www.example.com', desc: 'Obtenir certificat + config auto' },
                                { code: 'sudo certbot certonly --webroot -w /var/www/example -d example.com', desc: 'Certificat seul (config manuelle)' },
                                { code: 'sudo certbot certificates', desc: 'Lister les certificats' }
                            ],
                            tips: ['Certbot configure automatiquement la redirection HTTP ‚Üí HTTPS'],
                            warnings: ['Le domaine doit pointer vers le serveur AVANT d\'obtenir le certificat']
                        }
                    },
                    {
                        cmd: 'Configurer HTTPS manuellement (Nginx)',
                        desc: 'Config SSL s√©curis√©e',
                        details: {
                            explanation: 'Configuration SSL/TLS recommand√©e pour Nginx si vous ne voulez pas laisser Certbot la g√©rer.',
                            syntax: 'listen 443 ssl http2;',
                            options: [
                                { flag: 'ssl_certificate', desc: 'Chemin du certificat' },
                                { flag: 'ssl_certificate_key', desc: 'Chemin de la cl√© priv√©e' },
                                { flag: 'ssl_protocols', desc: 'Versions TLS autoris√©es' },
                                { flag: 'ssl_ciphers', desc: 'Algorithmes de chiffrement' }
                            ],
                            examples: [
                                { code: 'server {\n    listen 443 ssl http2;\n    server_name example.com;\n\n    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;\n\n    ssl_protocols TLSv1.2 TLSv1.3;\n    ssl_prefer_server_ciphers on;\n    ssl_ciphers ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256;\n\n    # HSTS - force HTTPS\n    add_header Strict-Transport-Security "max-age=31536000" always;\n\n    # ... reste de la config\n}', desc: 'Config HTTPS s√©curis√©e' },
                                { code: 'server {\n    listen 80;\n    server_name example.com;\n    return 301 https://$server_name$request_uri;\n}', desc: 'Redirection HTTP ‚Üí HTTPS' }
                            ],
                            tips: ['Activez HTTP/2 pour de meilleures performances (http2)'],
                            warnings: ['TLS 1.0 et 1.1 sont obsol√®tes et vuln√©rables']
                        }
                    },
                    {
                        cmd: 'Renouveler les certificats',
                        desc: 'Automatiser le renouvellement',
                        details: {
                            explanation: 'Les certificats Let\'s Encrypt expirent apr√®s 90 jours. Certbot g√®re le renouvellement automatique.',
                            syntax: 'certbot renew',
                            options: [
                                { flag: 'renew', desc: 'Renouveler tous les certificats proches d\'expiration' },
                                { flag: '--dry-run', desc: 'Simuler le renouvellement' },
                                { flag: '--force-renewal', desc: 'Forcer le renouvellement' }
                            ],
                            examples: [
                                { code: 'sudo certbot renew --dry-run', desc: 'Tester le renouvellement' },
                                { code: 'sudo certbot renew', desc: 'Renouveler si n√©cessaire' },
                                { code: 'systemctl list-timers | grep certbot', desc: 'V√©rifier le timer automatique' },
                                { code: '# Cron manuel si besoin (normalement pas n√©cessaire)\n0 0 1 * * /usr/bin/certbot renew --quiet', desc: 'Crontab de backup' }
                            ],
                            tips: ['Certbot installe automatiquement un timer systemd pour le renouvellement'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Tester la configuration SSL',
                        desc: 'V√©rifier la s√©curit√© HTTPS',
                        details: {
                            explanation: 'Outils pour v√©rifier que votre configuration SSL est correcte et s√©curis√©e.',
                            syntax: 'openssl s_client -connect domain:443',
                            options: [
                                { flag: 'openssl s_client', desc: 'Test connexion SSL' },
                                { flag: '-servername', desc: 'SNI (si plusieurs sites)' },
                                { flag: 'ssllabs.com', desc: 'Test en ligne complet' }
                            ],
                            examples: [
                                { code: 'openssl s_client -connect example.com:443 -servername example.com', desc: 'Test connexion SSL' },
                                { code: 'curl -vI https://example.com 2>&1 | grep -A5 "SSL connection"', desc: 'Voir les d√©tails SSL avec curl' },
                                { code: 'echo | openssl s_client -connect example.com:443 2>/dev/null | openssl x509 -noout -dates', desc: 'V√©rifier dates du certificat' },
                                { code: '# Test en ligne complet: https://www.ssllabs.com/ssltest/', desc: 'SSL Labs (note A √† F)' }
                            ],
                            tips: ['Visez une note A ou A+ sur SSL Labs'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'manage-services',
                title: '‚öôÔ∏è G√©rer les Services',
                icon: 'fa-cogs',
                color: 'border-l-4 border-blue-500',
                commands: [
                    {
                        cmd: 'Contr√¥ler un service avec systemctl',
                        desc: 'Start, stop, restart, status',
                        details: {
                            explanation: 'Commandes systemctl pour g√©rer les services syst√®me.',
                            syntax: 'systemctl [command] [service]',
                            options: [
                                { flag: 'start', desc: 'D√©marrer le service' },
                                { flag: 'stop', desc: 'Arr√™ter le service' },
                                { flag: 'restart', desc: 'Red√©marrer' },
                                { flag: 'reload', desc: 'Recharger la config sans arr√™ter' },
                                { flag: 'status', desc: '√âtat du service' },
                                { flag: 'enable', desc: 'Activer au d√©marrage' },
                                { flag: 'disable', desc: 'D√©sactiver au d√©marrage' }
                            ],
                            examples: [
                                { code: 'sudo systemctl start nginx', desc: 'D√©marrer Nginx' },
                                { code: 'sudo systemctl enable --now nginx', desc: 'Activer au boot + d√©marrer maintenant' },
                                { code: 'sudo systemctl status nginx', desc: 'V√©rifier l\'√©tat' },
                                { code: 'systemctl list-units --type=service --state=running', desc: 'Lister services actifs' },
                                { code: 'systemctl is-active nginx && echo "OK" || echo "KO"', desc: 'Test scriptable' }
                            ],
                            tips: ['--now avec enable d√©marre le service imm√©diatement'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Cr√©er un service systemd',
                        desc: 'Ex√©cuter votre application comme service',
                        details: {
                            explanation: 'Cr√©ez un fichier unit pour que votre application d√©marre automatiquement et soit g√©r√©e par systemd.',
                            syntax: '/etc/systemd/system/myapp.service',
                            options: [
                                { flag: '[Unit]', desc: 'Description et d√©pendances' },
                                { flag: '[Service]', desc: 'Configuration d\'ex√©cution' },
                                { flag: '[Install]', desc: 'Cibles d\'installation' },
                                { flag: 'ExecStart', desc: 'Commande de d√©marrage' },
                                { flag: 'Restart', desc: 'Politique de red√©marrage' }
                            ],
                            examples: [
                                { code: '[Unit]\nDescription=My Node.js Application\nAfter=network.target\n\n[Service]\nType=simple\nUser=www-data\nWorkingDirectory=/var/www/myapp\nExecStart=/usr/bin/node server.js\nRestart=on-failure\nRestartSec=10\nEnvironment=NODE_ENV=production\n\n[Install]\nWantedBy=multi-user.target', desc: 'Service Node.js' },
                                { code: 'sudo systemctl daemon-reload\nsudo systemctl enable --now myapp', desc: 'Activer le nouveau service' }
                            ],
                            tips: ['Restart=on-failure red√©marre automatiquement en cas de crash'],
                            warnings: ['daemon-reload est n√©cessaire apr√®s modification du fichier unit']
                        }
                    },
                    {
                        cmd: 'Lire les logs d\'un service',
                        desc: 'D√©boguer avec journalctl',
                        details: {
                            explanation: 'journalctl permet de consulter les logs de n\'importe quel service systemd.',
                            syntax: 'journalctl -u service [options]',
                            options: [
                                { flag: '-u service', desc: 'Logs du service sp√©cifi√©' },
                                { flag: '-f', desc: 'Suivre en temps r√©el (tail -f)' },
                                { flag: '-n 100', desc: 'Les N derni√®res lignes' },
                                { flag: '--since "1 hour ago"', desc: 'Depuis une date/heure' },
                                { flag: '-p err', desc: 'Seulement les erreurs' }
                            ],
                            examples: [
                                { code: 'journalctl -u nginx -f', desc: 'Logs Nginx en temps r√©el' },
                                { code: 'journalctl -u myapp --since today', desc: 'Logs depuis aujourd\'hui' },
                                { code: 'journalctl -u myapp -p err --no-pager', desc: 'Seulement les erreurs' },
                                { code: 'journalctl -u myapp --since "2024-01-15" --until "2024-01-16"', desc: 'Logs d\'une p√©riode' }
                            ],
                            tips: ['journalctl -u est indispensable pour d√©boguer les services'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Configurer les variables d\'environnement',
                        desc: 'Fichier .env avec systemd',
                        details: {
                            explanation: 'Passer des variables d\'environnement √† votre service (secrets, config).',
                            syntax: 'EnvironmentFile=/path/to/.env',
                            options: [
                                { flag: 'Environment=', desc: 'Variable inline dans le service' },
                                { flag: 'EnvironmentFile=', desc: 'Charger depuis un fichier' }
                            ],
                            examples: [
                                { code: '# /var/www/myapp/.env\nNODE_ENV=production\nDATABASE_URL=postgres://user:pass@localhost/db\nSECRET_KEY=your-secret-key', desc: 'Fichier .env' },
                                { code: '[Service]\nEnvironmentFile=/var/www/myapp/.env\nExecStart=/usr/bin/node server.js', desc: 'Charger dans systemd' },
                                { code: 'sudo chmod 600 /var/www/myapp/.env\nsudo chown root:root /var/www/myapp/.env', desc: 'S√©curiser le fichier' }
                            ],
                            tips: ['Ne commitez JAMAIS le fichier .env dans Git'],
                            warnings: ['Prot√©gez le .env avec chmod 600']
                        }
                    }
                ]
            },
            {
                id: 'deploy-app',
                title: 'üöÄ D√©ployer une Application',
                icon: 'fa-rocket',
                color: 'border-l-4 border-purple-500',
                commands: [
                    {
                        cmd: 'Cr√©er la structure de d√©ploiement',
                        desc: 'Organisation professionnelle',
                        details: {
                            explanation: 'Structure recommand√©e avec releases pour permettre des rollbacks instantan√©s.',
                            syntax: '/var/www/app/{current,releases,shared}',
                            options: [
                                { flag: 'current/', desc: 'Lien vers la release active' },
                                { flag: 'releases/', desc: 'Versions d√©ploy√©es (horodat√©es)' },
                                { flag: 'shared/', desc: 'Fichiers persistants (.env, logs, uploads)' }
                            ],
                            examples: [
                                { code: 'sudo mkdir -p /var/www/myapp/{current,releases,shared}\nsudo mkdir -p /var/www/myapp/shared/{logs,uploads}\nsudo chown -R deploy:deploy /var/www/myapp', desc: 'Cr√©er la structure' },
                                { code: '/var/www/myapp/\n‚îú‚îÄ‚îÄ current -> releases/20240115_123456\n‚îú‚îÄ‚îÄ releases/\n‚îÇ   ‚îú‚îÄ‚îÄ 20240115_123456/\n‚îÇ   ‚îî‚îÄ‚îÄ 20240114_100000/\n‚îî‚îÄ‚îÄ shared/\n    ‚îú‚îÄ‚îÄ .env\n    ‚îú‚îÄ‚îÄ uploads/\n    ‚îî‚îÄ‚îÄ logs/', desc: 'Structure type' },
                                { code: 'ln -sfn /var/www/myapp/releases/NOUVELLE /var/www/myapp/current', desc: 'Activer une release (rollback)' }
                            ],
                            tips: ['Le rollback se fait en changeant le lien symbolique current'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âcrire un script de d√©ploiement',
                        desc: 'Automatiser avec bash',
                        details: {
                            explanation: 'Script bash pour d√©ployer automatiquement votre application.',
                            syntax: 'deploy.sh',
                            options: [
                                { flag: '1', desc: 'Clone/pull le code' },
                                { flag: '2', desc: 'Installe les d√©pendances' },
                                { flag: '3', desc: 'Build si n√©cessaire' },
                                { flag: '4', desc: 'Lie les fichiers partag√©s' },
                                { flag: '5', desc: 'Active la nouvelle release' },
                                { flag: '6', desc: 'Red√©marre le service' }
                            ],
                            examples: [
                                { code: '#!/bin/bash\nset -e\n\nAPP_DIR="/var/www/myapp"\nRELEASE=$(date +%Y%m%d_%H%M%S)\nRELEASE_DIR="$APP_DIR/releases/$RELEASE"\n\necho "=== Deploying $RELEASE ===\"\n\n# Clone\ngit clone --depth=1 git@github.com:user/repo.git "$RELEASE_DIR"\n\n# Install dependencies\ncd "$RELEASE_DIR"\nnpm ci --production\n\n# Link shared files\nln -s "$APP_DIR/shared/.env" "$RELEASE_DIR/.env"\nln -s "$APP_DIR/shared/uploads" "$RELEASE_DIR/uploads"\n\n# Build\nnpm run build\n\n# Activate release\nln -sfn "$RELEASE_DIR" "$APP_DIR/current"\n\n# Restart service\nsudo systemctl restart myapp\n\n# Cleanup: keep 5 releases\ncd "$APP_DIR/releases"\nls -1t | tail -n +6 | xargs -r rm -rf\n\necho "=== Deployed $RELEASE ===\"', desc: 'Script de d√©ploiement complet' }
                            ],
                            tips: ['set -e arr√™te le script √† la premi√®re erreur'],
                            warnings: ['Testez toujours sur un environnement de staging d\'abord']
                        }
                    },
                    {
                        cmd: 'D√©ployer avec PM2 (Node.js)',
                        desc: 'Process manager pour Node',
                        details: {
                            explanation: 'PM2 g√®re vos applications Node.js en production : red√©marrage auto, cluster mode, logs.',
                            syntax: 'pm2 start app.js',
                            options: [
                                { flag: 'start', desc: 'D√©marrer une application' },
                                { flag: 'restart', desc: 'Red√©marrer' },
                                { flag: 'stop', desc: 'Arr√™ter' },
                                { flag: 'logs', desc: 'Voir les logs' },
                                { flag: 'monit', desc: 'Moniteur temps r√©el' }
                            ],
                            examples: [
                                { code: 'sudo npm install -g pm2', desc: 'Installation PM2' },
                                { code: '// ecosystem.config.js\nmodule.exports = {\n  apps: [{\n    name: "myapp",\n    script: "dist/server.js",\n    instances: "max",\n    exec_mode: "cluster",\n    env: {\n      NODE_ENV: "production"\n    }\n  }]\n};', desc: 'Config PM2 en cluster' },
                                { code: 'pm2 start ecosystem.config.js\npm2 save\npm2 startup', desc: 'D√©marrer et persister au reboot' },
                                { code: 'pm2 reload myapp', desc: 'Zero-downtime reload' }
                            ],
                            tips: ['pm2 reload fait un red√©marrage sans interruption'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'D√©ployer avec Gunicorn (Python)',
                        desc: 'WSGI server pour Django/Flask',
                        details: {
                            explanation: 'Gunicorn sert les applications Python WSGI en production.',
                            syntax: 'gunicorn app:application -w 4 -b 0.0.0.0:8000',
                            options: [
                                { flag: '-w', desc: 'Nombre de workers' },
                                { flag: '-b', desc: 'Bind address:port' },
                                { flag: '--timeout', desc: 'Timeout des requ√™tes' },
                                { flag: '--reload', desc: 'Recharger sur changement (dev)' }
                            ],
                            examples: [
                                { code: 'pip install gunicorn', desc: 'Installation' },
                                { code: 'gunicorn myproject.wsgi:application --workers 4 --bind 127.0.0.1:8000', desc: 'Lancer Django' },
                                { code: '[Service]\nUser=www-data\nWorkingDirectory=/var/www/myapp\nExecStart=/var/www/myapp/venv/bin/gunicorn \\\n  --workers 4 \\\n  --bind unix:/run/gunicorn/myapp.sock \\\n  myproject.wsgi:application', desc: 'Service systemd Gunicorn' },
                                { code: '# Nginx proxy vers Gunicorn\nlocation / {\n    proxy_pass http://unix:/run/gunicorn/myapp.sock;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n}', desc: 'Nginx ‚Üí Gunicorn' }
                            ],
                            tips: ['Utilisez un socket Unix pour de meilleures performances locales'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'monitor-server',
                title: 'üìä Surveiller mon Serveur',
                icon: 'fa-chart-line',
                color: 'border-l-4 border-orange-500',
                commands: [
                    {
                        cmd: 'Voir les processus et ressources',
                        desc: 'htop, top et surveillance CPU/RAM',
                        details: {
                            explanation: 'Outils interactifs pour surveiller les processus et l\'utilisation des ressources.',
                            syntax: 'htop',
                            options: [
                                { flag: 'htop', desc: 'Version am√©lior√©e de top' },
                                { flag: 'F5', desc: 'Vue arborescente (htop)' },
                                { flag: 'F6', desc: 'Trier par colonne' },
                                { flag: 'F9', desc: 'Envoyer un signal (kill)' }
                            ],
                            examples: [
                                { code: 'sudo apt install htop && htop', desc: 'Installer et lancer htop' },
                                { code: 'htop -u www-data', desc: 'Processus d\'un utilisateur' },
                                { code: 'top -bn1 | head -20', desc: 'Top non-interactif (pour scripts)' },
                                { code: 'ps aux --sort=-%mem | head -10', desc: 'Top 10 consommateurs RAM' }
                            ],
                            tips: ['htop est plus lisible et interactif que top'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'V√©rifier l\'espace disque',
                        desc: 'df, du et ncdu',
                        details: {
                            explanation: 'Surveiller l\'utilisation de l\'espace disque pour √©viter les probl√®mes.',
                            syntax: 'df -h && du -sh /var/*',
                            options: [
                                { flag: 'df -h', desc: 'Espace disque par partition' },
                                { flag: 'df -i', desc: 'Inodes (nombre de fichiers)' },
                                { flag: 'du -sh', desc: 'Taille d\'un dossier' },
                                { flag: 'ncdu', desc: 'Navigateur interactif' }
                            ],
                            examples: [
                                { code: 'df -h', desc: 'Espace disque partitions' },
                                { code: 'du -h --max-depth=1 /var | sort -h', desc: 'Plus gros dossiers dans /var' },
                                { code: 'sudo ncdu /', desc: 'Navigateur d\'espace (interactif)' },
                                { code: 'du -sh /var/log/* | sort -h | tail -10', desc: 'Plus gros logs' }
                            ],
                            tips: ['ncdu est excellent pour trouver ce qui prend de la place'],
                            warnings: ['df -i pour v√©rifier si les inodes sont √©puis√©s']
                        }
                    },
                    {
                        cmd: 'Surveiller la charge syst√®me',
                        desc: 'Load average et uptime',
                        details: {
                            explanation: 'Le load average indique la charge du syst√®me sur 1, 5 et 15 minutes.',
                            syntax: 'uptime',
                            options: [
                                { flag: 'uptime', desc: 'Charge et temps de fonctionnement' },
                                { flag: 'w', desc: 'Uptime + utilisateurs connect√©s' },
                                { flag: 'load average', desc: 'Charge sur 1, 5, 15 min' }
                            ],
                            examples: [
                                { code: 'uptime', desc: 'Charge syst√®me' },
                                { code: 'w', desc: 'Qui est connect√© + charge' },
                                { code: 'cat /proc/loadavg', desc: 'Load average brut' },
                                { code: 'nproc', desc: 'Nombre de CPUs (pour comparer au load)' }
                            ],
                            tips: ['Load average > nombre de CPUs = syst√®me surcharg√©'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Cr√©er des alertes automatiques',
                        desc: 'Scripts de monitoring',
                        details: {
                            explanation: 'Scripts pour √™tre alert√© en cas de probl√®me (disque, service down...).',
                            syntax: 'healthcheck.sh + crontab',
                            options: [],
                            examples: [
                                { code: '#!/bin/bash\n# /usr/local/bin/disk-alert.sh\nTHRESHOLD=80\nUSAGE=$(df / | awk \'NR==2 {print $5}\' | tr -d \'%\')\n\nif [ "$USAGE" -gt "$THRESHOLD" ]; then\n  echo "Disk usage: ${USAGE}%" | mail -s "ALERT: Disk space low" admin@example.com\nfi', desc: 'Alerte espace disque' },
                                { code: '#!/bin/bash\n# /usr/local/bin/healthcheck.sh\nURL="https://myapp.com/health"\nRESPONSE=$(curl -s -o /dev/null -w "%{http_code}" $URL)\n\nif [ "$RESPONSE" != "200" ]; then\n  echo "Health check failed: $RESPONSE" | mail -s "ALERT: myapp down" admin@example.com\nfi', desc: 'Health check HTTP' },
                                { code: '# Crontab\n*/5 * * * * /usr/local/bin/healthcheck.sh\n0 * * * * /usr/local/bin/disk-alert.sh', desc: 'Planifier les checks' }
                            ],
                            tips: ['Utilisez aussi des services externes (UptimeRobot, Pingdom)'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'backup-restore',
                title: 'üíæ Sauvegarder et Restaurer',
                icon: 'fa-hdd',
                color: 'border-l-4 border-cyan-500',
                commands: [
                    {
                        cmd: 'Sauvegarder des fichiers avec rsync',
                        desc: 'Synchronisation incr√©mentale',
                        details: {
                            explanation: 'rsync copie seulement les diff√©rences, rendant les backups rapides apr√®s le premier.',
                            syntax: 'rsync -avz source/ dest/',
                            options: [
                                { flag: '-a', desc: 'Archive (pr√©serve permissions, dates)' },
                                { flag: '-v', desc: 'Verbose' },
                                { flag: '-z', desc: 'Compression pendant le transfert' },
                                { flag: '--delete', desc: 'Supprime fichiers absents de la source' },
                                { flag: '--exclude', desc: 'Exclure des fichiers/dossiers' }
                            ],
                            examples: [
                                { code: 'rsync -avz /var/www/ /backup/www/', desc: 'Backup local' },
                                { code: 'rsync -avz -e ssh /var/www/ user@backup-server:/backup/', desc: 'Backup distant via SSH' },
                                { code: 'rsync -avz --exclude="*.log" --exclude="cache/" /data/ /backup/', desc: 'Avec exclusions' },
                                { code: 'rsync -avz --delete /var/www/ /backup/www/', desc: 'Miroir exact (attention!)' }
                            ],
                            tips: ['rsync ne transf√®re que les diff√©rences = backups rapides'],
                            warnings: ['--delete supprime de la destination ce qui n\'est plus dans la source']
                        }
                    },
                    {
                        cmd: 'Sauvegarder une base de donn√©es',
                        desc: 'pg_dump, mysqldump',
                        details: {
                            explanation: 'Export de base de donn√©es PostgreSQL ou MySQL pour backup.',
                            syntax: 'pg_dump dbname > backup.sql',
                            options: [
                                { flag: 'pg_dump', desc: 'Backup PostgreSQL' },
                                { flag: 'mysqldump', desc: 'Backup MySQL/MariaDB' },
                                { flag: '-Fc', desc: 'Format custom compress√© (pg_dump)' },
                                { flag: '--single-transaction', desc: 'Backup coh√©rent' }
                            ],
                            examples: [
                                { code: 'pg_dump -U postgres mydb > backup.sql', desc: 'Backup PostgreSQL SQL' },
                                { code: 'pg_dump -Fc -U postgres mydb > backup.dump', desc: 'Format custom (recommand√©)' },
                                { code: 'mysqldump -u root -p mydb > backup.sql', desc: 'Backup MySQL' },
                                { code: 'pg_dump mydb | gzip > backup_$(date +%Y%m%d).sql.gz', desc: 'Avec compression et date' }
                            ],
                            tips: ['pg_dump -Fc est pr√©f√©r√© : compress√© et permet restore s√©lectif'],
                            warnings: ['Testez r√©guli√®rement la restauration de vos backups!']
                        }
                    },
                    {
                        cmd: 'Restaurer une base de donn√©es',
                        desc: 'pg_restore, mysql',
                        details: {
                            explanation: 'Restauration de base de donn√©es depuis un backup.',
                            syntax: 'pg_restore -d dbname backup.dump',
                            options: [
                                { flag: 'pg_restore', desc: 'Restore format custom PostgreSQL' },
                                { flag: 'psql', desc: 'Restore format SQL PostgreSQL' },
                                { flag: 'mysql', desc: 'Restore MySQL' },
                                { flag: '-c', desc: 'Clean (drop) avant restore' }
                            ],
                            examples: [
                                { code: 'pg_restore -d mydb -c backup.dump', desc: 'Restore PostgreSQL (format custom)' },
                                { code: 'psql -U postgres mydb < backup.sql', desc: 'Restore PostgreSQL (format SQL)' },
                                { code: 'gunzip < backup.sql.gz | psql mydb', desc: 'Restore depuis .gz' },
                                { code: 'mysql -u root -p mydb < backup.sql', desc: 'Restore MySQL' }
                            ],
                            tips: ['Testez le restore sur une copie de la base d\'abord'],
                            warnings: ['-c drop les tables existantes avant de les recr√©er']
                        }
                    },
                    {
                        cmd: 'Automatiser les backups avec cron',
                        desc: 'Sauvegardes planifi√©es',
                        details: {
                            explanation: 'Planifier des sauvegardes automatiques quotidiennes avec cron.',
                            syntax: 'crontab -e',
                            options: [],
                            examples: [
                                { code: '#!/bin/bash\n# /scripts/backup.sh\nset -euo pipefail\n\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_DIR="/backup"\nDB_NAME="mydb"\n\n# Backup DB\npg_dump -Fc $DB_NAME > $BACKUP_DIR/db_$DATE.dump\n\n# Backup files\nrsync -az /var/www/myapp/ $BACKUP_DIR/files/\n\n# R√©tention: garder 7 jours\nfind $BACKUP_DIR -name "db_*.dump" -mtime +7 -delete\n\necho "Backup completed: $DATE"', desc: 'Script de backup complet' },
                                { code: '# crontab -e\n0 2 * * * /scripts/backup.sh >> /var/log/backup.log 2>&1', desc: 'Backup quotidien √† 2h' }
                            ],
                            tips: ['Gardez plusieurs versions (7 jours, 4 semaines, 12 mois)'],
                            warnings: ['Stockez les backups sur un autre serveur/site']
                        }
                    }
                ]
            },
            {
                id: 'load-balancing',
                title: '‚öñÔ∏è R√©partir la Charge',
                icon: 'fa-balance-scale',
                color: 'border-l-4 border-teal-500',
                commands: [
                    {
                        cmd: 'Configurer le load balancing Nginx',
                        desc: 'Distribuer le trafic',
                        details: {
                            explanation: 'Nginx peut distribuer le trafic entre plusieurs serveurs backend.',
                            syntax: 'upstream backend { server ...; }',
                            options: [
                                { flag: 'weight=N', desc: 'Poids pour la distribution' },
                                { flag: 'max_fails=N', desc: '√âchecs avant exclusion' },
                                { flag: 'fail_timeout=Ns', desc: 'Dur√©e d\'exclusion' },
                                { flag: 'backup', desc: 'Serveur de secours' },
                                { flag: 'least_conn', desc: 'Algorithme moins de connexions' }
                            ],
                            examples: [
                                { code: 'upstream backend {\n    least_conn;\n    server 10.0.0.1:3000 weight=3;\n    server 10.0.0.2:3000 weight=2;\n    server 10.0.0.3:3000 backup;\n}\n\nserver {\n    listen 80;\n    location / {\n        proxy_pass http://backend;\n        proxy_next_upstream error timeout http_500;\n    }\n}', desc: 'Load balancing weighted' },
                                { code: 'upstream backend {\n    ip_hash;  # Sticky sessions\n    server 10.0.0.1:3000;\n    server 10.0.0.2:3000;\n}', desc: 'Sticky sessions (m√™me user ‚Üí m√™me serveur)' }
                            ],
                            tips: ['ip_hash pour maintenir les sessions sur le m√™me serveur'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Configurer le cache Nginx',
                        desc: 'Acc√©l√©rer avec le cache proxy',
                        details: {
                            explanation: 'Le cache proxy Nginx stocke les r√©ponses pour les resservir rapidement.',
                            syntax: 'proxy_cache_path ... proxy_cache ...',
                            options: [
                                { flag: 'proxy_cache_path', desc: 'Chemin et config du cache' },
                                { flag: 'proxy_cache', desc: 'Active le cache' },
                                { flag: 'proxy_cache_valid', desc: 'Dur√©e de validit√© par code' },
                                { flag: 'proxy_cache_bypass', desc: 'Conditions pour bypass' }
                            ],
                            examples: [
                                { code: '# Dans http {}\nproxy_cache_path /var/cache/nginx levels=1:2 keys_zone=app_cache:10m max_size=1g inactive=60m;\n\nserver {\n    location / {\n        proxy_pass http://backend;\n        proxy_cache app_cache;\n        proxy_cache_valid 200 302 10m;\n        proxy_cache_valid 404 1m;\n        add_header X-Cache-Status $upstream_cache_status;\n    }\n}', desc: 'Cache proxy complet' },
                                { code: 'location ~* \\.(jpg|jpeg|png|gif|ico|css|js)$ {\n    expires 30d;\n    add_header Cache-Control "public, immutable";\n}', desc: 'Cache assets statiques' }
                            ],
                            tips: ['X-Cache-Status permet de d√©boguer (HIT/MISS/BYPASS)'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Installer et utiliser Redis',
                        desc: 'Cache en m√©moire',
                        details: {
                            explanation: 'Redis comme cache en m√©moire pour les sessions et donn√©es fr√©quentes.',
                            syntax: 'redis-cli [command]',
                            options: [
                                { flag: 'SET key value EX sec', desc: 'Stocker avec expiration' },
                                { flag: 'GET key', desc: 'R√©cup√©rer une valeur' },
                                { flag: 'KEYS pattern', desc: 'Lister les cl√©s' },
                                { flag: 'INFO', desc: 'Statistiques' }
                            ],
                            examples: [
                                { code: 'sudo apt install redis-server\nsudo systemctl enable --now redis-server', desc: 'Installation Redis' },
                                { code: 'redis-cli SET mykey "Hello" EX 3600\nredis-cli GET mykey', desc: 'Commandes basiques' },
                                { code: '# /etc/redis/redis.conf\nmaxmemory 256mb\nmaxmemory-policy allkeys-lru', desc: 'Config m√©moire LRU' },
                                { code: 'redis-cli INFO stats | grep hits', desc: 'Taux de cache hit' }
                            ],
                            tips: ['allkeys-lru √©vince les cl√©s les moins utilis√©es'],
                            warnings: ['S√©curisez Redis: bind 127.0.0.1 et requirepass']
                        }
                    }
                ]
            },
            {
                id: 'security',
                title: 'üõ°Ô∏è S√©curiser mon Serveur',
                icon: 'fa-shield-alt',
                color: 'border-l-4 border-rose-500',
                commands: [
                    {
                        cmd: 'Ajouter les headers de s√©curit√©',
                        desc: 'Protection contre les attaques web',
                        details: {
                            explanation: 'Headers HTTP pour prot√©ger contre clickjacking, XSS, MIME sniffing...',
                            syntax: 'add_header Header-Name "value";',
                            options: [
                                { flag: 'X-Frame-Options', desc: 'Protection clickjacking' },
                                { flag: 'X-Content-Type-Options', desc: 'Emp√™che MIME sniffing' },
                                { flag: 'Strict-Transport-Security', desc: 'Force HTTPS (HSTS)' },
                                { flag: 'Content-Security-Policy', desc: 'Politique de contenu' }
                            ],
                            examples: [
                                { code: '# Nginx - dans server {}\nadd_header X-Frame-Options "SAMEORIGIN" always;\nadd_header X-Content-Type-Options "nosniff" always;\nadd_header Referrer-Policy "strict-origin-when-cross-origin" always;\nadd_header Strict-Transport-Security "max-age=31536000; includeSubDomains" always;', desc: 'Headers essentiels' },
                                { code: '# CSP basique\nadd_header Content-Security-Policy "default-src \'self\'; script-src \'self\' \'unsafe-inline\';" always;', desc: 'Content Security Policy' }
                            ],
                            tips: ['Testez avec securityheaders.com'],
                            warnings: ['CSP trop strict peut casser votre site']
                        }
                    },
                    {
                        cmd: 'Configurer Fail2ban',
                        desc: 'Bloquer les attaques brute force',
                        details: {
                            explanation: 'Fail2ban bannit automatiquement les IPs apr√®s des √©checs r√©p√©t√©s.',
                            syntax: '/etc/fail2ban/jail.local',
                            options: [
                                { flag: 'bantime', desc: 'Dur√©e du bannissement' },
                                { flag: 'findtime', desc: 'Fen√™tre de d√©tection' },
                                { flag: 'maxretry', desc: 'Tentatives avant ban' },
                                { flag: 'ignoreip', desc: 'IPs √† ne jamais bannir' }
                            ],
                            examples: [
                                { code: 'sudo apt install fail2ban\nsudo systemctl enable --now fail2ban', desc: 'Installation' },
                                { code: '# /etc/fail2ban/jail.local\n[DEFAULT]\nbantime = 1h\nfindtime = 10m\nmaxretry = 5\nignoreip = 127.0.0.1/8 YOUR_IP\n\n[sshd]\nenabled = true\nport = ssh\nmaxretry = 3', desc: 'Configuration SSH' },
                                { code: 'sudo fail2ban-client status sshd', desc: 'Voir les IPs bannies' },
                                { code: 'sudo fail2ban-client set sshd unbanip 1.2.3.4', desc: 'D√©bannir une IP' }
                            ],
                            tips: ['Ajoutez votre IP √† ignoreip pour ne pas vous bloquer'],
                            warnings: ['Ne vous bloquez pas vous-m√™me !']
                        }
                    },
                    {
                        cmd: 'S√©curiser SSH',
                        desc: 'Hardening SSH',
                        details: {
                            explanation: 'Renforcer la configuration SSH pour emp√™cher les acc√®s non autoris√©s.',
                            syntax: '/etc/ssh/sshd_config',
                            options: [
                                { flag: 'PasswordAuthentication', desc: 'D√©sactiver login par mot de passe' },
                                { flag: 'PermitRootLogin', desc: 'Interdire login root' },
                                { flag: 'AllowUsers', desc: 'Liste blanche utilisateurs' },
                                { flag: 'Port', desc: 'Changer le port SSH' }
                            ],
                            examples: [
                                { code: '# /etc/ssh/sshd_config.d/hardening.conf\nPort 2222\nPermitRootLogin no\nPasswordAuthentication no\nPubkeyAuthentication yes\nAllowUsers deploy admin\nMaxAuthTries 3', desc: 'Config s√©curis√©e' },
                                { code: '# G√©n√©rer une cl√© SSH (sur votre machine)\nssh-keygen -t ed25519 -C "user@host"\nssh-copy-id -p 2222 user@server', desc: 'Setup cl√© SSH' },
                                { code: 'sudo sshd -t && sudo systemctl reload sshd', desc: 'Test et reload' }
                            ],
                            tips: ['Toujours tester la config avant de reload (sshd -t)'],
                            warnings: ['Gardez une session ouverte pendant les tests SSH!']
                        }
                    },
                    {
                        cmd: 'Configurer le firewall (UFW)',
                        desc: 'Contr√¥ler les ports ouverts',
                        details: {
                            explanation: 'UFW (Uncomplicated Firewall) simplifie la gestion d\'iptables.',
                            syntax: 'ufw allow/deny port',
                            options: [
                                { flag: 'allow', desc: 'Autoriser un port/service' },
                                { flag: 'deny', desc: 'Bloquer un port' },
                                { flag: 'status', desc: 'Voir les r√®gles actives' },
                                { flag: 'delete', desc: 'Supprimer une r√®gle' }
                            ],
                            examples: [
                                { code: 'sudo ufw default deny incoming\nsudo ufw default allow outgoing', desc: 'Politique par d√©faut' },
                                { code: 'sudo ufw allow 22/tcp comment "SSH"\nsudo ufw allow 80/tcp comment "HTTP"\nsudo ufw allow 443/tcp comment "HTTPS"', desc: 'Ouvrir les ports essentiels' },
                                { code: 'sudo ufw enable', desc: 'Activer le firewall' },
                                { code: 'sudo ufw status numbered', desc: 'Voir les r√®gles avec num√©ros' }
                            ],
                            tips: ['Ouvrez SSH AVANT d\'activer UFW !'],
                            warnings: ['Vous pouvez vous bloquer si vous oubliez d\'autoriser SSH']
                        }
                    }
                ]
            },
            {
                id: 'proxy-reverse',
                title: 'üîÑ Proxy et Reverse Proxy',
                icon: 'fa-exchange-alt',
                color: 'border-l-4 border-indigo-500',
                commands: [
                    {
                        cmd: 'Configurer un reverse proxy Nginx',
                        desc: 'Proxy vers une application backend',
                        details: {
                            explanation: 'Nginx comme reverse proxy transmet les requ√™tes √† votre application (Node, Python, etc.).',
                            syntax: 'location / { proxy_pass http://backend; }',
                            options: [
                                { flag: 'proxy_pass', desc: 'URL du backend' },
                                { flag: 'proxy_set_header', desc: 'Headers √† transmettre' },
                                { flag: 'proxy_http_version', desc: 'Version HTTP (1.1 pour WebSocket)' }
                            ],
                            examples: [
                                { code: 'server {\n    listen 80;\n    server_name app.example.com;\n\n    location / {\n        proxy_pass http://127.0.0.1:3000;\n        proxy_http_version 1.1;\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}', desc: 'Proxy basique' }
                            ],
                            tips: ['Les headers X-Forwarded-* permettent √† l\'app de conna√Ætre l\'IP r√©elle'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Proxy WebSocket avec Nginx',
                        desc: 'Supporter les connexions WebSocket',
                        details: {
                            explanation: 'Configuration sp√©ciale pour les connexions WebSocket persistantes.',
                            syntax: 'proxy_set_header Upgrade $http_upgrade;',
                            options: [
                                { flag: 'Upgrade', desc: 'Header pour upgrade WebSocket' },
                                { flag: 'Connection', desc: 'Doit √™tre "upgrade"' },
                                { flag: 'proxy_read_timeout', desc: 'Timeout pour connexions longues' }
                            ],
                            examples: [
                                { code: 'location /ws/ {\n    proxy_pass http://127.0.0.1:3000;\n    proxy_http_version 1.1;\n    proxy_set_header Upgrade $http_upgrade;\n    proxy_set_header Connection "upgrade";\n    proxy_set_header Host $host;\n    proxy_read_timeout 86400;  # 24h\n}', desc: 'WebSocket proxy' },
                                { code: '# Ou pour tout le site\nmap $http_upgrade $connection_upgrade {\n    default upgrade;\n    \'\'      close;\n}\n\nserver {\n    location / {\n        proxy_pass http://backend;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection $connection_upgrade;\n    }\n}', desc: 'WebSocket avec map (plus propre)' }
                            ],
                            tips: ['proxy_read_timeout √©vite la fermeture des WebSockets inactifs'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Proxy PHP-FPM avec Apache',
                        desc: 'Apache vers PHP-FPM',
                        details: {
                            explanation: 'Configuration Apache pour proxy vers PHP-FPM au lieu de mod_php.',
                            syntax: 'SetHandler "proxy:unix:/run/php/php-fpm.sock|fcgi://localhost"',
                            options: [
                                { flag: 'proxy_fcgi', desc: 'Module proxy FastCGI' },
                                { flag: 'SetHandler', desc: 'D√©finit le handler PHP' },
                                { flag: 'FilesMatch', desc: 'Pattern matching' }
                            ],
                            examples: [
                                { code: '# Activer les modules\nsudo a2enmod proxy_fcgi setenvif\nsudo a2enconf php8.2-fpm', desc: 'Activer PHP-FPM' },
                                { code: '<VirtualHost *:80>\n    ServerName app.example.com\n    DocumentRoot /var/www/app/public\n\n    <FilesMatch \\.php$>\n        SetHandler "proxy:unix:/run/php/php8.2-fpm.sock|fcgi://localhost"\n    </FilesMatch>\n\n    <Directory /var/www/app/public>\n        AllowOverride All\n        Require all granted\n    </Directory>\n</VirtualHost>', desc: 'VHost avec PHP-FPM' }
                            ],
                            tips: ['PHP-FPM est plus performant et isol√© que mod_php'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Proxy vers socket Unix',
                        desc: 'Meilleure performance locale',
                        details: {
                            explanation: 'Utiliser un socket Unix au lieu de TCP pour les connexions locales (plus rapide).',
                            syntax: 'proxy_pass http://unix:/path/to/socket.sock;',
                            options: [
                                { flag: 'unix:', desc: 'Chemin du socket Unix' },
                                { flag: 'fastcgi_pass', desc: 'Pour PHP-FPM' }
                            ],
                            examples: [
                                { code: '# Nginx vers Gunicorn via socket\nlocation / {\n    proxy_pass http://unix:/run/gunicorn/myapp.sock;\n    proxy_set_header Host $host;\n    proxy_set_header X-Real-IP $remote_addr;\n}', desc: 'Proxy vers socket Gunicorn' },
                                { code: '# Nginx vers PHP-FPM via socket\nlocation ~ \\.php$ {\n    fastcgi_pass unix:/run/php/php8.2-fpm.sock;\n    include fastcgi_params;\n    fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;\n}', desc: 'FastCGI vers socket PHP' }
                            ],
                            tips: ['Les sockets Unix sont plus rapides que TCP pour le local'],
                            warnings: ['V√©rifiez les permissions du socket (chmod, chown)']
                        }
                    }
                ]
            },
            {
                id: 'project-server',
                title: 'üéØ Projet: Setup Serveur Production',
                icon: 'fa-rocket',
                color: 'border-l-4 border-emerald-500',
                commands: [
                    {
                        cmd: '√âtape 1: S√©curisation initiale',
                        desc: 'Premier setup du serveur',
                        details: {
                            explanation: 'S√©curiser un nouveau serveur d√®s sa cr√©ation : utilisateur, SSH, mises √† jour.',
                            syntax: 'ssh root@server',
                            options: [],
                            examples: [
                                { code: '#!/bin/bash\n# secure-server.sh - √Ä ex√©cuter en tant que root\nset -e\n\nNEW_USER="deploy"\nSSH_PORT="2222"\n\n# 1. Mise √† jour syst√®me\napt update && apt upgrade -y\napt install -y ufw fail2ban unattended-upgrades\n\n# 2. Cr√©er utilisateur non-root\nadduser --disabled-password --gecos "" $NEW_USER\nusermod -aG sudo $NEW_USER\nmkdir -p /home/$NEW_USER/.ssh\ncp ~/.ssh/authorized_keys /home/$NEW_USER/.ssh/\nchown -R $NEW_USER:$NEW_USER /home/$NEW_USER/.ssh\nchmod 700 /home/$NEW_USER/.ssh\nchmod 600 /home/$NEW_USER/.ssh/authorized_keys\n\n# 3. Sudo sans mot de passe pour deploy\necho "$NEW_USER ALL=(ALL) NOPASSWD:ALL" > /etc/sudoers.d/$NEW_USER', desc: 'Script s√©curisation initiale' }
                            ],
                            tips: ['Gardez toujours un acc√®s console de secours'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 2: Firewall et SSH',
                        desc: 'UFW et hardening SSH',
                        details: {
                            explanation: 'Configurer le firewall et s√©curiser l\'acc√®s SSH.',
                            syntax: 'ufw + sshd_config',
                            options: [],
                            examples: [
                                { code: '# Suite du script\n# 4. Configurer SSH\ncat > /etc/ssh/sshd_config.d/hardening.conf << EOF\nPort $SSH_PORT\nPermitRootLogin no\nPasswordAuthentication no\nPubkeyAuthentication yes\nAllowUsers $NEW_USER\nMaxAuthTries 3\nEOF\n\n# 5. Configurer UFW\nufw default deny incoming\nufw default allow outgoing\nufw allow $SSH_PORT/tcp comment "SSH"\nufw allow 80/tcp comment "HTTP"\nufw allow 443/tcp comment "HTTPS"\nufw --force enable\n\n# 6. Configurer Fail2ban\ncat > /etc/fail2ban/jail.local << EOF\n[DEFAULT]\nbantime = 1h\nfindtime = 10m\nmaxretry = 5\n\n[sshd]\nenabled = true\nport = $SSH_PORT\nmaxretry = 3\nEOF\n\nsystemctl restart sshd fail2ban\necho "SSH s√©curis√© sur port $SSH_PORT"', desc: 'Firewall et SSH' }
                            ],
                            tips: ['Testez la connexion SSH avant de fermer la session root'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 3: Stack technique',
                        desc: 'Nginx, Node/Python, PostgreSQL',
                        details: {
                            explanation: 'Installer les composants de votre stack technique.',
                            syntax: 'apt install nginx postgresql',
                            options: [],
                            examples: [
                                { code: '# En tant qu\'utilisateur deploy\nsudo -i\n\n# Nginx\napt install -y nginx\nsystemctl enable nginx\n\n# Node.js (via NodeSource)\ncurl -fsSL https://deb.nodesource.com/setup_20.x | bash -\napt install -y nodejs\nnpm install -g pm2\n\n# OU Python\napt install -y python3-pip python3-venv\npip3 install gunicorn\n\n# PostgreSQL\napt install -y postgresql postgresql-contrib\nsudo -u postgres createuser --interactive\nsudo -u postgres createdb myapp_production\n\n# Certbot pour SSL\napt install -y certbot python3-certbot-nginx\n\n# Redis (optionnel)\napt install -y redis-server\nsystemctl enable redis-server', desc: 'Installation stack Node.js' }
                            ],
                            tips: ['PM2 pour Node.js, Gunicorn pour Python'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 4: Configuration Nginx + SSL',
                        desc: 'Reverse proxy avec HTTPS',
                        details: {
                            explanation: 'Configurer Nginx comme reverse proxy avec certificat SSL.',
                            syntax: '/etc/nginx/sites-available/myapp',
                            options: [],
                            examples: [
                                { code: '# /etc/nginx/sites-available/myapp\nupstream app_backend {\n    server 127.0.0.1:3000;\n    keepalive 64;\n}\n\nserver {\n    listen 80;\n    server_name myapp.com www.myapp.com;\n    return 301 https://$server_name$request_uri;\n}\n\nserver {\n    listen 443 ssl http2;\n    server_name myapp.com www.myapp.com;\n\n    # SSL (configur√© par Certbot)\n    ssl_certificate /etc/letsencrypt/live/myapp.com/fullchain.pem;\n    ssl_certificate_key /etc/letsencrypt/live/myapp.com/privkey.pem;\n    ssl_protocols TLSv1.2 TLSv1.3;\n\n    # Security headers\n    add_header X-Frame-Options "SAMEORIGIN" always;\n    add_header X-Content-Type-Options "nosniff" always;\n    add_header Strict-Transport-Security "max-age=31536000" always;\n\n    location / {\n        proxy_pass http://app_backend;\n        proxy_http_version 1.1;\n        proxy_set_header Upgrade $http_upgrade;\n        proxy_set_header Connection "upgrade";\n        proxy_set_header Host $host;\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-Forwarded-Proto $scheme;\n    }\n}\n\n# Activation\nsudo ln -s /etc/nginx/sites-available/myapp /etc/nginx/sites-enabled/\nsudo nginx -t && sudo systemctl reload nginx\nsudo certbot --nginx -d myapp.com -d www.myapp.com', desc: 'Config Nginx + SSL' }
                            ],
                            tips: ['Certbot configure automatiquement le renouvellement'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 5: D√©ploiement application',
                        desc: 'Structure et PM2/Gunicorn',
                        details: {
                            explanation: 'D√©ployer l\'application avec une structure professionnelle.',
                            syntax: '/var/www/myapp/',
                            options: [],
                            examples: [
                                { code: '# Structure de d√©ploiement\nmkdir -p /var/www/myapp/{current,releases,shared}\nmkdir -p /var/www/myapp/shared/{logs,uploads}\nchown -R deploy:deploy /var/www/myapp\n\n# PM2 ecosystem.config.js\nmodule.exports = {\n  apps: [{\n    name: "myapp",\n    cwd: "/var/www/myapp/current",\n    script: "dist/server.js",\n    instances: "max",\n    exec_mode: "cluster",\n    env: {\n      NODE_ENV: "production",\n      PORT: 3000\n    }\n  }]\n};\n\n# D√©marrer et persister\npm2 start ecosystem.config.js\npm2 save\npm2 startup', desc: 'D√©ploiement Node.js' }
                            ],
                            tips: ['PM2 cluster mode utilise tous les CPU'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 6: Backup automatis√©',
                        desc: 'Sauvegardes planifi√©es',
                        details: {
                            explanation: 'Mettre en place des sauvegardes automatiques quotidiennes.',
                            syntax: '/scripts/backup.sh + crontab',
                            options: [],
                            examples: [
                                { code: '#!/bin/bash\n# /scripts/backup.sh\nset -euo pipefail\n\nDATE=$(date +%Y%m%d_%H%M%S)\nBACKUP_DIR="/backup"\nDB_NAME="myapp_production"\n\nmkdir -p $BACKUP_DIR/{db,files}\n\n# Backup DB\nsudo -u postgres pg_dump -Fc $DB_NAME > $BACKUP_DIR/db/db_$DATE.dump\n\n# Backup uploads et config\ntar -czf $BACKUP_DIR/files/uploads_$DATE.tar.gz -C /var/www/myapp/shared uploads .env\n\n# R√©tention: 7 jours local\nfind $BACKUP_DIR -type f -mtime +7 -delete\n\n# Sync vers serveur distant (optionnel)\n# rsync -avz $BACKUP_DIR/ backup@remote:/backups/myapp/\n\necho "Backup completed: $DATE"\n\n# Crontab\n# 0 2 * * * /scripts/backup.sh >> /var/log/backup.log 2>&1', desc: 'Script backup complet' }
                            ],
                            tips: ['Testez r√©guli√®rement la restauration'],
                            warnings: ['Stockez les backups hors site']
                        }
                    }
                ]
            }
        ];
    </script>
    <script src="../js/cheatsheet.js"></script>
</body>
</html>
