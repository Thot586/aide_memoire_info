<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aide-mémoire SQL : requêtes SELECT, JOIN, GROUP BY et manipulation de bases de données.">
    <title>SQL Mémento - IT Cheatsheets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body class="dark-theme text-slate-200">

    <header class="bg-slate-900/50 border-b border-white/5 py-8 px-4 relative overflow-hidden header-glow">
        <div class="max-w-4xl mx-auto relative z-10">
            <div class="flex items-center justify-between mb-4">
                <a href="../index.html" class="nav-back inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-arrow-left mr-2"></i>Retour
                </a>
                <a href="../index.html" class="inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-home mr-2"></i>Accueil
                </a>
            </div>
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-xl bg-slate-500/20 mb-4 icon-glow">
                    <i class="fas fa-database text-3xl text-slate-300"></i>
                </div>
                <h1 class="text-3xl font-bold mb-2 gradient-text">SQL Mémento</h1>
                <p class="text-slate-400">Requêtes SELECT, JOINS, GROUP BY et agrégations</p>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-4 relative z-10">
        <div class="mb-8 relative">
            <input type="text" id="searchInput" placeholder="Rechercher une commande..."
                   class="search-dark w-full p-4 pl-12 rounded-lg outline-none transition">
            <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-500"></i>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="categoriesGrid"></div>
    </main>

    <div id="detailModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50 p-4 modal-overlay" onclick="closeModal(event)">
        <div class="modal-content-dark rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl modal-content" onclick="event.stopPropagation()">
            <div id="modalContent"></div>
        </div>
    </div>

    <footer class="border-t border-white/5 text-center text-slate-500 py-8 text-sm relative z-10">
        <p>© 2026 - Dr FENOHASINA Toto Jean Felicien</p>
    </footer>

    <script>
        const cheatsheetData = [
            {
                id: 'select',
                title: 'Requêtes SELECT',
                icon: 'fa-search',
                color: 'border-l-4 border-blue-500',
                commands: [
                    {
                        cmd: 'SELECT * FROM table',
                        desc: 'Sélectionner toutes les colonnes',
                        details: {
                            explanation: 'Récupère toutes les colonnes et lignes d\'une table. L\'astérisque (*) est un joker qui signifie "toutes les colonnes".',
                            syntax: 'SELECT * FROM nom_table',
                            options: [],
                            examples: [
                                { code: 'SELECT * FROM clients', desc: 'Toutes les données de la table clients' },
                                { code: 'SELECT * FROM clients LIMIT 10', desc: 'Les 10 premières lignes' }
                            ],
                            tips: ['Évitez SELECT * en production, spécifiez les colonnes nécessaires'],
                            warnings: ['Peut être lent sur de grandes tables']
                        }
                    },
                    {
                        cmd: 'SELECT col1, col2 FROM table',
                        desc: 'Sélectionner des colonnes spécifiques',
                        details: {
                            explanation: 'Récupère uniquement les colonnes spécifiées. Plus efficace que SELECT *.',
                            syntax: 'SELECT colonne1, colonne2 FROM nom_table',
                            options: [],
                            examples: [
                                { code: 'SELECT nom, email FROM clients', desc: 'Nom et email des clients' },
                                { code: 'SELECT DISTINCT ville FROM clients', desc: 'Villes uniques (sans doublons)' },
                                { code: 'SELECT nom, prenom, ville FROM clients', desc: 'Plusieurs colonnes' }
                            ],
                            tips: ['DISTINCT élimine les doublons'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'SELECT col AS alias',
                        desc: 'Renommer une colonne (alias)',
                        details: {
                            explanation: 'Donne un nom temporaire à une colonne ou une expression pour plus de lisibilité.',
                            syntax: 'SELECT colonne AS nom_alias FROM table',
                            options: [],
                            examples: [
                                { code: 'SELECT nom AS client_name FROM clients', desc: 'Renommer la colonne' },
                                { code: 'SELECT prix * 1.2 AS prix_ttc FROM produits', desc: 'Alias sur calcul' },
                                { code: 'SELECT c.nom, co.date FROM clients c JOIN commandes co ON c.id = co.client_id', desc: 'Alias de table' }
                            ],
                            tips: ['AS est optionnel: SELECT nom client_name fonctionne aussi', 'Les alias de table raccourcissent les requêtes'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'CASE WHEN ... THEN ... END',
                        desc: 'Condition dans SELECT',
                        details: {
                            explanation: 'Permet d\'ajouter une logique conditionnelle dans les requêtes, comme un if/else.',
                            syntax: 'CASE WHEN condition THEN resultat ELSE default END',
                            options: [],
                            examples: [
                                { code: 'SELECT nom,\n  CASE WHEN age < 18 THEN \'Mineur\'\n       WHEN age < 65 THEN \'Adulte\'\n       ELSE \'Senior\' END AS categorie\nFROM clients', desc: 'Catégoriser par âge' },
                                { code: 'SELECT produit,\n  CASE status\n    WHEN \'A\' THEN \'Actif\'\n    WHEN \'I\' THEN \'Inactif\'\n    ELSE \'Inconnu\' END AS status_label\nFROM produits', desc: 'CASE simple (égalité)' },
                                { code: 'SELECT SUM(CASE WHEN status = \'vendu\' THEN 1 ELSE 0 END) AS nb_vendus\nFROM produits', desc: 'Compter conditionnellement' }
                            ],
                            tips: ['CASE WHEN pour conditions complexes, CASE col WHEN pour égalité simple', 'ELSE est optionnel (NULL par défaut)'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'COALESCE(col1, col2, ...)',
                        desc: 'Première valeur non NULL',
                        details: {
                            explanation: 'Retourne la première valeur non NULL parmi les arguments. Utile pour les valeurs par défaut.',
                            syntax: 'COALESCE(valeur1, valeur2, valeur_defaut)',
                            options: [],
                            examples: [
                                { code: 'SELECT COALESCE(surnom, prenom, \'Anonyme\') AS nom_affiche FROM clients', desc: 'Premier non NULL' },
                                { code: 'SELECT produit, COALESCE(remise, 0) AS remise FROM produits', desc: 'Remplacer NULL par 0' },
                                { code: 'SELECT COALESCE(telephone, email, \'Pas de contact\') FROM clients', desc: 'Contact principal' }
                            ],
                            tips: ['Alternative: IFNULL(col, defaut) en MySQL, ISNULL(col, defaut) en SQL Server'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'filter',
                title: 'Filtrage (WHERE)',
                icon: 'fa-filter',
                color: 'border-l-4 border-green-500',
                commands: [
                    {
                        cmd: 'WHERE condition',
                        desc: 'Filtrer les résultats',
                        details: {
                            explanation: 'Filtre les lignes selon une condition. Seules les lignes satisfaisant la condition sont retournées.',
                            syntax: 'SELECT ... FROM table WHERE condition',
                            options: [
                                { flag: '=', desc: 'Égalité' },
                                { flag: '<>, !=', desc: 'Différent de' },
                                { flag: '<, >, <=, >=', desc: 'Comparaisons' },
                                { flag: 'BETWEEN a AND b', desc: 'Entre deux valeurs (inclus)' },
                                { flag: 'IN (a, b, c)', desc: 'Dans une liste de valeurs' },
                                { flag: 'LIKE pattern', desc: 'Correspondance de motif' }
                            ],
                            examples: [
                                { code: 'SELECT * FROM clients WHERE age > 18', desc: 'Clients majeurs' },
                                { code: 'SELECT * FROM produits WHERE prix BETWEEN 10 AND 50', desc: 'Prix entre 10 et 50' },
                                { code: 'SELECT * FROM clients WHERE ville IN (\'Paris\', \'Lyon\', \'Marseille\')', desc: 'Villes spécifiques' }
                            ],
                            tips: ['BETWEEN inclut les bornes', 'IN est équivalent à plusieurs OR'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'LIKE pattern',
                        desc: 'Recherche par motif',
                        details: {
                            explanation: 'Recherche de texte avec des jokers. % = n\'importe quels caractères, _ = un seul caractère.',
                            syntax: 'WHERE colonne LIKE \'pattern\'',
                            options: [
                                { flag: '%', desc: 'N\'importe quelle séquence (0 ou plus caractères)' },
                                { flag: '_', desc: 'Exactement un caractère' },
                                { flag: 'ESCAPE', desc: 'Définir un caractère d\'échappement' }
                            ],
                            examples: [
                                { code: 'WHERE nom LIKE \'Dup%\'', desc: 'Commence par "Dup"' },
                                { code: 'WHERE email LIKE \'%@gmail.com\'', desc: 'Finit par @gmail.com' },
                                { code: 'WHERE nom LIKE \'%jean%\'', desc: 'Contient "jean"' },
                                { code: 'WHERE code LIKE \'A_B\'', desc: 'A suivi d\'un caractère puis B' },
                                { code: 'WHERE nom LIKE \'%100\\%%\' ESCAPE \'\\\'', desc: 'Contient "100%" littéralement' }
                            ],
                            tips: ['ILIKE pour recherche insensible à la casse (PostgreSQL)', 'NOT LIKE pour exclure un motif'],
                            warnings: ['LIKE \'%mot%\' ne peut pas utiliser d\'index (lent)']
                        }
                    },
                    {
                        cmd: 'IS NULL / IS NOT NULL',
                        desc: 'Tester les valeurs NULL',
                        details: {
                            explanation: 'NULL n\'est pas une valeur, c\'est l\'absence de valeur. = NULL ne fonctionne pas, utilisez IS NULL.',
                            syntax: 'WHERE colonne IS NULL / IS NOT NULL',
                            options: [],
                            examples: [
                                { code: 'SELECT * FROM clients WHERE telephone IS NULL', desc: 'Clients sans téléphone' },
                                { code: 'SELECT * FROM commandes WHERE date_livraison IS NOT NULL', desc: 'Commandes livrées' },
                                { code: 'SELECT * FROM produits WHERE description IS NULL OR description = \'\'', desc: 'Sans description ou vide' }
                            ],
                            tips: ['NULL = NULL retourne NULL (pas TRUE!)', 'Utilisez COALESCE pour remplacer NULL'],
                            warnings: ['Ne JAMAIS utiliser = NULL ou != NULL']
                        }
                    },
                    {
                        cmd: 'AND / OR / NOT',
                        desc: 'Combiner des conditions',
                        details: {
                            explanation: 'Opérateurs logiques pour combiner plusieurs conditions dans un WHERE.',
                            syntax: 'WHERE condition1 AND condition2 OR condition3',
                            options: [
                                { flag: 'AND', desc: 'Les deux conditions doivent être vraies' },
                                { flag: 'OR', desc: 'Au moins une condition doit être vraie' },
                                { flag: 'NOT', desc: 'Inverse la condition' }
                            ],
                            examples: [
                                { code: 'WHERE age > 18 AND ville = \'Paris\'', desc: 'Majeurs parisiens' },
                                { code: 'WHERE ville = \'Paris\' OR ville = \'Lyon\'', desc: 'Paris OU Lyon' },
                                { code: 'WHERE NOT status = \'inactif\'', desc: 'Tous sauf les inactifs' },
                                { code: 'WHERE (age > 18 AND ville = \'Paris\') OR vip = TRUE', desc: 'Avec parenthèses' }
                            ],
                            tips: ['AND est évalué avant OR', 'Utilisez des parenthèses pour clarifier'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'EXISTS (subquery)',
                        desc: 'Tester l\'existence',
                        details: {
                            explanation: 'Vérifie si une sous-requête retourne au moins une ligne. Plus efficace que IN pour de grandes tables.',
                            syntax: 'WHERE EXISTS (SELECT 1 FROM table2 WHERE condition)',
                            options: [],
                            examples: [
                                { code: 'SELECT * FROM clients c\nWHERE EXISTS (\n  SELECT 1 FROM commandes co\n  WHERE co.client_id = c.id\n)', desc: 'Clients ayant commandé' },
                                { code: 'SELECT * FROM produits p\nWHERE NOT EXISTS (\n  SELECT 1 FROM ventes v\n  WHERE v.produit_id = p.id\n)', desc: 'Produits jamais vendus' }
                            ],
                            tips: ['SELECT 1 suffit, pas besoin de colonnes', 'Souvent plus performant que IN avec sous-requête'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'order',
                title: 'Tri et pagination',
                icon: 'fa-sort',
                color: 'border-l-4 border-cyan-500',
                commands: [
                    {
                        cmd: 'ORDER BY col [ASC|DESC]',
                        desc: 'Trier les résultats',
                        details: {
                            explanation: 'Trie les résultats par une ou plusieurs colonnes. ASC = croissant (défaut), DESC = décroissant.',
                            syntax: 'SELECT ... FROM table ORDER BY col1 [ASC|DESC], col2 [ASC|DESC]',
                            options: [
                                { flag: 'ASC', desc: 'Tri croissant (A→Z, 1→9) - par défaut' },
                                { flag: 'DESC', desc: 'Tri décroissant (Z→A, 9→1)' },
                                { flag: 'NULLS FIRST/LAST', desc: 'Position des NULL (PostgreSQL)' }
                            ],
                            examples: [
                                { code: 'SELECT * FROM clients ORDER BY nom', desc: 'Tri alphabétique' },
                                { code: 'SELECT * FROM produits ORDER BY prix DESC', desc: 'Plus cher en premier' },
                                { code: 'SELECT * FROM commandes ORDER BY date DESC, montant DESC', desc: 'Multi-colonnes' },
                                { code: 'SELECT * FROM clients ORDER BY 2', desc: 'Par position de colonne' }
                            ],
                            tips: ['On peut trier par numéro de colonne (1, 2, 3...)', 'Les NULL sont triés en premier ou dernier selon le SGBD'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'LIMIT n [OFFSET m]',
                        desc: 'Limiter le nombre de résultats',
                        details: {
                            explanation: 'Limite le nombre de lignes retournées. OFFSET saute les n premières lignes (pagination).',
                            syntax: 'SELECT ... LIMIT nombre [OFFSET debut]',
                            options: [
                                { flag: 'LIMIT n', desc: 'Retourner maximum n lignes' },
                                { flag: 'OFFSET m', desc: 'Sauter les m premières lignes' }
                            ],
                            examples: [
                                { code: 'SELECT * FROM clients LIMIT 10', desc: 'Les 10 premiers' },
                                { code: 'SELECT * FROM clients ORDER BY id LIMIT 10 OFFSET 20', desc: 'Lignes 21 à 30 (page 3)' },
                                { code: 'SELECT * FROM produits ORDER BY prix DESC LIMIT 5', desc: 'Top 5 les plus chers' },
                                { code: 'SELECT TOP 10 * FROM clients', desc: 'Syntaxe SQL Server' }
                            ],
                            tips: ['Toujours utiliser ORDER BY avec LIMIT pour des résultats prévisibles', 'MySQL: LIMIT m, n = LIMIT n OFFSET m'],
                            warnings: ['Syntaxe varie: LIMIT (MySQL/PostgreSQL), TOP (SQL Server), FETCH FIRST (Oracle/Standard)']
                        }
                    },
                    {
                        cmd: 'FETCH FIRST n ROWS',
                        desc: 'Standard SQL pour limiter',
                        details: {
                            explanation: 'Syntaxe SQL standard pour la pagination, supportée par Oracle, PostgreSQL, SQL Server 2012+.',
                            syntax: 'OFFSET m ROWS FETCH FIRST n ROWS ONLY',
                            options: [
                                { flag: 'OFFSET m ROWS', desc: 'Sauter m lignes' },
                                { flag: 'FETCH FIRST n ROWS ONLY', desc: 'Retourner n lignes' },
                                { flag: 'WITH TIES', desc: 'Inclure les égalités' }
                            ],
                            examples: [
                                { code: 'SELECT * FROM clients\nORDER BY nom\nOFFSET 20 ROWS\nFETCH FIRST 10 ROWS ONLY', desc: 'Page 3 (21-30)' },
                                { code: 'SELECT * FROM produits\nORDER BY prix DESC\nFETCH FIRST 5 ROWS WITH TIES', desc: 'Top 5, inclure les ex-aequo' }
                            ],
                            tips: ['WITH TIES inclut les lignes à égalité avec la dernière'],
                            warnings: ['Nécessite ORDER BY']
                        }
                    }
                ]
            },
            {
                id: 'join',
                title: 'Jointures (JOIN)',
                icon: 'fa-link',
                color: 'border-l-4 border-purple-500',
                commands: [
                    {
                        cmd: 'INNER JOIN',
                        desc: 'Jointure interne',
                        details: {
                            explanation: 'Retourne uniquement les lignes ayant une correspondance dans les deux tables. Le type de jointure le plus courant.',
                            syntax: 'SELECT ... FROM table1 INNER JOIN table2 ON table1.col = table2.col',
                            options: [],
                            examples: [
                                { code: 'SELECT c.nom, co.date, co.montant\nFROM clients c\nINNER JOIN commandes co ON c.id = co.client_id', desc: 'Clients avec commandes' },
                                { code: 'SELECT p.nom, cat.libelle\nFROM produits p\nJOIN categories cat ON p.categorie_id = cat.id', desc: 'JOIN = INNER JOIN' }
                            ],
                            tips: ['JOIN sans préfixe = INNER JOIN', 'Utilisez des alias (c, co) pour raccourcir'],
                            warnings: ['Les lignes sans correspondance sont exclues']
                        }
                    },
                    {
                        cmd: 'LEFT [OUTER] JOIN',
                        desc: 'Jointure gauche',
                        details: {
                            explanation: 'Retourne TOUTES les lignes de la table de gauche, avec NULL si pas de correspondance à droite.',
                            syntax: 'SELECT ... FROM table1 LEFT JOIN table2 ON condition',
                            options: [],
                            examples: [
                                { code: 'SELECT c.nom, co.date\nFROM clients c\nLEFT JOIN commandes co ON c.id = co.client_id', desc: 'Tous clients, avec ou sans commande' },
                                { code: 'SELECT c.nom\nFROM clients c\nLEFT JOIN commandes co ON c.id = co.client_id\nWHERE co.id IS NULL', desc: 'Clients SANS commande' }
                            ],
                            tips: ['WHERE right_table.col IS NULL pour trouver les "orphelins"'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'RIGHT [OUTER] JOIN',
                        desc: 'Jointure droite',
                        details: {
                            explanation: 'Retourne TOUTES les lignes de la table de droite, avec NULL si pas de correspondance à gauche.',
                            syntax: 'SELECT ... FROM table1 RIGHT JOIN table2 ON condition',
                            options: [],
                            examples: [
                                { code: 'SELECT c.nom, co.date\nFROM clients c\nRIGHT JOIN commandes co ON c.id = co.client_id', desc: 'Toutes commandes, même sans client' }
                            ],
                            tips: ['RIGHT JOIN peut toujours être réécrit en LEFT JOIN (inverser les tables)'],
                            warnings: ['Moins utilisé que LEFT JOIN par convention']
                        }
                    },
                    {
                        cmd: 'FULL [OUTER] JOIN',
                        desc: 'Jointure complète',
                        details: {
                            explanation: 'Retourne TOUTES les lignes des deux tables, avec NULL quand il n\'y a pas de correspondance.',
                            syntax: 'SELECT ... FROM table1 FULL JOIN table2 ON condition',
                            options: [],
                            examples: [
                                { code: 'SELECT c.nom, co.date\nFROM clients c\nFULL JOIN commandes co ON c.id = co.client_id', desc: 'Tous les clients ET toutes les commandes' },
                                { code: 'SELECT *\nFROM table_a a\nFULL JOIN table_b b ON a.id = b.id\nWHERE a.id IS NULL OR b.id IS NULL', desc: 'Lignes sans correspondance des deux côtés' }
                            ],
                            tips: ['Utile pour comparer deux tables ou trouver les différences'],
                            warnings: ['Non supporté par MySQL (simuler avec UNION de LEFT + RIGHT)']
                        }
                    },
                    {
                        cmd: 'CROSS JOIN',
                        desc: 'Produit cartésien',
                        details: {
                            explanation: 'Combine chaque ligne de table1 avec chaque ligne de table2. Résultat = n × m lignes.',
                            syntax: 'SELECT ... FROM table1 CROSS JOIN table2',
                            options: [],
                            examples: [
                                { code: 'SELECT couleur.nom, taille.nom\nFROM couleurs couleur\nCROSS JOIN tailles taille', desc: 'Toutes les combinaisons couleur × taille' },
                                { code: 'SELECT d.date, p.nom\nFROM dates d\nCROSS JOIN produits p', desc: 'Générer un calendrier par produit' }
                            ],
                            tips: ['Utile pour générer des combinaisons', 'Équivalent: FROM table1, table2 (sans ON)'],
                            warnings: ['Attention à l\'explosion du nombre de lignes!']
                        }
                    },
                    {
                        cmd: 'Self JOIN',
                        desc: 'Jointure sur elle-même',
                        details: {
                            explanation: 'Jointure d\'une table avec elle-même. Utile pour les relations hiérarchiques.',
                            syntax: 'SELECT ... FROM table t1 JOIN table t2 ON t1.col = t2.autre_col',
                            options: [],
                            examples: [
                                { code: 'SELECT e.nom AS employe, m.nom AS manager\nFROM employes e\nLEFT JOIN employes m ON e.manager_id = m.id', desc: 'Employé et son manager' },
                                { code: 'SELECT c1.nom, c2.nom AS collegue\nFROM clients c1\nJOIN clients c2 ON c1.ville = c2.ville AND c1.id < c2.id', desc: 'Paires de clients même ville' }
                            ],
                            tips: ['Obligatoire d\'utiliser des alias différents (t1, t2)'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Multiple JOINs',
                        desc: 'Jointures multiples',
                        details: {
                            explanation: 'Joindre plus de 2 tables en chaînant les JOIN.',
                            syntax: 'SELECT ... FROM t1 JOIN t2 ON ... JOIN t3 ON ...',
                            options: [],
                            examples: [
                                { code: 'SELECT c.nom, p.nom AS produit, co.date\nFROM clients c\nJOIN commandes co ON c.id = co.client_id\nJOIN produits p ON co.produit_id = p.id', desc: 'Client → Commande → Produit' },
                                { code: 'SELECT c.nom, ca.libelle, SUM(co.montant)\nFROM clients c\nJOIN commandes co ON c.id = co.client_id\nJOIN produits p ON co.produit_id = p.id\nJOIN categories ca ON p.categorie_id = ca.id\nGROUP BY c.nom, ca.libelle', desc: 'Ventes par client et catégorie' }
                            ],
                            tips: ['L\'ordre des JOIN peut affecter les performances'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'aggregate',
                title: 'Agrégation',
                icon: 'fa-calculator',
                color: 'border-l-4 border-orange-500',
                commands: [
                    {
                        cmd: 'COUNT, SUM, AVG, MIN, MAX',
                        desc: 'Fonctions d\'agrégation',
                        details: {
                            explanation: 'Fonctions pour calculer des statistiques sur un ensemble de lignes.',
                            syntax: 'SELECT AGG(colonne) FROM table',
                            options: [
                                { flag: 'COUNT(*)', desc: 'Nombre total de lignes' },
                                { flag: 'COUNT(col)', desc: 'Nombre de valeurs non NULL' },
                                { flag: 'COUNT(DISTINCT col)', desc: 'Nombre de valeurs uniques' },
                                { flag: 'SUM(col)', desc: 'Somme des valeurs' },
                                { flag: 'AVG(col)', desc: 'Moyenne' },
                                { flag: 'MIN(col) / MAX(col)', desc: 'Valeurs min et max' }
                            ],
                            examples: [
                                { code: 'SELECT COUNT(*) FROM commandes', desc: 'Nombre de commandes' },
                                { code: 'SELECT COUNT(DISTINCT client_id) FROM commandes', desc: 'Nombre de clients distincts' },
                                { code: 'SELECT SUM(montant), AVG(montant) FROM ventes', desc: 'Total et moyenne' },
                                { code: 'SELECT MIN(date), MAX(date) FROM commandes', desc: 'Première et dernière commande' }
                            ],
                            tips: ['COUNT(*) compte tout, COUNT(col) ignore les NULL', 'AVG ignore les NULL'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'GROUP BY',
                        desc: 'Grouper les résultats',
                        details: {
                            explanation: 'Regroupe les lignes ayant les mêmes valeurs pour appliquer des fonctions d\'agrégation.',
                            syntax: 'SELECT col, AGG(col2) FROM table GROUP BY col',
                            options: [],
                            examples: [
                                { code: 'SELECT ville, COUNT(*) AS nb_clients\nFROM clients\nGROUP BY ville', desc: 'Clients par ville' },
                                { code: 'SELECT annee, mois, SUM(montant) AS total\nFROM ventes\nGROUP BY annee, mois', desc: 'Ventes par mois' },
                                { code: 'SELECT categorie_id, AVG(prix), MIN(prix), MAX(prix)\nFROM produits\nGROUP BY categorie_id', desc: 'Stats prix par catégorie' }
                            ],
                            tips: ['Toute colonne non agrégée DOIT être dans GROUP BY', 'GROUP BY peut référencer un alias ou un numéro de colonne'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'HAVING condition',
                        desc: 'Filtrer les groupes',
                        details: {
                            explanation: 'Filtre les résultats APRÈS le GROUP BY. WHERE filtre avant, HAVING filtre après agrégation.',
                            syntax: 'SELECT ... GROUP BY col HAVING condition_agregation',
                            options: [],
                            examples: [
                                { code: 'SELECT ville, COUNT(*) AS nb\nFROM clients\nGROUP BY ville\nHAVING COUNT(*) > 10', desc: 'Villes avec > 10 clients' },
                                { code: 'SELECT client_id, SUM(montant) AS total\nFROM commandes\nGROUP BY client_id\nHAVING SUM(montant) > 1000', desc: 'Clients > 1000€ de commandes' },
                                { code: 'SELECT categorie, AVG(prix) AS prix_moyen\nFROM produits\nGROUP BY categorie\nHAVING AVG(prix) BETWEEN 50 AND 200', desc: 'Catégories prix moyen 50-200€' }
                            ],
                            tips: ['WHERE = avant agrégation, HAVING = après agrégation', 'HAVING peut utiliser des alias dans certains SGBD'],
                            warnings: ['Utilisez WHERE quand possible (plus performant)']
                        }
                    },
                    {
                        cmd: 'GROUP BY avec ROLLUP/CUBE',
                        desc: 'Sous-totaux automatiques',
                        details: {
                            explanation: 'Génère automatiquement des sous-totaux et totaux pour les groupes.',
                            syntax: 'GROUP BY ROLLUP(col1, col2) / GROUP BY CUBE(col1, col2)',
                            options: [
                                { flag: 'ROLLUP', desc: 'Sous-totaux hiérarchiques (du détail au total)' },
                                { flag: 'CUBE', desc: 'Toutes les combinaisons de sous-totaux' },
                                { flag: 'GROUPING()', desc: 'Identifie les lignes de sous-total' }
                            ],
                            examples: [
                                { code: 'SELECT annee, mois, SUM(ventes) AS total\nFROM ventes\nGROUP BY ROLLUP(annee, mois)', desc: 'Total par mois, par an, et grand total' },
                                { code: 'SELECT region, produit, SUM(ventes)\nFROM ventes\nGROUP BY CUBE(region, produit)', desc: 'Toutes combinaisons région × produit' },
                                { code: 'SELECT\n  CASE WHEN GROUPING(ville) = 1 THEN \'TOTAL\' ELSE ville END AS ville,\n  SUM(montant)\nFROM ventes\nGROUP BY ROLLUP(ville)', desc: 'Identifier les sous-totaux' }
                            ],
                            tips: ['ROLLUP: total général + sous-totaux hiérarchiques', 'CUBE: toutes les combinaisons possibles'],
                            warnings: ['Syntaxe peut varier selon le SGBD']
                        }
                    }
                ]
            },
            {
                id: 'subquery',
                title: 'Sous-requêtes',
                icon: 'fa-layer-group',
                color: 'border-l-4 border-indigo-500',
                commands: [
                    {
                        cmd: 'Sous-requête dans WHERE',
                        desc: 'Filtrer avec une requête imbriquée',
                        details: {
                            explanation: 'Utilise le résultat d\'une requête comme condition de filtre.',
                            syntax: 'SELECT ... WHERE col IN (SELECT col FROM ...)',
                            options: [],
                            examples: [
                                { code: 'SELECT * FROM clients\nWHERE id IN (\n  SELECT client_id FROM commandes\n  WHERE montant > 1000\n)', desc: 'Clients avec commandes > 1000€' },
                                { code: 'SELECT * FROM produits\nWHERE prix > (\n  SELECT AVG(prix) FROM produits\n)', desc: 'Produits plus chers que la moyenne' },
                                { code: 'SELECT * FROM employes\nWHERE salaire > ALL (\n  SELECT salaire FROM employes WHERE dept = \'IT\'\n)', desc: 'Gagne plus que tous les IT' }
                            ],
                            tips: ['IN: dans la liste', 'ANY/SOME: au moins un', 'ALL: tous'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Sous-requête dans SELECT',
                        desc: 'Calculer une valeur par ligne',
                        details: {
                            explanation: 'Sous-requête scalaire retournant UNE valeur pour chaque ligne.',
                            syntax: 'SELECT col, (SELECT ...) AS alias FROM table',
                            options: [],
                            examples: [
                                { code: 'SELECT nom,\n  (SELECT COUNT(*) FROM commandes co WHERE co.client_id = c.id) AS nb_commandes\nFROM clients c', desc: 'Nombre de commandes par client' },
                                { code: 'SELECT nom, prix,\n  (SELECT AVG(prix) FROM produits) AS prix_moyen,\n  prix - (SELECT AVG(prix) FROM produits) AS ecart\nFROM produits', desc: 'Écart au prix moyen' }
                            ],
                            tips: ['Doit retourner exactement UNE valeur', 'Corrélée si référence la requête externe'],
                            warnings: ['Peut être lent (exécuté pour chaque ligne)']
                        }
                    },
                    {
                        cmd: 'Sous-requête dans FROM',
                        desc: 'Table dérivée',
                        details: {
                            explanation: 'Utilise le résultat d\'une requête comme une table temporaire.',
                            syntax: 'SELECT ... FROM (SELECT ...) AS alias',
                            options: [],
                            examples: [
                                { code: 'SELECT ville, avg_age\nFROM (\n  SELECT ville, AVG(age) AS avg_age\n  FROM clients\n  GROUP BY ville\n) AS stats\nWHERE avg_age > 30', desc: 'Filtrer sur agrégat' },
                                { code: 'SELECT c.nom, sub.total\nFROM clients c\nJOIN (\n  SELECT client_id, SUM(montant) AS total\n  FROM commandes\n  GROUP BY client_id\n) AS sub ON c.id = sub.client_id', desc: 'Joindre avec agrégat' }
                            ],
                            tips: ['L\'alias est obligatoire', 'Alternative: CTE (WITH)'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'WITH ... AS (CTE)',
                        desc: 'Common Table Expression',
                        details: {
                            explanation: 'Définit une requête nommée réutilisable dans la requête principale. Plus lisible que les sous-requêtes imbriquées.',
                            syntax: 'WITH nom AS (SELECT ...) SELECT ... FROM nom',
                            options: [
                                { flag: 'WITH', desc: 'Définit une ou plusieurs CTEs' },
                                { flag: 'RECURSIVE', desc: 'Pour les requêtes récursives (hiérarchies)' }
                            ],
                            examples: [
                                { code: 'WITH ventes_par_mois AS (\n  SELECT mois, SUM(montant) AS total\n  FROM ventes\n  GROUP BY mois\n)\nSELECT * FROM ventes_par_mois\nWHERE total > 10000', desc: 'CTE simple' },
                                { code: 'WITH\n  top_clients AS (\n    SELECT client_id FROM commandes GROUP BY client_id HAVING SUM(montant) > 5000\n  ),\n  details AS (\n    SELECT c.*, co.date FROM clients c JOIN commandes co ON c.id = co.client_id\n  )\nSELECT d.* FROM details d WHERE d.client_id IN (SELECT client_id FROM top_clients)', desc: 'Plusieurs CTEs' },
                                { code: 'WITH RECURSIVE hierarchie AS (\n  SELECT id, nom, manager_id, 1 AS niveau\n  FROM employes WHERE manager_id IS NULL\n  UNION ALL\n  SELECT e.id, e.nom, e.manager_id, h.niveau + 1\n  FROM employes e\n  JOIN hierarchie h ON e.manager_id = h.id\n)\nSELECT * FROM hierarchie', desc: 'CTE récursive (organigramme)' }
                            ],
                            tips: ['Plus lisible que les sous-requêtes imbriquées', 'Peut être référencé plusieurs fois'],
                            warnings: ['RECURSIVE: attention aux boucles infinies']
                        }
                    }
                ]
            },
            {
                id: 'window',
                title: 'Window Functions',
                icon: 'fa-window-restore',
                color: 'border-l-4 border-pink-500',
                commands: [
                    {
                        cmd: 'OVER (PARTITION BY ... ORDER BY ...)',
                        desc: 'Fenêtre de calcul',
                        details: {
                            explanation: 'Calcule une valeur sur un ensemble de lignes (fenêtre) sans réduire le nombre de lignes comme GROUP BY.',
                            syntax: 'AGG() OVER (PARTITION BY col ORDER BY col)',
                            options: [
                                { flag: 'PARTITION BY', desc: 'Divise en groupes (optionnel)' },
                                { flag: 'ORDER BY', desc: 'Ordre dans la fenêtre' },
                                { flag: 'ROWS/RANGE', desc: 'Définit les limites de la fenêtre' }
                            ],
                            examples: [
                                { code: 'SELECT nom, dept, salaire,\n  AVG(salaire) OVER (PARTITION BY dept) AS avg_dept\nFROM employes', desc: 'Moyenne par département (sans GROUP BY)' },
                                { code: 'SELECT date, montant,\n  SUM(montant) OVER (ORDER BY date) AS cumul\nFROM ventes', desc: 'Somme cumulative' },
                                { code: 'SELECT date, montant,\n  SUM(montant) OVER (ORDER BY date ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS rolling_3\nFROM ventes', desc: 'Moyenne mobile sur 3 lignes' }
                            ],
                            tips: ['Garde toutes les lignes, ajoute une colonne calculée', 'PARTITION BY = GROUP BY sans réduction'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'ROW_NUMBER() / RANK() / DENSE_RANK()',
                        desc: 'Numérotation et classement',
                        details: {
                            explanation: 'Attribue un numéro ou rang à chaque ligne dans une partition.',
                            syntax: 'ROW_NUMBER() OVER (PARTITION BY col ORDER BY col)',
                            options: [
                                { flag: 'ROW_NUMBER()', desc: 'Numéro unique (1, 2, 3, 4, 5)' },
                                { flag: 'RANK()', desc: 'Rang avec sauts (1, 2, 2, 4, 5)' },
                                { flag: 'DENSE_RANK()', desc: 'Rang sans sauts (1, 2, 2, 3, 4)' }
                            ],
                            examples: [
                                { code: 'SELECT nom, salaire,\n  ROW_NUMBER() OVER (ORDER BY salaire DESC) AS rang\nFROM employes', desc: 'Numéroter par salaire' },
                                { code: 'SELECT nom, dept, salaire,\n  RANK() OVER (PARTITION BY dept ORDER BY salaire DESC) AS rang_dept\nFROM employes', desc: 'Rang par département' },
                                { code: 'SELECT * FROM (\n  SELECT *, ROW_NUMBER() OVER (PARTITION BY client_id ORDER BY date DESC) AS rn\n  FROM commandes\n) t WHERE rn = 1', desc: 'Dernière commande par client' }
                            ],
                            tips: ['ROW_NUMBER pour garder 1 ligne par groupe', 'RANK/DENSE_RANK pour les classements avec égalités'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'LAG() / LEAD()',
                        desc: 'Accès aux lignes précédentes/suivantes',
                        details: {
                            explanation: 'Accède à la valeur d\'une ligne précédente (LAG) ou suivante (LEAD) dans la fenêtre.',
                            syntax: 'LAG(col, n, default) OVER (ORDER BY col)',
                            options: [
                                { flag: 'col', desc: 'Colonne à récupérer' },
                                { flag: 'n', desc: 'Nombre de lignes (défaut: 1)' },
                                { flag: 'default', desc: 'Valeur si pas de ligne (NULL par défaut)' }
                            ],
                            examples: [
                                { code: 'SELECT date, montant,\n  LAG(montant) OVER (ORDER BY date) AS montant_precedent,\n  montant - LAG(montant) OVER (ORDER BY date) AS variation\nFROM ventes', desc: 'Comparaison avec la veille' },
                                { code: 'SELECT date, prix,\n  LEAD(prix, 1, prix) OVER (ORDER BY date) AS prix_demain\nFROM cours', desc: 'Prix du lendemain' },
                                { code: 'SELECT date, montant,\n  LAG(montant, 7) OVER (ORDER BY date) AS meme_jour_semaine_precedente\nFROM ventes', desc: 'Il y a 7 jours' }
                            ],
                            tips: ['LAG = en arrière, LEAD = en avant', 'Très utile pour les comparaisons période à période'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'FIRST_VALUE() / LAST_VALUE()',
                        desc: 'Première/dernière valeur',
                        details: {
                            explanation: 'Retourne la première ou dernière valeur de la fenêtre.',
                            syntax: 'FIRST_VALUE(col) OVER (ORDER BY col)',
                            options: [],
                            examples: [
                                { code: 'SELECT nom, date_embauche,\n  FIRST_VALUE(nom) OVER (ORDER BY date_embauche) AS premier_employe\nFROM employes', desc: 'Nom du premier embauché' },
                                { code: 'SELECT date, prix,\n  prix - FIRST_VALUE(prix) OVER (ORDER BY date) AS variation_depuis_debut\nFROM cours', desc: 'Variation depuis le début' },
                                { code: 'SELECT nom, dept, salaire,\n  FIRST_VALUE(nom) OVER (PARTITION BY dept ORDER BY salaire DESC) AS top_salaire_dept\nFROM employes', desc: 'Meilleur salaire par dept' }
                            ],
                            tips: ['LAST_VALUE nécessite souvent ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING'],
                            warnings: ['LAST_VALUE peut surprendre avec la frame par défaut']
                        }
                    },
                    {
                        cmd: 'NTILE(n)',
                        desc: 'Diviser en n groupes égaux',
                        details: {
                            explanation: 'Divise les lignes en n groupes de taille égale (quartiles, déciles, etc.).',
                            syntax: 'NTILE(n) OVER (ORDER BY col)',
                            options: [],
                            examples: [
                                { code: 'SELECT nom, salaire,\n  NTILE(4) OVER (ORDER BY salaire) AS quartile\nFROM employes', desc: 'Quartiles de salaire' },
                                { code: 'SELECT produit, ventes,\n  NTILE(10) OVER (ORDER BY ventes DESC) AS decile\nFROM produits', desc: 'Déciles de performance' },
                                { code: 'SELECT * FROM (\n  SELECT *, NTILE(5) OVER (ORDER BY score) AS quintile FROM clients\n) t WHERE quintile = 5', desc: 'Top 20% des clients' }
                            ],
                            tips: ['NTILE(4) = quartiles, NTILE(10) = déciles, NTILE(100) = centiles'],
                            warnings: ['Si n ne divise pas exactement, les premiers groupes auront 1 ligne de plus']
                        }
                    }
                ]
            },
            {
                id: 'modify',
                title: 'Modification des données',
                icon: 'fa-edit',
                color: 'border-l-4 border-red-500',
                commands: [
                    {
                        cmd: 'INSERT INTO ... VALUES',
                        desc: 'Insérer des données',
                        details: {
                            explanation: 'Ajoute une ou plusieurs nouvelles lignes dans une table.',
                            syntax: 'INSERT INTO table (col1, col2) VALUES (val1, val2)',
                            options: [],
                            examples: [
                                { code: 'INSERT INTO clients (nom, email)\nVALUES (\'Dupont\', \'dupont@mail.com\')', desc: 'Insérer une ligne' },
                                { code: 'INSERT INTO clients (nom, email) VALUES\n  (\'A\', \'a@mail.com\'),\n  (\'B\', \'b@mail.com\'),\n  (\'C\', \'c@mail.com\')', desc: 'Insertion multiple' },
                                { code: 'INSERT INTO archive\nSELECT * FROM commandes\nWHERE date < \'2023-01-01\'', desc: 'INSERT ... SELECT' }
                            ],
                            tips: ['Toujours spécifier les colonnes explicitement', 'INSERT ... SELECT pour copier des données'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'UPDATE ... SET ... WHERE',
                        desc: 'Mettre à jour des données',
                        details: {
                            explanation: 'Modifie les valeurs existantes dans une table.',
                            syntax: 'UPDATE table SET col1 = val1, col2 = val2 WHERE condition',
                            options: [],
                            examples: [
                                { code: 'UPDATE clients\nSET email = \'new@mail.com\'\nWHERE id = 1', desc: 'Modifier une ligne' },
                                { code: 'UPDATE produits\nSET prix = prix * 1.1\nWHERE categorie = \'luxe\'', desc: 'Augmenter prix de 10%' },
                                { code: 'UPDATE commandes c\nSET status = \'annule\'\nWHERE EXISTS (\n  SELECT 1 FROM clients cl\n  WHERE cl.id = c.client_id AND cl.actif = FALSE\n)', desc: 'UPDATE avec sous-requête' }
                            ],
                            tips: ['TOUJOURS tester avec SELECT d\'abord', 'Transaction + ROLLBACK pour sécurité'],
                            warnings: ['Sans WHERE, TOUTES les lignes sont modifiées!']
                        }
                    },
                    {
                        cmd: 'DELETE FROM ... WHERE',
                        desc: 'Supprimer des données',
                        details: {
                            explanation: 'Supprime des lignes d\'une table.',
                            syntax: 'DELETE FROM table WHERE condition',
                            options: [],
                            examples: [
                                { code: 'DELETE FROM clients WHERE id = 1', desc: 'Supprimer une ligne' },
                                { code: 'DELETE FROM commandes\nWHERE date < DATE_SUB(NOW(), INTERVAL 5 YEAR)', desc: 'Supprimer les vieilles commandes' },
                                { code: 'DELETE FROM clients\nWHERE id NOT IN (SELECT DISTINCT client_id FROM commandes)', desc: 'Clients sans commande' }
                            ],
                            tips: ['TRUNCATE TABLE est plus rapide pour vider une table', 'Attention aux contraintes de clé étrangère'],
                            warnings: ['Sans WHERE, TOUTES les lignes sont supprimées!', 'Irréversible sans transaction!']
                        }
                    },
                    {
                        cmd: 'MERGE / UPSERT',
                        desc: 'Insert ou Update conditionnel',
                        details: {
                            explanation: 'Insère si la ligne n\'existe pas, met à jour sinon. Syntaxe varie selon le SGBD.',
                            syntax: 'MERGE INTO target USING source ON condition WHEN MATCHED THEN ... WHEN NOT MATCHED THEN ...',
                            options: [],
                            examples: [
                                { code: '-- SQL Server / Oracle\nMERGE INTO clients c\nUSING new_clients n ON c.email = n.email\nWHEN MATCHED THEN\n  UPDATE SET c.nom = n.nom\nWHEN NOT MATCHED THEN\n  INSERT (nom, email) VALUES (n.nom, n.email)', desc: 'MERGE standard' },
                                { code: '-- PostgreSQL\nINSERT INTO clients (email, nom)\nVALUES (\'a@mail.com\', \'A\')\nON CONFLICT (email)\nDO UPDATE SET nom = EXCLUDED.nom', desc: 'PostgreSQL UPSERT' },
                                { code: '-- MySQL\nINSERT INTO clients (email, nom)\nVALUES (\'a@mail.com\', \'A\')\nON DUPLICATE KEY UPDATE nom = VALUES(nom)', desc: 'MySQL UPSERT' }
                            ],
                            tips: ['Syntaxe très différente selon le SGBD'],
                            warnings: ['Vérifiez la doc de votre SGBD']
                        }
                    }
                ]
            },
            {
                id: 'ddl',
                title: 'Structure (DDL)',
                icon: 'fa-table',
                color: 'border-l-4 border-gray-500',
                commands: [
                    {
                        cmd: 'CREATE TABLE',
                        desc: 'Créer une table',
                        details: {
                            explanation: 'Définit une nouvelle table avec ses colonnes et contraintes.',
                            syntax: 'CREATE TABLE nom (col1 TYPE contraintes, col2 TYPE, ...)',
                            options: [
                                { flag: 'PRIMARY KEY', desc: 'Clé primaire (unique, not null)' },
                                { flag: 'NOT NULL', desc: 'Valeur obligatoire' },
                                { flag: 'UNIQUE', desc: 'Valeur unique' },
                                { flag: 'DEFAULT', desc: 'Valeur par défaut' },
                                { flag: 'FOREIGN KEY', desc: 'Clé étrangère' },
                                { flag: 'CHECK', desc: 'Contrainte de validation' }
                            ],
                            examples: [
                                { code: 'CREATE TABLE clients (\n  id INT PRIMARY KEY AUTO_INCREMENT,\n  nom VARCHAR(100) NOT NULL,\n  email VARCHAR(255) UNIQUE,\n  age INT CHECK (age >= 0),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n)', desc: 'Table avec contraintes' },
                                { code: 'CREATE TABLE commandes (\n  id INT PRIMARY KEY,\n  client_id INT NOT NULL,\n  montant DECIMAL(10, 2),\n  FOREIGN KEY (client_id) REFERENCES clients(id)\n)', desc: 'Avec clé étrangère' }
                            ],
                            tips: ['Types courants: INT, VARCHAR(n), TEXT, DECIMAL(p,s), DATE, TIMESTAMP, BOOLEAN'],
                            warnings: ['Syntaxe AUTO_INCREMENT (MySQL) vs SERIAL (PostgreSQL) vs IDENTITY (SQL Server)']
                        }
                    },
                    {
                        cmd: 'ALTER TABLE',
                        desc: 'Modifier une table',
                        details: {
                            explanation: 'Modifie la structure d\'une table existante.',
                            syntax: 'ALTER TABLE nom ADD/MODIFY/DROP ...',
                            options: [
                                { flag: 'ADD COLUMN', desc: 'Ajouter une colonne' },
                                { flag: 'DROP COLUMN', desc: 'Supprimer une colonne' },
                                { flag: 'MODIFY/ALTER COLUMN', desc: 'Modifier une colonne' },
                                { flag: 'ADD CONSTRAINT', desc: 'Ajouter une contrainte' },
                                { flag: 'RENAME TO', desc: 'Renommer la table' }
                            ],
                            examples: [
                                { code: 'ALTER TABLE clients ADD COLUMN telephone VARCHAR(20)', desc: 'Ajouter colonne' },
                                { code: 'ALTER TABLE clients DROP COLUMN fax', desc: 'Supprimer colonne' },
                                { code: 'ALTER TABLE clients\nALTER COLUMN email SET NOT NULL', desc: 'Rendre obligatoire (PostgreSQL)' },
                                { code: 'ALTER TABLE clients\nADD CONSTRAINT fk_ville\nFOREIGN KEY (ville_id) REFERENCES villes(id)', desc: 'Ajouter clé étrangère' }
                            ],
                            tips: ['Syntaxe MODIFY vs ALTER COLUMN varie selon le SGBD'],
                            warnings: ['Attention sur tables volumineuses (verrou)']
                        }
                    },
                    {
                        cmd: 'DROP TABLE / TRUNCATE',
                        desc: 'Supprimer une table',
                        details: {
                            explanation: 'DROP supprime la table et sa structure. TRUNCATE vide la table mais garde la structure.',
                            syntax: 'DROP TABLE nom / TRUNCATE TABLE nom',
                            options: [
                                { flag: 'IF EXISTS', desc: 'Pas d\'erreur si n\'existe pas' },
                                { flag: 'CASCADE', desc: 'Supprimer les dépendances' }
                            ],
                            examples: [
                                { code: 'DROP TABLE IF EXISTS temp_data', desc: 'Supprimer si existe' },
                                { code: 'DROP TABLE commandes CASCADE', desc: 'Supprimer avec dépendances' },
                                { code: 'TRUNCATE TABLE logs', desc: 'Vider la table (rapide)' }
                            ],
                            tips: ['TRUNCATE plus rapide que DELETE (pas de log ligne par ligne)', 'TRUNCATE remet les auto-increment à 0'],
                            warnings: ['DROP est irréversible!', 'TRUNCATE ne peut pas être rollback dans certains SGBD']
                        }
                    },
                    {
                        cmd: 'CREATE INDEX',
                        desc: 'Créer un index',
                        details: {
                            explanation: 'Accélère les recherches sur une ou plusieurs colonnes. Essentiel pour les performances.',
                            syntax: 'CREATE INDEX nom ON table (col1, col2)',
                            options: [
                                { flag: 'UNIQUE', desc: 'Index unique (pas de doublons)' },
                                { flag: 'DESC', desc: 'Index décroissant' },
                                { flag: 'WHERE', desc: 'Index partiel (PostgreSQL)' }
                            ],
                            examples: [
                                { code: 'CREATE INDEX idx_nom ON clients (nom)', desc: 'Index simple' },
                                { code: 'CREATE UNIQUE INDEX idx_email ON clients (email)', desc: 'Index unique' },
                                { code: 'CREATE INDEX idx_date_status ON commandes (date, status)', desc: 'Index composite' },
                                { code: 'CREATE INDEX idx_actifs ON clients (email) WHERE actif = TRUE', desc: 'Index partiel (PostgreSQL)' }
                            ],
                            tips: ['Indexer les colonnes utilisées dans WHERE, JOIN, ORDER BY', 'L\'ordre des colonnes est important pour les index composites'],
                            warnings: ['Les index ralentissent les INSERT/UPDATE', 'Trop d\'index = contre-productif']
                        }
                    }
                ]
            }
        ];
    </script>
    <script src="../js/cheatsheet.js"></script>
</body>
</html>
