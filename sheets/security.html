<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aide-m√©moire S√©curit√© Linux : workflows pratiques pour les permissions, SSH, chiffrement, audit et hardening.">
    <title>S√©curit√© Linux - IT Cheatsheets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body class="dark-theme text-slate-200">

    <header class="bg-slate-900/50 border-b border-white/5 py-8 px-4 relative overflow-hidden header-glow">
        <div class="max-w-4xl mx-auto relative z-10">
            <div class="flex items-center justify-between mb-4">
                <a href="../index.html" class="nav-back inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-arrow-left mr-2"></i>Retour
                </a>
                <a href="../index.html" class="inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-home mr-2"></i>Accueil
                </a>
            </div>
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-xl bg-red-500/20 mb-4 icon-glow">
                    <i class="fas fa-lock text-3xl text-red-400"></i>
                </div>
                <h1 class="text-3xl font-bold mb-2 gradient-text">S√©curit√© Linux</h1>
                <p class="text-slate-400">Workflows pratiques pour s√©curiser vos syst√®mes</p>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-4 relative z-10">
        <div class="mb-8 relative">
            <input type="text" id="searchInput" placeholder="Rechercher un workflow..."
                   class="search-dark w-full p-4 pl-12 rounded-lg outline-none transition">
            <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-500"></i>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="categoriesGrid"></div>
    </main>

    <div id="detailModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50 p-4 modal-overlay" onclick="closeModal(event)">
        <div class="modal-content-dark rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl modal-content" onclick="event.stopPropagation()">
            <div id="modalContent"></div>
        </div>
    </div>

    <footer class="border-t border-white/5 text-center text-slate-500 py-8 text-sm relative z-10">
        <p>&copy; 2026 - Dr FENOHASINA Toto Jean Felicien</p>
    </footer>

    <script>
        const cheatsheetData = [
            {
                id: 'control-file-access',
                title: 'üìÅ Contr√¥ler les Acc√®s aux Fichiers',
                icon: 'fa-folder-open',
                color: 'border-l-4 border-blue-500',
                commands: [
                    {
                        cmd: 'Modifier les permissions (chmod)',
                        desc: 'D√©finir qui peut lire, √©crire, ex√©cuter',
                        details: {
                            explanation: 'Change les permissions de lecture (r), √©criture (w) et ex√©cution (x) sur les fichiers et dossiers.',
                            syntax: 'chmod [options] mode fichier\nchmod [ugoa][+-=][rwx] fichier',
                            options: [
                                { flag: 'u', desc: 'User (propri√©taire)' },
                                { flag: 'g', desc: 'Group (groupe)' },
                                { flag: 'o', desc: 'Others (autres)' },
                                { flag: 'a', desc: 'All (tous)' },
                                { flag: '-R', desc: 'R√©cursif' },
                                { flag: '755', desc: 'rwxr-xr-x (dossiers/scripts)' },
                                { flag: '644', desc: 'rw-r--r-- (fichiers)' },
                                { flag: '600', desc: 'rw------- (fichiers sensibles)' }
                            ],
                            examples: [
                                { code: 'chmod 755 script.sh', desc: 'Ex√©cutable pour tous' },
                                { code: 'chmod 600 ~/.ssh/id_rsa', desc: 'Cl√© SSH priv√©e s√©curis√©e' },
                                { code: 'chmod u+x script.sh', desc: 'Ajouter ex√©cution pour le propri√©taire' },
                                { code: 'chmod -R 755 /var/www', desc: 'R√©cursif sur un dossier' }
                            ],
                            tips: ['Utilisez chmod +x pour les scripts, 600 pour les cl√©s priv√©es'],
                            warnings: ['chmod 777 est dangereux - √©vitez sauf cas tr√®s sp√©cifiques']
                        }
                    },
                    {
                        cmd: 'Changer le propri√©taire (chown)',
                        desc: 'Modifier le propri√©taire et le groupe',
                        details: {
                            explanation: 'Modifie le propri√©taire et/ou le groupe d\'un fichier ou dossier.',
                            syntax: 'chown [options] user[:group] fichier',
                            options: [
                                { flag: 'user', desc: 'Nouveau propri√©taire' },
                                { flag: 'user:group', desc: 'Propri√©taire et groupe' },
                                { flag: ':group', desc: 'Groupe seulement' },
                                { flag: '-R', desc: 'R√©cursif' }
                            ],
                            examples: [
                                { code: 'sudo chown www-data:www-data /var/www/html', desc: 'Pour serveur web' },
                                { code: 'sudo chown -R user:user /home/user', desc: 'Home directory' },
                                { code: 'sudo chown :developers project/', desc: 'Changer le groupe' }
                            ],
                            tips: ['chown n√©cessite souvent sudo'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'D√©finir les permissions par d√©faut (umask)',
                        desc: 'Contr√¥ler les permissions des nouveaux fichiers',
                        details: {
                            explanation: 'D√©finit les permissions par d√©faut pour les nouveaux fichiers et dossiers.',
                            syntax: 'umask [mask]',
                            options: [
                                { flag: '022', desc: 'D√©faut (fichiers 644, dossiers 755)' },
                                { flag: '077', desc: 'Restrictif (fichiers 600, dossiers 700)' },
                                { flag: '002', desc: 'Groupe permissif (fichiers 664)' }
                            ],
                            examples: [
                                { code: 'umask', desc: 'Voir le umask actuel' },
                                { code: 'umask 077', desc: 'Mode restrictif pour la session' },
                                { code: 'echo "umask 077" >> ~/.bashrc', desc: 'Permanent' }
                            ],
                            tips: ['Le umask est soustrait de 777 (dossiers) ou 666 (fichiers)'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Utiliser les ACL √©tendues',
                        desc: 'Permissions fines par utilisateur/groupe',
                        details: {
                            explanation: 'Les ACL permettent des permissions plus granulaires que les permissions Unix standard.',
                            syntax: 'setfacl [options] acl fichier\ngetfacl fichier',
                            options: [
                                { flag: '-m u:user:rwx', desc: 'Ajouter permissions pour un utilisateur' },
                                { flag: '-m g:group:rx', desc: 'Ajouter permissions pour un groupe' },
                                { flag: '-x u:user', desc: 'Supprimer ACL pour un utilisateur' },
                                { flag: '-R', desc: 'R√©cursif' },
                                { flag: '-b', desc: 'Supprimer toutes les ACL' }
                            ],
                            examples: [
                                { code: 'getfacl fichier.txt', desc: 'Voir les ACL' },
                                { code: 'setfacl -m u:john:rw fichier.txt', desc: 'Donner acc√®s √† john' },
                                { code: 'setfacl -m g:devs:rx /projet', desc: 'Acc√®s au groupe devs' },
                                { code: 'setfacl -b fichier.txt', desc: 'Supprimer toutes les ACL' }
                            ],
                            tips: ['Les ACL sont indiqu√©es par un + dans ls -l'],
                            warnings: ['Tous les syst√®mes de fichiers ne supportent pas les ACL']
                        }
                    }
                ]
            },
            {
                id: 'secure-ssh',
                title: 'üîë S√©curiser les Connexions SSH',
                icon: 'fa-key',
                color: 'border-l-4 border-green-500',
                commands: [
                    {
                        cmd: 'G√©n√©rer une paire de cl√©s',
                        desc: 'Cr√©er une authentification sans mot de passe',
                        details: {
                            explanation: 'Cr√©e une paire de cl√©s SSH (publique et priv√©e) pour l\'authentification sans mot de passe.',
                            syntax: 'ssh-keygen [options]',
                            options: [
                                { flag: '-t ed25519', desc: 'Type de cl√© (recommand√©)' },
                                { flag: '-t rsa -b 4096', desc: 'RSA 4096 bits (compatibilit√©)' },
                                { flag: '-C "comment"', desc: 'Commentaire (souvent email)' },
                                { flag: '-f fichier', desc: 'Fichier de sortie' },
                                { flag: '-N "passphrase"', desc: 'Passphrase' }
                            ],
                            examples: [
                                { code: 'ssh-keygen -t ed25519 -C "user@example.com"', desc: 'Cl√© Ed25519 (recommand√©)' },
                                { code: 'ssh-keygen -t rsa -b 4096 -C "user@example.com"', desc: 'Cl√© RSA 4096' },
                                { code: 'ssh-keygen -f ~/.ssh/github_key', desc: 'Cl√© d√©di√©e GitHub' }
                            ],
                            tips: ['Ed25519 est plus rapide et s√©curis√© que RSA'],
                            warnings: ['Prot√©gez toujours votre cl√© priv√©e avec une passphrase']
                        }
                    },
                    {
                        cmd: 'D√©ployer une cl√© sur un serveur',
                        desc: 'Copier la cl√© publique sur un serveur distant',
                        details: {
                            explanation: 'Copie votre cl√© publique dans authorized_keys du serveur distant.',
                            syntax: 'ssh-copy-id [options] user@host',
                            options: [
                                { flag: '-i keyfile', desc: 'Cl√© sp√©cifique √† copier' },
                                { flag: '-p port', desc: 'Port SSH personnalis√©' }
                            ],
                            examples: [
                                { code: 'ssh-copy-id user@server.com', desc: 'Copie de la cl√© par d√©faut' },
                                { code: 'ssh-copy-id -i ~/.ssh/custom_key.pub user@server', desc: 'Cl√© sp√©cifique' },
                                { code: 'ssh-copy-id -p 2222 user@server', desc: 'Port personnalis√©' }
                            ],
                            tips: ['Apr√®s ssh-copy-id, vous pouvez vous connecter sans mot de passe'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Configurer l\'agent SSH',
                        desc: 'G√©rer les cl√©s en m√©moire',
                        details: {
                            explanation: 'L\'agent SSH garde vos cl√©s d√©chiffr√©es en m√©moire pour √©viter de retaper la passphrase.',
                            syntax: 'ssh-agent / ssh-add',
                            options: [
                                { flag: 'ssh-add', desc: 'Ajouter la cl√© par d√©faut' },
                                { flag: 'ssh-add -l', desc: 'Lister les cl√©s charg√©es' },
                                { flag: 'ssh-add -D', desc: 'Supprimer toutes les cl√©s' },
                                { flag: 'ssh-add -t 3600', desc: 'Ajouter avec timeout (1h)' }
                            ],
                            examples: [
                                { code: 'eval $(ssh-agent)', desc: 'D√©marrer l\'agent' },
                                { code: 'ssh-add ~/.ssh/id_ed25519', desc: 'Ajouter une cl√©' },
                                { code: 'ssh-add -l', desc: 'Voir les cl√©s charg√©es' }
                            ],
                            tips: ['Ajoutez eval $(ssh-agent) √† votre .bashrc pour un d√©marrage automatique'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Durcir la configuration sshd_config',
                        desc: 'S√©curiser le serveur SSH',
                        details: {
                            explanation: 'Param√®tres recommand√©s pour s√©curiser le serveur SSH.',
                            syntax: '√âditer /etc/ssh/sshd_config',
                            options: [
                                { flag: 'PermitRootLogin no', desc: 'D√©sactiver login root' },
                                { flag: 'PasswordAuthentication no', desc: 'D√©sactiver auth par mot de passe' },
                                { flag: 'PubkeyAuthentication yes', desc: 'Activer auth par cl√©' },
                                { flag: 'Port 2222', desc: 'Changer le port par d√©faut' },
                                { flag: 'AllowUsers user1 user2', desc: 'Limiter les utilisateurs' }
                            ],
                            examples: [
                                { code: '# /etc/ssh/sshd_config\nPort 2222\nPermitRootLogin no\nPasswordAuthentication no\nPubkeyAuthentication yes\nAllowUsers admin deploy', desc: 'Config s√©curis√©e' },
                                { code: 'sudo systemctl restart sshd', desc: 'Appliquer les changements' }
                            ],
                            tips: ['Testez toujours l\'acc√®s avec une nouvelle session avant de fermer l\'ancienne'],
                            warnings: ['Assurez-vous que votre cl√© fonctionne AVANT de d√©sactiver PasswordAuthentication']
                        }
                    }
                ]
            },
            {
                id: 'encrypt-data',
                title: 'üîê Chiffrer les Donn√©es',
                icon: 'fa-lock',
                color: 'border-l-4 border-purple-500',
                commands: [
                    {
                        cmd: 'Chiffrer des fichiers avec GPG',
                        desc: 'Chiffrement sym√©trique ou asym√©trique',
                        details: {
                            explanation: 'GNU Privacy Guard pour le chiffrement, la signature et la gestion de cl√©s.',
                            syntax: 'gpg [options] fichier',
                            options: [
                                { flag: '--gen-key', desc: 'G√©n√©rer une paire de cl√©s' },
                                { flag: '-c', desc: 'Chiffrement sym√©trique (mot de passe)' },
                                { flag: '-e -r recipient', desc: 'Chiffrement asym√©trique' },
                                { flag: '-d', desc: 'D√©chiffrer' },
                                { flag: '--armor', desc: 'Sortie ASCII (base64)' },
                                { flag: '--sign', desc: 'Signer un fichier' }
                            ],
                            examples: [
                                { code: 'gpg -c fichier.txt', desc: 'Chiffrer avec mot de passe' },
                                { code: 'gpg -d fichier.txt.gpg > fichier.txt', desc: 'D√©chiffrer' },
                                { code: 'gpg --gen-key', desc: 'G√©n√©rer une paire de cl√©s' },
                                { code: 'gpg -e -r user@example.com fichier.txt', desc: 'Chiffrer pour quelqu\'un' }
                            ],
                            tips: ['Utilisez -c pour un chiffrement simple, -e -r pour partager de fa√ßon s√©curis√©e'],
                            warnings: ['N\'oubliez pas votre passphrase - impossible de r√©cup√©rer les donn√©es sinon']
                        }
                    },
                    {
                        cmd: 'G√©n√©rer des cl√©s et certificats (openssl)',
                        desc: 'Bo√Æte √† outils SSL/TLS',
                        details: {
                            explanation: 'Outil polyvalent pour le chiffrement, les certificats et les connexions SSL.',
                            syntax: 'openssl command [options]',
                            options: [
                                { flag: 'enc -aes-256-cbc', desc: 'Chiffrement AES' },
                                { flag: 'req -new -x509', desc: 'Certificat auto-sign√©' },
                                { flag: 's_client -connect', desc: 'Test connexion SSL' },
                                { flag: 'dgst -sha256', desc: 'Hash SHA256' },
                                { flag: 'rand -base64', desc: 'G√©n√©ration al√©atoire' }
                            ],
                            examples: [
                                { code: 'openssl enc -aes-256-cbc -salt -in file.txt -out file.enc', desc: 'Chiffrer un fichier' },
                                { code: 'openssl enc -d -aes-256-cbc -in file.enc -out file.txt', desc: 'D√©chiffrer' },
                                { code: 'openssl rand -base64 32', desc: 'G√©n√©rer un mot de passe' },
                                { code: 'openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365', desc: 'Certificat auto-sign√©' }
                            ],
                            tips: ['openssl rand est parfait pour g√©n√©rer des tokens/mots de passe'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Chiffrer un disque/partition (LUKS)',
                        desc: 'Chiffrement complet de volume',
                        details: {
                            explanation: 'Chiffrement de partitions et disques sous Linux.',
                            syntax: 'cryptsetup [action] [options] device',
                            options: [
                                { flag: 'luksFormat', desc: 'Initialiser le chiffrement LUKS' },
                                { flag: 'luksOpen', desc: 'D√©verrouiller un volume' },
                                { flag: 'luksClose', desc: 'Verrouiller un volume' },
                                { flag: 'luksAddKey', desc: 'Ajouter une cl√©/passphrase' }
                            ],
                            examples: [
                                { code: 'sudo cryptsetup luksFormat /dev/sdb1', desc: 'Chiffrer une partition' },
                                { code: 'sudo cryptsetup luksOpen /dev/sdb1 encrypted', desc: 'Ouvrir le volume' },
                                { code: 'sudo mount /dev/mapper/encrypted /mnt', desc: 'Monter le volume d√©chiffr√©' },
                                { code: 'sudo cryptsetup luksClose encrypted', desc: 'Fermer le volume' }
                            ],
                            tips: ['Apr√®s luksOpen, le volume appara√Æt dans /dev/mapper/'],
                            warnings: ['LUKS efface toutes les donn√©es lors du formatage!']
                        }
                    },
                    {
                        cmd: 'Cr√©er des mots de passe s√©curis√©s',
                        desc: 'G√©n√©ration de secrets al√©atoires',
                        details: {
                            explanation: 'G√©n√©rer des mots de passe et tokens s√©curis√©s.',
                            syntax: 'openssl rand / pwgen / /dev/urandom',
                            options: [
                                { flag: 'openssl rand -base64 N', desc: 'N octets en base64' },
                                { flag: 'pwgen -s N', desc: 'Mot de passe de N caract√®res' },
                                { flag: '/dev/urandom', desc: 'Source d\'entropie syst√®me' }
                            ],
                            examples: [
                                { code: 'openssl rand -base64 32', desc: '32 octets en base64' },
                                { code: 'openssl rand -hex 16', desc: '16 octets en hexad√©cimal' },
                                { code: 'pwgen -s 20 1', desc: 'Un mot de passe de 20 caract√®res' },
                                { code: 'head -c 32 /dev/urandom | base64', desc: 'Via /dev/urandom' }
                            ],
                            tips: ['Pr√©f√©rez openssl rand ou /dev/urandom aux g√©n√©rateurs simples'],
                            warnings: ['N\'utilisez jamais de g√©n√©rateurs pr√©dictibles pour la s√©curit√©']
                        }
                    }
                ]
            },
            {
                id: 'manage-users',
                title: 'üë• G√©rer les Utilisateurs',
                icon: 'fa-users',
                color: 'border-l-4 border-cyan-500',
                commands: [
                    {
                        cmd: 'Cr√©er et supprimer des utilisateurs',
                        desc: 'Gestion des comptes utilisateurs',
                        details: {
                            explanation: 'Cr√©er, modifier et supprimer des comptes utilisateurs.',
                            syntax: 'useradd [options] username\nuserdel [options] username',
                            options: [
                                { flag: '-m', desc: 'Cr√©er le home directory' },
                                { flag: '-s /bin/bash', desc: 'Shell par d√©faut' },
                                { flag: '-G groups', desc: 'Groupes suppl√©mentaires' },
                                { flag: 'userdel -r', desc: 'Supprimer avec home directory' }
                            ],
                            examples: [
                                { code: 'sudo useradd -m -s /bin/bash john', desc: 'Cr√©er un utilisateur' },
                                { code: 'sudo useradd -m -s /bin/bash -G sudo,docker dev', desc: 'Avec groupes' },
                                { code: 'sudo userdel -r olduser', desc: 'Supprimer avec donn√©es' }
                            ],
                            tips: ['N\'oubliez pas -m pour cr√©er le home directory'],
                            warnings: ['userdel -r supprime toutes les donn√©es de l\'utilisateur!']
                        }
                    },
                    {
                        cmd: 'G√©rer les mots de passe (passwd)',
                        desc: 'Modifier et contr√¥ler les mots de passe',
                        details: {
                            explanation: 'Modifie le mot de passe d\'un utilisateur et g√®re les politiques.',
                            syntax: 'passwd [options] [user]',
                            options: [
                                { flag: 'passwd', desc: 'Changer son propre mot de passe' },
                                { flag: 'passwd user', desc: 'Changer le mot de passe d\'un user (root)' },
                                { flag: '-l user', desc: 'Verrouiller le compte' },
                                { flag: '-u user', desc: 'D√©verrouiller le compte' },
                                { flag: '-e user', desc: 'Forcer le changement au prochain login' }
                            ],
                            examples: [
                                { code: 'passwd', desc: 'Changer son mot de passe' },
                                { code: 'sudo passwd john', desc: 'Changer le mdp de john' },
                                { code: 'sudo passwd -l hacker', desc: 'Verrouiller un compte' },
                                { code: 'sudo passwd -e newuser', desc: 'Forcer changement mdp' }
                            ],
                            tips: ['passwd -l est pr√©f√©rable √† supprimer un compte pour garder les traces'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Configurer les groupes (usermod)',
                        desc: 'Ajouter des utilisateurs aux groupes',
                        details: {
                            explanation: 'Modifie les propri√©t√©s d\'un compte utilisateur.',
                            syntax: 'usermod [options] user\ngroups [user]',
                            options: [
                                { flag: '-aG group', desc: 'Ajouter √† un groupe (sans retirer des autres)' },
                                { flag: '-L', desc: 'Verrouiller le compte' },
                                { flag: '-U', desc: 'D√©verrouiller' },
                                { flag: '-s /bin/bash', desc: 'Changer le shell' }
                            ],
                            examples: [
                                { code: 'groups', desc: 'Voir ses groupes' },
                                { code: 'sudo usermod -aG sudo john', desc: 'Ajouter john aux sudoers' },
                                { code: 'sudo usermod -aG docker $USER', desc: 'Ajouter au groupe docker' },
                                { code: 'sudo usermod -s /usr/sbin/nologin serviceuser', desc: 'D√©sactiver le login' }
                            ],
                            tips: ['-aG est important : sans -a, l\'utilisateur est retir√© des autres groupes'],
                            warnings: ['D√©connexion/reconnexion n√©cessaire pour que les groupes soient pris en compte']
                        }
                    },
                    {
                        cmd: 'D√©finir les droits sudo (visudo)',
                        desc: 'Configurer les privil√®ges administrateur',
                        details: {
                            explanation: 'Configure qui peut ex√©cuter quelles commandes en tant que root.',
                            syntax: 'visudo\n/etc/sudoers.d/',
                            options: [
                                { flag: 'user ALL=(ALL) ALL', desc: 'Tous les droits sudo' },
                                { flag: 'user ALL=(ALL) NOPASSWD: ALL', desc: 'Sans mot de passe' },
                                { flag: '%group ALL=(ALL) ALL', desc: 'Pour un groupe' }
                            ],
                            examples: [
                                { code: 'sudo visudo', desc: '√âditer sudoers (v√©rifie syntaxe)' },
                                { code: 'john ALL=(ALL) ALL', desc: 'Tous les droits pour john' },
                                { code: 'deploy ALL=(ALL) NOPASSWD: /usr/bin/systemctl', desc: 'Commande sp√©cifique sans mdp' },
                                { code: 'sudo -l', desc: 'Voir ses droits sudo' }
                            ],
                            tips: ['Utilisez visudo pour √©diter /etc/sudoers (v√©rifie la syntaxe)'],
                            warnings: ['Ne donnez pas de droits sudo sans n√©cessit√©']
                        }
                    }
                ]
            },
            {
                id: 'audit-system',
                title: 'üîç Auditer le Syst√®me',
                icon: 'fa-search',
                color: 'border-l-4 border-orange-500',
                commands: [
                    {
                        cmd: 'Consulter les logs systemd (journalctl)',
                        desc: 'Analyser les logs du syst√®me',
                        details: {
                            explanation: 'Consulter les logs du syst√®me avec systemd.',
                            syntax: 'journalctl [options]',
                            options: [
                                { flag: '-u service', desc: 'Logs d\'un service' },
                                { flag: '-f', desc: 'Suivre en temps r√©el' },
                                { flag: '-b', desc: 'Depuis le dernier boot' },
                                { flag: '--since "date"', desc: 'Depuis une date' },
                                { flag: '-p err', desc: 'Niveau de priorit√© (emerg, err, warning...)' }
                            ],
                            examples: [
                                { code: 'journalctl -f', desc: 'Suivre les logs en temps r√©el' },
                                { code: 'journalctl -u sshd -f', desc: 'Logs SSH en temps r√©el' },
                                { code: 'journalctl --since "1 hour ago"', desc: 'Derni√®re heure' },
                                { code: 'journalctl -p err -b', desc: 'Erreurs depuis le boot' }
                            ],
                            tips: ['journalctl -xe montre les derni√®res erreurs avec contexte'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Analyser l\'historique des connexions',
                        desc: 'Voir qui s\'est connect√©',
                        details: {
                            explanation: 'Affiche l\'historique des connexions utilisateurs.',
                            syntax: 'last [options]\nlastlog [options]',
                            options: [
                                { flag: 'last', desc: 'Derni√®res connexions' },
                                { flag: 'last user', desc: 'Connexions d\'un utilisateur' },
                                { flag: 'lastlog', desc: 'Derni√®re connexion de chaque user' },
                                { flag: 'lastb', desc: 'Tentatives √©chou√©es (sudo)' }
                            ],
                            examples: [
                                { code: 'last', desc: 'Derni√®res connexions' },
                                { code: 'last -n 20', desc: 'Les 20 derni√®res' },
                                { code: 'lastlog', desc: 'Derni√®re connexion par user' },
                                { code: 'sudo lastb', desc: 'Tentatives de connexion √©chou√©es' }
                            ],
                            tips: ['lastb n√©cessite sudo et montre les attaques brute force'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'D√©tecter les tentatives √©chou√©es',
                        desc: 'Surveiller les √©checs d\'authentification',
                        details: {
                            explanation: 'Identifier les tentatives de connexion √©chou√©es et les attaques.',
                            syntax: 'grep / journalctl / lastb',
                            options: [
                                { flag: 'lastb', desc: 'Fichier btmp des √©checs' },
                                { flag: '/var/log/auth.log', desc: 'Logs d\'authentification (Debian)' },
                                { flag: '/var/log/secure', desc: 'Logs d\'authentification (RHEL)' }
                            ],
                            examples: [
                                { code: 'sudo lastb | head -20', desc: 'Derniers √©checs de connexion' },
                                { code: 'grep "Failed password" /var/log/auth.log | tail -20', desc: '√âchecs SSH r√©cents' },
                                { code: 'journalctl -u sshd | grep "Failed"', desc: '√âchecs via journalctl' },
                                { code: 'sudo lastb | awk \'{print $3}\' | sort | uniq -c | sort -rn | head', desc: 'Top IPs attaquantes' }
                            ],
                            tips: ['Surveillez r√©guli√®rement les logs pour d√©tecter les attaques'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Configurer la rotation des logs',
                        desc: 'G√©rer l\'espace disque des logs',
                        details: {
                            explanation: 'Configure logrotate pour archiver et compresser les logs.',
                            syntax: '/etc/logrotate.conf\n/etc/logrotate.d/',
                            options: [
                                { flag: 'daily/weekly/monthly', desc: 'Fr√©quence de rotation' },
                                { flag: 'rotate N', desc: 'Garder N versions' },
                                { flag: 'compress', desc: 'Compresser les anciens logs' },
                                { flag: 'maxsize SIZE', desc: 'Rotation si taille d√©pass√©e' }
                            ],
                            examples: [
                                { code: 'cat /etc/logrotate.conf', desc: 'Config globale' },
                                { code: 'sudo logrotate -f /etc/logrotate.conf', desc: 'Forcer la rotation' },
                                { code: '# /etc/logrotate.d/myapp\n/var/log/myapp/*.log {\n  daily\n  rotate 7\n  compress\n  missingok\n}', desc: 'Config personnalis√©e' }
                            ],
                            tips: ['Testez avec logrotate -d (dry-run) avant d\'appliquer'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'block-attacks',
                title: 'üö´ Bloquer les Attaques',
                icon: 'fa-ban',
                color: 'border-l-4 border-red-500',
                commands: [
                    {
                        cmd: 'Configurer fail2ban',
                        desc: 'Bannir automatiquement les IPs malveillantes',
                        details: {
                            explanation: 'Surveille les logs et bannit les IPs malveillantes automatiquement.',
                            syntax: 'fail2ban-client [command]',
                            options: [
                                { flag: 'status', desc: '√âtat global' },
                                { flag: 'status sshd', desc: '√âtat du jail SSH' },
                                { flag: 'set sshd banip IP', desc: 'Bannir une IP manuellement' },
                                { flag: 'set sshd unbanip IP', desc: 'D√©bannir une IP' }
                            ],
                            examples: [
                                { code: 'sudo apt install fail2ban', desc: 'Installation' },
                                { code: 'sudo systemctl enable --now fail2ban', desc: 'Activer fail2ban' },
                                { code: 'sudo fail2ban-client status', desc: 'Voir les jails actifs' },
                                { code: 'sudo fail2ban-client status sshd', desc: 'IPs bannies pour SSH' }
                            ],
                            tips: ['Configurez /etc/fail2ban/jail.local pour personnaliser'],
                            warnings: ['Attention √† ne pas vous bannir vous-m√™me!']
                        }
                    },
                    {
                        cmd: 'G√©rer les IPs bannies',
                        desc: 'D√©bannir et lister les blocages',
                        details: {
                            explanation: 'G√©rer manuellement les IPs bloqu√©es par fail2ban.',
                            syntax: 'fail2ban-client [get|set] jail [action]',
                            options: [
                                { flag: 'get sshd banip', desc: 'Liste des IPs bannies' },
                                { flag: 'set sshd unbanip IP', desc: 'D√©bannir une IP' },
                                { flag: 'set sshd banip IP', desc: 'Bannir une IP' }
                            ],
                            examples: [
                                { code: 'sudo fail2ban-client set sshd unbanip 1.2.3.4', desc: 'D√©bannir une IP' },
                                { code: 'sudo fail2ban-client set sshd banip 5.6.7.8', desc: 'Bannir manuellement' },
                                { code: 'sudo fail2ban-client get sshd banip', desc: 'Lister les IPs bannies' },
                                { code: 'sudo zgrep "Ban" /var/log/fail2ban.log*', desc: 'Historique des bans' }
                            ],
                            tips: ['V√©rifiez les logs fail2ban pour comprendre pourquoi une IP a √©t√© bannie'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Personnaliser les r√®gles de d√©tection',
                        desc: 'Cr√©er des filtres personnalis√©s',
                        details: {
                            explanation: 'Cr√©er des jails personnalis√©s pour prot√©ger d\'autres services.',
                            syntax: '/etc/fail2ban/jail.local\n/etc/fail2ban/filter.d/',
                            options: [
                                { flag: 'maxretry', desc: 'Nombre de tentatives avant ban' },
                                { flag: 'bantime', desc: 'Dur√©e du ban' },
                                { flag: 'findtime', desc: 'Fen√™tre de temps pour les tentatives' },
                                { flag: 'ignoreip', desc: 'IPs √† ne jamais bannir' }
                            ],
                            examples: [
                                { code: '# /etc/fail2ban/jail.local\n[sshd]\nenabled = true\nmaxretry = 3\nbantime = 1h\nfindtime = 10m\nignoreip = 127.0.0.1/8 192.168.1.0/24', desc: 'Config SSH personnalis√©e' },
                                { code: '# Jail pour nginx\n[nginx-http-auth]\nenabled = true\nport = http,https\nlogpath = /var/log/nginx/error.log', desc: 'Prot√©ger nginx' }
                            ],
                            tips: ['Testez vos regex avec fail2ban-regex avant de les activer'],
                            warnings: ['Un findtime trop court peut ne pas d√©tecter les attaques lentes']
                        }
                    },
                    {
                        cmd: 'Int√©grer avec le firewall',
                        desc: 'Actions de blocage personnalis√©es',
                        details: {
                            explanation: 'Configurer comment fail2ban bloque les IPs (iptables, nftables, ufw).',
                            syntax: '/etc/fail2ban/action.d/',
                            options: [
                                { flag: 'banaction = iptables-multiport', desc: 'Action par d√©faut' },
                                { flag: 'banaction = ufw', desc: 'Utiliser ufw' },
                                { flag: 'banaction = nftables', desc: 'Utiliser nftables' }
                            ],
                            examples: [
                                { code: '# Utiliser ufw comme action\n[DEFAULT]\nbanaction = ufw', desc: 'Config pour ufw' },
                                { code: 'sudo iptables -L -n | grep fail2ban', desc: 'Voir les r√®gles fail2ban' },
                                { code: 'sudo ufw status', desc: 'V√©rifier les blocages ufw' }
                            ],
                            tips: ['ufw est plus simple √† g√©rer que iptables directement'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'harden-system',
                title: 'üõ°Ô∏è Durcir le Syst√®me',
                icon: 'fa-shield-virus',
                color: 'border-l-4 border-amber-500',
                commands: [
                    {
                        cmd: 'Activer les mises √† jour automatiques',
                        desc: 'Installer les correctifs de s√©curit√©',
                        details: {
                            explanation: 'Configure les mises √† jour de s√©curit√© automatiques sur Debian/Ubuntu.',
                            syntax: 'apt install unattended-upgrades',
                            options: [
                                { flag: 'unattended-upgrades', desc: 'Package pour updates auto' },
                                { flag: 'apt-listchanges', desc: 'Notification des changements' }
                            ],
                            examples: [
                                { code: 'sudo apt install unattended-upgrades apt-listchanges', desc: 'Installation' },
                                { code: 'sudo dpkg-reconfigure unattended-upgrades', desc: 'Configuration interactive' },
                                { code: 'cat /etc/apt/apt.conf.d/50unattended-upgrades', desc: 'Voir la configuration' },
                                { code: 'sudo unattended-upgrade --dry-run', desc: 'Simuler une mise √† jour' }
                            ],
                            tips: ['Activez les notifications email pour √™tre inform√© des mises √† jour'],
                            warnings: ['Testez en staging avant d\'activer sur des serveurs critiques']
                        }
                    },
                    {
                        cmd: 'Configurer AppArmor',
                        desc: 'Contr√¥le d\'acc√®s obligatoire (Ubuntu)',
                        details: {
                            explanation: 'Syst√®me de s√©curit√© MAC pour restreindre les applications.',
                            syntax: 'aa-status / aa-enforce / aa-complain',
                            options: [
                                { flag: 'aa-status', desc: '√âtat AppArmor' },
                                { flag: 'aa-enforce', desc: 'Activer un profil en mode enforce' },
                                { flag: 'aa-complain', desc: 'Mode apprentissage (log only)' },
                                { flag: 'aa-disable', desc: 'D√©sactiver un profil' }
                            ],
                            examples: [
                                { code: 'sudo aa-status', desc: '√âtat AppArmor' },
                                { code: 'sudo aa-enforce /etc/apparmor.d/usr.bin.firefox', desc: 'Activer un profil' },
                                { code: 'sudo aa-complain /etc/apparmor.d/usr.sbin.nginx', desc: 'Mode apprentissage' },
                                { code: 'sudo systemctl reload apparmor', desc: 'Recharger les profils' }
                            ],
                            tips: ['Utilisez aa-complain pour d√©boguer avant aa-enforce'],
                            warnings: ['Ne d√©sactivez pas AppArmor sans bonne raison']
                        }
                    },
                    {
                        cmd: 'Configurer SELinux',
                        desc: 'Contr√¥le d\'acc√®s obligatoire (RHEL)',
                        details: {
                            explanation: 'Syst√®me de s√©curit√© MAC pour RHEL/CentOS/Fedora.',
                            syntax: 'getenforce / setenforce / sestatus',
                            options: [
                                { flag: 'getenforce', desc: 'Mode actuel (Enforcing/Permissive/Disabled)' },
                                { flag: 'setenforce 1', desc: 'Activer temporairement' },
                                { flag: 'setenforce 0', desc: 'Mode permissif temporaire' },
                                { flag: '/etc/selinux/config', desc: 'Configuration permanente' }
                            ],
                            examples: [
                                { code: 'getenforce', desc: 'Mode SELinux' },
                                { code: 'sudo setenforce 1', desc: 'Activer SELinux (temporaire)' },
                                { code: 'sestatus', desc: '√âtat d√©taill√©' },
                                { code: 'sudo ausearch -m avc -ts recent', desc: 'Voir les blocages r√©cents' }
                            ],
                            tips: ['Utilisez audit2allow pour cr√©er des politiques √† partir des logs'],
                            warnings: ['Modifier les politiques SELinux n√©cessite une expertise']
                        }
                    },
                    {
                        cmd: 'Appliquer les bonnes pratiques',
                        desc: 'Checklist de s√©curit√© essentielle',
                        details: {
                            explanation: 'Liste des points de s√©curit√© essentiels pour un serveur Linux.',
                            syntax: 'V√©rifications manuelles et automatiques',
                            options: [
                                { flag: '1', desc: 'Mises √† jour r√©guli√®res activ√©es' },
                                { flag: '2', desc: 'SSH par cl√©, root d√©sactiv√©' },
                                { flag: '3', desc: 'Firewall configur√© (ufw/iptables)' },
                                { flag: '4', desc: 'fail2ban install√© et actif' },
                                { flag: '5', desc: 'Utilisateurs avec privil√®ges minimaux' },
                                { flag: '6', desc: 'Logs centralis√©s et surveill√©s' },
                                { flag: '7', desc: 'Backups chiffr√©s et test√©s' }
                            ],
                            examples: [
                                { code: '# Script de v√©rification rapide\necho "=== SSH ===" && grep -E "^(PermitRootLogin|PasswordAuthentication)" /etc/ssh/sshd_config\necho "=== UFW ===" && sudo ufw status\necho "=== Fail2ban ===" && sudo fail2ban-client status\necho "=== Updates ===" && apt list --upgradable 2>/dev/null | head', desc: 'Script audit rapide' }
                            ],
                            tips: ['Automatisez les audits avec des outils comme Lynis'],
                            warnings: ['La s√©curit√© est un processus continu, pas une configuration unique']
                        }
                    }
                ]
            },
            {
                id: 'scan-vulnerabilities',
                title: 'üî¨ Scanner les Vuln√©rabilit√©s',
                icon: 'fa-search-plus',
                color: 'border-l-4 border-pink-500',
                commands: [
                    {
                        cmd: 'Scanner les ports ouverts (nmap)',
                        desc: 'D√©couvrir les services expos√©s',
                        details: {
                            explanation: 'Outil de d√©couverte r√©seau et d\'audit de s√©curit√©.',
                            syntax: 'nmap [options] target',
                            options: [
                                { flag: '-sT', desc: 'TCP connect scan' },
                                { flag: '-sV', desc: 'D√©tection des versions' },
                                { flag: '-A', desc: 'Scan agressif (OS, versions, scripts)' },
                                { flag: '-p-', desc: 'Tous les ports' },
                                { flag: '--script vuln', desc: 'Scripts de vuln√©rabilit√©' }
                            ],
                            examples: [
                                { code: 'nmap -sT localhost', desc: 'Ports ouverts localement' },
                                { code: 'nmap -sV -p 22,80,443 server.com', desc: 'Versions des services' },
                                { code: 'nmap -A server.com', desc: 'Scan complet' },
                                { code: 'nmap --script vuln server.com', desc: 'Recherche de vuln√©rabilit√©s' }
                            ],
                            tips: ['Scannez votre propre serveur r√©guli√®rement pour d√©tecter les services expos√©s'],
                            warnings: ['Ne scannez JAMAIS des syst√®mes sans autorisation']
                        }
                    },
                    {
                        cmd: 'Auditer la configuration (Lynis)',
                        desc: 'Audit de s√©curit√© complet',
                        details: {
                            explanation: 'Outil d\'audit de s√©curit√© pour Linux, macOS et Unix.',
                            syntax: 'lynis audit system',
                            options: [
                                { flag: 'audit system', desc: 'Audit complet du syst√®me' },
                                { flag: '--quick', desc: 'Audit rapide' },
                                { flag: '--pentest', desc: 'Mode pentest' },
                                { flag: '--report-file', desc: 'Sauvegarder le rapport' }
                            ],
                            examples: [
                                { code: 'sudo apt install lynis', desc: 'Installation' },
                                { code: 'sudo lynis audit system', desc: 'Audit complet' },
                                { code: 'sudo lynis audit system --quick', desc: 'Audit rapide' },
                                { code: 'cat /var/log/lynis.log', desc: 'Voir le rapport' }
                            ],
                            tips: ['Lynis donne un score de durcissement et des recommandations pr√©cises'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'V√©rifier les packages vuln√©rables',
                        desc: 'D√©tecter les CVE dans les packages',
                        details: {
                            explanation: 'Identifier les packages avec des vuln√©rabilit√©s connues.',
                            syntax: 'apt / unattended-upgrades',
                            options: [
                                { flag: 'apt list --upgradable', desc: 'Packages √† mettre √† jour' },
                                { flag: 'apt-get upgrade -s', desc: 'Simulation de mise √† jour' }
                            ],
                            examples: [
                                { code: 'apt list --upgradable', desc: 'Voir les mises √† jour disponibles' },
                                { code: 'sudo apt-get upgrade -s', desc: 'Simuler les mises √† jour' },
                                { code: 'apt-cache policy package-name', desc: 'Versions disponibles' },
                                { code: 'dpkg -l | grep -i security', desc: 'Packages de s√©curit√©' }
                            ],
                            tips: ['Abonnez-vous aux listes de s√©curit√© de votre distribution'],
                            warnings: ['Testez les mises √† jour en staging avant production']
                        }
                    },
                    {
                        cmd: 'Analyser les permissions sensibles',
                        desc: 'Trouver les fichiers √† risque',
                        details: {
                            explanation: 'Identifier les fichiers avec des permissions dangereuses.',
                            syntax: 'find / -perm ...',
                            options: [
                                { flag: '-perm -4000', desc: 'Fichiers SUID' },
                                { flag: '-perm -2000', desc: 'Fichiers SGID' },
                                { flag: '-perm -0002', desc: '√âcriture world-writable' }
                            ],
                            examples: [
                                { code: 'find / -perm -4000 -type f 2>/dev/null', desc: 'Trouver les fichiers SUID' },
                                { code: 'find / -perm -0002 -type f 2>/dev/null', desc: 'Fichiers world-writable' },
                                { code: 'find /home -name ".*history" 2>/dev/null', desc: 'Fichiers historique' },
                                { code: 'find / -nouser -o -nogroup 2>/dev/null', desc: 'Fichiers orphelins' }
                            ],
                            tips: ['V√©rifiez r√©guli√®rement les nouveaux fichiers SUID'],
                            warnings: ['Les fichiers SUID peuvent √™tre exploit√©s pour l\'√©l√©vation de privil√®ges']
                        }
                    }
                ]
            },
            {
                id: 'backup-restore',
                title: 'üíæ Sauvegarder et Restaurer',
                icon: 'fa-database',
                color: 'border-l-4 border-indigo-500',
                commands: [
                    {
                        cmd: 'Cr√©er des sauvegardes chiffr√©es',
                        desc: 'Backup s√©curis√© avec tar et gpg',
                        details: {
                            explanation: 'Cr√©er des archives compress√©es et chiffr√©es.',
                            syntax: 'tar + gpg / rsync + encryption',
                            options: [
                                { flag: 'tar czf', desc: 'Cr√©er archive gzip' },
                                { flag: 'gpg -c', desc: 'Chiffrer avec mot de passe' },
                                { flag: 'gpg -e -r', desc: 'Chiffrer pour un destinataire' }
                            ],
                            examples: [
                                { code: 'tar czf - /data | gpg -c -o backup.tar.gz.gpg', desc: 'Backup chiffr√© en une commande' },
                                { code: 'gpg -d backup.tar.gz.gpg | tar xzf -', desc: 'Restaurer le backup' },
                                { code: 'tar czf /backup/home-$(date +%Y%m%d).tar.gz /home', desc: 'Backup dat√©' }
                            ],
                            tips: ['Stockez la passphrase de fa√ßon s√©curis√©e et s√©par√©e'],
                            warnings: ['Testez r√©guli√®rement la restauration de vos backups']
                        }
                    },
                    {
                        cmd: 'Automatiser les backups (rsync + cron)',
                        desc: 'Sauvegardes incr√©mentales planifi√©es',
                        details: {
                            explanation: 'Configurer des sauvegardes automatiques avec rsync et cron.',
                            syntax: 'rsync + crontab',
                            options: [
                                { flag: '-a', desc: 'Mode archive (pr√©serve tout)' },
                                { flag: '-v', desc: 'Verbose' },
                                { flag: '--delete', desc: 'Miroir exact' },
                                { flag: '--backup', desc: 'Garder les anciennes versions' }
                            ],
                            examples: [
                                { code: '#!/bin/bash\n# /usr/local/bin/backup.sh\nrsync -avz --delete /data/ /backup/data/\nrsync -avz /etc/ /backup/etc/', desc: 'Script de backup' },
                                { code: 'crontab -e\n# Backup quotidien √† 2h\n0 2 * * * /usr/local/bin/backup.sh >> /var/log/backup.log 2>&1', desc: 'Cron job' },
                                { code: 'rsync -avz -e ssh /data/ user@backup-server:/backup/', desc: 'Backup vers serveur distant' }
                            ],
                            tips: ['Utilisez rsync avec --dry-run pour tester avant d\'ex√©cuter'],
                            warnings: ['--delete supprime les fichiers sur la destination!']
                        }
                    },
                    {
                        cmd: 'V√©rifier l\'int√©grit√© des sauvegardes',
                        desc: 'Valider que les backups sont exploitables',
                        details: {
                            explanation: 'V√©rifier que les sauvegardes peuvent √™tre restaur√©es.',
                            syntax: 'md5sum / sha256sum / tar tvf',
                            options: [
                                { flag: 'sha256sum', desc: 'Calculer le hash SHA256' },
                                { flag: 'tar tvf', desc: 'Lister le contenu d\'une archive' },
                                { flag: 'gpg -d', desc: 'Tester le d√©chiffrement' }
                            ],
                            examples: [
                                { code: 'sha256sum backup.tar.gz > backup.sha256', desc: 'Cr√©er checksum' },
                                { code: 'sha256sum -c backup.sha256', desc: 'V√©rifier checksum' },
                                { code: 'tar tvf backup.tar.gz | head', desc: 'Lister le contenu' },
                                { code: 'gpg -d backup.tar.gz.gpg > /dev/null && echo "OK"', desc: 'Tester d√©chiffrement' }
                            ],
                            tips: ['Gardez les checksums avec les backups pour v√©rification'],
                            warnings: ['Un backup non test√© n\'est pas un backup!']
                        }
                    },
                    {
                        cmd: 'Restaurer en cas d\'incident',
                        desc: 'Proc√©dure de r√©cup√©ration',
                        details: {
                            explanation: 'Restaurer les donn√©es depuis une sauvegarde.',
                            syntax: 'tar / rsync / gpg',
                            options: [
                                { flag: 'tar xzf', desc: 'Extraire archive gzip' },
                                { flag: 'rsync -av', desc: 'Restaurer depuis backup' },
                                { flag: '-C /path', desc: 'Destination d\'extraction' }
                            ],
                            examples: [
                                { code: 'gpg -d backup.tar.gz.gpg | tar xzf - -C /restore/', desc: 'Restaurer backup chiffr√©' },
                                { code: 'rsync -av /backup/data/ /data/', desc: 'Restaurer depuis miroir' },
                                { code: 'tar xzf backup.tar.gz -C /tmp/test/', desc: 'Restaurer dans un dossier test' },
                                { code: 'diff -r /tmp/test/data /data', desc: 'Comparer avec les donn√©es actuelles' }
                            ],
                            tips: ['Restaurez d\'abord dans un dossier temporaire pour v√©rifier'],
                            warnings: ['Attention √† ne pas √©craser des donn√©es plus r√©centes']
                        }
                    }
                ]
            },
            {
                id: 'project-security',
                title: 'üéØ Projet: S√©curiser un Serveur',
                icon: 'fa-wrench',
                color: 'border-l-4 border-emerald-500',
                commands: [
                    {
                        cmd: '√âtape 1: Audit initial',
                        desc: '√âvaluer l\'√©tat actuel',
                        details: {
                            explanation: 'Commencer par un audit complet du syst√®me.',
                            syntax: 'V√©rifications syst√®me',
                            options: [],
                            examples: [
                                { code: '#!/bin/bash\n# security-audit.sh\necho "=== AUDIT S√âCURIT√â ==="\necho "Date: $(date)"\necho\n\necho "--- Utilisateurs avec shell ---"\ngrep -v "nologin\\|false" /etc/passwd\necho\n\necho "--- Ports ouverts ---"\nss -tulnp | grep LISTEN\necho\n\necho "--- Services actifs ---"\nsystemctl list-units --type=service --state=running\necho\n\necho "--- Fichiers SUID ---"\nfind /usr -perm -4000 -type f 2>/dev/null', desc: 'Script d\'audit initial' }
                            ],
                            tips: ['Documentez l\'√©tat initial avant toute modification'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 2: Configuration SSH s√©curis√©e',
                        desc: 'Durcir l\'acc√®s SSH',
                        details: {
                            explanation: 'Configurer SSH avec authentification par cl√© uniquement.',
                            syntax: '/etc/ssh/sshd_config',
                            options: [],
                            examples: [
                                { code: '# 1. G√©n√©rer et d√©ployer la cl√©\nssh-keygen -t ed25519\nssh-copy-id user@server\n\n# 2. Tester la connexion par cl√©\nssh user@server\n\n# 3. Durcir sshd_config\nsudo tee -a /etc/ssh/sshd_config.d/hardening.conf << EOF\nPermitRootLogin no\nPasswordAuthentication no\nPubkeyAuthentication yes\nAllowUsers admin deploy\nMaxAuthTries 3\nEOF\n\n# 4. Red√©marrer SSH\nsudo systemctl restart sshd', desc: 'Configuration SSH s√©curis√©e' }
                            ],
                            tips: ['Gardez une session ouverte pendant les tests'],
                            warnings: ['Testez l\'acc√®s par cl√© AVANT de d√©sactiver les mots de passe']
                        }
                    },
                    {
                        cmd: '√âtape 3: Mise en place du firewall',
                        desc: 'Configurer ufw/iptables',
                        details: {
                            explanation: 'Configurer le pare-feu pour n\'autoriser que le n√©cessaire.',
                            syntax: 'ufw',
                            options: [],
                            examples: [
                                { code: '# Configurer ufw\nsudo ufw default deny incoming\nsudo ufw default allow outgoing\n\n# Autoriser SSH (important!)\nsudo ufw allow ssh\n\n# Autoriser HTTP/HTTPS si serveur web\nsudo ufw allow http\nsudo ufw allow https\n\n# Activer le firewall\nsudo ufw enable\n\n# V√©rifier\nsudo ufw status verbose', desc: 'Configuration firewall' }
                            ],
                            tips: ['Toujours autoriser SSH avant d\'activer le firewall'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 4: Installation fail2ban',
                        desc: 'Protection contre brute force',
                        details: {
                            explanation: 'Installer et configurer fail2ban pour bloquer les attaques.',
                            syntax: 'fail2ban',
                            options: [],
                            examples: [
                                { code: '# Installation\nsudo apt install fail2ban\n\n# Configuration\nsudo tee /etc/fail2ban/jail.local << EOF\n[DEFAULT]\nbantime = 1h\nfindtime = 10m\nmaxretry = 5\nignoreip = 127.0.0.1/8\n\n[sshd]\nenabled = true\nport = ssh\nmaxretry = 3\nEOF\n\n# Activer\nsudo systemctl enable --now fail2ban\nsudo fail2ban-client status', desc: 'Configuration fail2ban' }
                            ],
                            tips: ['Ajoutez votre IP √† ignoreip pour ne pas vous bannir'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 5: Mises √† jour automatiques',
                        desc: 'Installer les correctifs de s√©curit√©',
                        details: {
                            explanation: 'Configurer les mises √† jour de s√©curit√© automatiques.',
                            syntax: 'unattended-upgrades',
                            options: [],
                            examples: [
                                { code: '# Installation\nsudo apt install unattended-upgrades apt-listchanges\n\n# Configuration\nsudo dpkg-reconfigure -plow unattended-upgrades\n\n# V√©rifier\ncat /etc/apt/apt.conf.d/20auto-upgrades\n\n# Test\nsudo unattended-upgrade --dry-run', desc: 'Mises √† jour automatiques' }
                            ],
                            tips: ['Configurez les notifications email pour √™tre alert√©'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 6: Configuration de la surveillance',
                        desc: 'Logs et monitoring',
                        details: {
                            explanation: 'Mettre en place la surveillance des logs.',
                            syntax: 'journalctl / logwatch',
                            options: [],
                            examples: [
                                { code: '# Installer logwatch (r√©sum√© quotidien par email)\nsudo apt install logwatch\n\n# Configuration\nsudo tee /etc/logwatch/conf/logwatch.conf << EOF\nMailTo = admin@example.com\nMailFrom = logwatch@server.com\nDetail = Med\nEOF\n\n# Alias pour surveillance rapide\nalias logs="journalctl -f"\nalias auth="journalctl -u sshd -f"', desc: 'Surveillance des logs' }
                            ],
                            tips: ['V√©rifiez les logs r√©guli√®rement pour d√©tecter les anomalies'],
                            warnings: []
                        }
                    },
                    {
                        cmd: '√âtape 7: V√©rification finale',
                        desc: 'Checklist de validation',
                        details: {
                            explanation: 'V√©rifier que toutes les mesures sont en place.',
                            syntax: 'Script de v√©rification',
                            options: [],
                            examples: [
                                { code: '#!/bin/bash\n# security-check.sh\necho "=== V√âRIFICATION S√âCURIT√â ==="\nERRORS=0\n\n# SSH\ngrep -q "PasswordAuthentication no" /etc/ssh/sshd_config* 2>/dev/null && echo "‚úì SSH: Passwords disabled" || { echo "‚úó SSH: Passwords enabled"; ((ERRORS++)); }\n\n# Firewall\nsudo ufw status | grep -q "Status: active" && echo "‚úì UFW: Active" || { echo "‚úó UFW: Inactive"; ((ERRORS++)); }\n\n# Fail2ban\nsystemctl is-active --quiet fail2ban && echo "‚úì Fail2ban: Running" || { echo "‚úó Fail2ban: Not running"; ((ERRORS++)); }\n\n# Updates\ntest -f /etc/apt/apt.conf.d/20auto-upgrades && echo "‚úì Auto-updates: Configured" || { echo "‚úó Auto-updates: Not configured"; ((ERRORS++)); }\n\necho\n[ $ERRORS -eq 0 ] && echo "S√©curit√©: OK" || echo "S√©curit√©: $ERRORS probl√®me(s)"', desc: 'Script de v√©rification' }
                            ],
                            tips: ['Ex√©cutez ce script r√©guli√®rement pour valider la configuration'],
                            warnings: ['La s√©curit√© est un processus continu']
                        }
                    }
                ]
            }
        ];
    </script>
    <script src="../js/cheatsheet.js"></script>
</body>
</html>
