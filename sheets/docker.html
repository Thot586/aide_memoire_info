<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Aide-m√©moire Docker et Docker Compose : images, conteneurs, volumes, r√©seaux, orchestration et d√©ploiement.">
    <title>Docker et Docker Compose - IT Cheatsheets</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="../css/styles.css">
</head>
<body class="dark-theme text-slate-200">

    <header class="bg-slate-900/50 border-b border-white/5 py-8 px-4 relative overflow-hidden header-glow">
        <div class="max-w-4xl mx-auto relative z-10">
            <div class="flex items-center justify-between mb-4">
                <a href="../index.html" class="nav-back inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-arrow-left mr-2"></i>Retour
                </a>
                <a href="../index.html" class="inline-flex items-center text-slate-400 hover:text-sky-400 transition">
                    <i class="fas fa-home mr-2"></i>Accueil
                </a>
            </div>
            <div class="text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 rounded-xl bg-sky-500/20 mb-4 icon-glow">
                    <i class="fab fa-docker text-3xl text-sky-400"></i>
                </div>
                <h1 class="text-3xl font-bold mb-2 gradient-text">Docker et Docker Compose</h1>
                <p class="text-slate-400">Images, conteneurs, volumes, reseaux et orchestration</p>
            </div>
        </div>
    </header>

    <main class="max-w-4xl mx-auto p-4 relative z-10">
        <div class="mb-8 relative">
            <input type="text" id="searchInput" placeholder="Rechercher une commande..."
                   class="search-dark w-full p-4 pl-12 rounded-lg outline-none transition">
            <i class="fas fa-search absolute left-4 top-1/2 transform -translate-y-1/2 text-slate-500"></i>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6" id="categoriesGrid"></div>
    </main>

    <div id="detailModal" class="fixed inset-0 bg-black/70 hidden items-center justify-center z-50 p-4 modal-overlay" onclick="closeModal(event)">
        <div class="modal-content-dark rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl modal-content" onclick="event.stopPropagation()">
            <div id="modalContent"></div>
        </div>
    </div>

    <footer class="border-t border-white/5 text-center text-slate-500 py-8 text-sm relative z-10">
        <p>¬© 2026 - Dr FENOHASINA Toto Jean Felicien</p>
    </footer>

    <script>
        const cheatsheetData = [
            {
                id: 'build-images',
                title: 'üì¶ Creer et Gerer des Images',
                icon: 'fa-box',
                color: 'border-l-4 border-blue-500',
                commands: [
                    {
                        cmd: 'Construire une image',
                        desc: 'docker build -t name:tag .',
                        details: {
                            explanation: 'Construit une image Docker a partir d\'un Dockerfile dans le repertoire courant ou specifie.',
                            syntax: 'docker build [OPTIONS] PATH | URL | -',
                            options: [
                                { flag: '-t, --tag', desc: 'Nom et tag de l\'image (name:tag)' },
                                { flag: '-f, --file', desc: 'Chemin vers le Dockerfile' },
                                { flag: '--no-cache', desc: 'Ne pas utiliser le cache' },
                                { flag: '--build-arg', desc: 'Variables de build (ARG)' },
                                { flag: '--target', desc: 'Stage cible (multi-stage)' }
                            ],
                            examples: [
                                { code: 'docker build -t myapp:1.0 .', desc: 'Build avec tag' },
                                { code: 'docker build -t myapp:latest -f Dockerfile.prod .', desc: 'Dockerfile specifique' },
                                { code: 'docker build --build-arg NODE_ENV=production -t myapp:prod .', desc: 'Avec build args' },
                                { code: 'docker build --target builder -t myapp:builder .', desc: 'Multi-stage target' }
                            ],
                            tips: ['Utilisez .dockerignore pour exclure les fichiers inutiles', 'Ordonnez les instructions du moins au plus changeant pour optimiser le cache'],
                            warnings: ['Le contexte de build inclut tous les fichiers du repertoire']
                        }
                    },
                    {
                        cmd: 'Ecrire un Dockerfile efficace',
                        desc: 'FROM, RUN, COPY, CMD, best practices',
                        details: {
                            explanation: 'Structure et bonnes pratiques pour ecrire un Dockerfile optimise.',
                            syntax: 'FROM base\nRUN commands\nCOPY src dest\nCMD ["executable"]',
                            options: [
                                { flag: 'FROM', desc: 'Image de base' },
                                { flag: 'RUN', desc: 'Execute une commande (nouvelle layer)' },
                                { flag: 'COPY', desc: 'Copie fichiers du contexte' },
                                { flag: 'ADD', desc: 'Copie + extraction archives/URLs' },
                                { flag: 'CMD', desc: 'Commande par defaut au demarrage' },
                                { flag: 'ENTRYPOINT', desc: 'Point d\'entree fixe' },
                                { flag: 'WORKDIR', desc: 'Repertoire de travail' },
                                { flag: 'ENV', desc: 'Variables d\'environnement' },
                                { flag: 'EXPOSE', desc: 'Documente les ports' },
                                { flag: 'ARG', desc: 'Variables de build' }
                            ],
                            examples: [
                                { code: '# Python app\nFROM python:3.11-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY . .\nEXPOSE 8000\nCMD ["python", "app.py"]', desc: 'App Python optimisee' },
                                { code: '# Node.js app\nFROM node:20-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production\nCOPY . .\nEXPOSE 3000\nCMD ["node", "server.js"]', desc: 'App Node.js' }
                            ],
                            tips: ['Utilisez des images slim/alpine pour reduire la taille', 'Combinez les RUN pour reduire les layers', 'Copiez d\'abord les dependances puis le code'],
                            warnings: ['Evitez ADD sauf pour extraire des archives', 'Ne stockez jamais de secrets dans le Dockerfile']
                        }
                    },
                    {
                        cmd: 'Multi-stage builds',
                        desc: 'Builder pattern, reduire taille',
                        details: {
                            explanation: 'Utilise plusieurs FROM pour separer build et runtime, reduisant la taille finale.',
                            syntax: 'FROM base AS builder\n...\nFROM runtime\nCOPY --from=builder /path /path',
                            options: [
                                { flag: 'AS name', desc: 'Nomme le stage' },
                                { flag: '--from=stage', desc: 'Copie depuis un stage' },
                                { flag: '--target', desc: 'Build jusqu\'a un stage specifique' }
                            ],
                            examples: [
                                { code: '# Multi-stage Go\nFROM golang:1.21 AS builder\nWORKDIR /app\nCOPY . .\nRUN CGO_ENABLED=0 go build -o main .\n\nFROM alpine:3.18\nCOPY --from=builder /app/main /main\nCMD ["/main"]', desc: 'Go: 1GB -> 15MB' },
                                { code: '# Multi-stage React\nFROM node:20 AS builder\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci\nCOPY . .\nRUN npm run build\n\nFROM nginx:alpine\nCOPY --from=builder /app/dist /usr/share/nginx/html', desc: 'React avec Nginx' }
                            ],
                            tips: ['Reduit drastiquement la taille des images', 'Le stage final ne contient que le necessaire'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Tagger et versionner',
                        desc: 'docker tag, semantic versioning',
                        details: {
                            explanation: 'Ajoute des tags a une image pour la versionner et la referencer facilement.',
                            syntax: 'docker tag SOURCE_IMAGE[:TAG] TARGET_IMAGE[:TAG]',
                            options: [
                                { flag: 'latest', desc: 'Tag par defaut (derniere version)' },
                                { flag: 'v1.0.0', desc: 'Semantic versioning' },
                                { flag: 'sha-abc123', desc: 'Tag par commit SHA' }
                            ],
                            examples: [
                                { code: 'docker tag myapp:latest myapp:1.0.0', desc: 'Tag version' },
                                { code: 'docker tag myapp:latest registry.example.com/myapp:1.0.0', desc: 'Tag pour registry' },
                                { code: 'docker tag myapp:latest myapp:$(git rev-parse --short HEAD)', desc: 'Tag avec commit SHA' }
                            ],
                            tips: ['Utilisez le semantic versioning (major.minor.patch)', 'Tagguez aussi avec le SHA du commit pour tracabilite'],
                            warnings: ['latest ne signifie pas forcement la plus recente - evitez en production']
                        }
                    },
                    {
                        cmd: 'Inspecter une image',
                        desc: 'docker image inspect, history, layers',
                        details: {
                            explanation: 'Examine les details, l\'historique et les layers d\'une image.',
                            syntax: 'docker image inspect IMAGE\ndocker history IMAGE',
                            options: [
                                { flag: 'inspect', desc: 'Details complets (JSON)' },
                                { flag: 'history', desc: 'Historique des layers' },
                                { flag: '--format', desc: 'Format de sortie Go template' },
                                { flag: '--no-trunc', desc: 'Affiche les commandes completes' }
                            ],
                            examples: [
                                { code: 'docker image inspect myapp:latest', desc: 'Details complets' },
                                { code: 'docker history myapp:latest --no-trunc', desc: 'Historique des layers' },
                                { code: 'docker image inspect -f "{{.Size}}" myapp:latest', desc: 'Taille de l\'image' },
                                { code: 'docker image ls --format "table {{.Repository}}\\t{{.Tag}}\\t{{.Size}}"', desc: 'Liste formatee' }
                            ],
                            tips: ['Utilisez jq pour parser le JSON', 'dive est un outil pour analyser les layers interactivement'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'run-containers',
                title: 'üöÄ Executer des Conteneurs',
                icon: 'fa-play',
                color: 'border-l-4 border-green-500',
                commands: [
                    {
                        cmd: 'Lancer un conteneur',
                        desc: 'docker run -d --name -p',
                        details: {
                            explanation: 'Demarre un nouveau conteneur a partir d\'une image.',
                            syntax: 'docker run [OPTIONS] IMAGE [COMMAND] [ARG...]',
                            options: [
                                { flag: '-d, --detach', desc: 'Mode arriere-plan (daemon)' },
                                { flag: '--name', desc: 'Nom du conteneur' },
                                { flag: '-p, --publish', desc: 'Mappe port host:container' },
                                { flag: '--rm', desc: 'Supprime le conteneur a l\'arret' },
                                { flag: '--restart', desc: 'Politique de redemarrage' }
                            ],
                            examples: [
                                { code: 'docker run -d --name web -p 8080:80 nginx', desc: 'Nginx sur port 8080' },
                                { code: 'docker run -d --name db -p 5432:5432 -e POSTGRES_PASSWORD=secret postgres:15', desc: 'PostgreSQL' },
                                { code: 'docker run --rm -p 3000:3000 myapp:latest', desc: 'Temporaire' },
                                { code: 'docker run -d --restart unless-stopped --name api myapp', desc: 'Redemarrage auto' }
                            ],
                            tips: ['--rm est pratique pour les tests', 'Utilisez --restart pour les services en production'],
                            warnings: ['Sans -d, le terminal est bloque par le conteneur']
                        }
                    },
                    {
                        cmd: 'Mode interactif et TTY',
                        desc: 'docker run -it, exec -it',
                        details: {
                            explanation: 'Lance un conteneur ou execute une commande en mode interactif avec terminal.',
                            syntax: 'docker run -it IMAGE [COMMAND]\ndocker exec -it CONTAINER COMMAND',
                            options: [
                                { flag: '-i, --interactive', desc: 'Garde STDIN ouvert' },
                                { flag: '-t, --tty', desc: 'Alloue un pseudo-TTY' },
                                { flag: '-it', desc: 'Combinaison interactive + TTY' }
                            ],
                            examples: [
                                { code: 'docker run -it ubuntu:22.04 bash', desc: 'Shell interactif Ubuntu' },
                                { code: 'docker run -it --rm python:3.11 python', desc: 'REPL Python' },
                                { code: 'docker exec -it mycontainer bash', desc: 'Shell dans conteneur existant' },
                                { code: 'docker exec -it db psql -U postgres', desc: 'CLI PostgreSQL' }
                            ],
                            tips: ['Utilisez sh si bash n\'est pas disponible (Alpine)', 'Ctrl+D ou exit pour sortir'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Variables d\'environnement',
                        desc: '-e, --env-file, .env',
                        details: {
                            explanation: 'Passe des variables d\'environnement au conteneur.',
                            syntax: 'docker run -e VAR=value IMAGE\ndocker run --env-file .env IMAGE',
                            options: [
                                { flag: '-e, --env', desc: 'Definit une variable' },
                                { flag: '--env-file', desc: 'Fichier de variables' }
                            ],
                            examples: [
                                { code: 'docker run -e NODE_ENV=production -e PORT=3000 myapp', desc: 'Variables inline' },
                                { code: 'docker run --env-file .env myapp', desc: 'Depuis fichier .env' },
                                { code: '# .env file\nDATABASE_URL=postgres://user:pass@db:5432/app\nSECRET_KEY=mysecretkey', desc: 'Exemple .env' }
                            ],
                            tips: ['--env-file est plus propre pour plusieurs variables', 'Sans valeur, -e VAR herite de l\'environnement hote'],
                            warnings: ['Ne commitez jamais .env avec des secrets!']
                        }
                    },
                    {
                        cmd: 'Limiter les ressources',
                        desc: '--memory, --cpus, --pids-limit',
                        details: {
                            explanation: 'Controle les ressources CPU, memoire et processus du conteneur.',
                            syntax: 'docker run --memory=512m --cpus=1.5 IMAGE',
                            options: [
                                { flag: '--memory, -m', desc: 'Limite memoire (ex: 512m, 2g)' },
                                { flag: '--cpus', desc: 'Nombre de CPUs (ex: 1.5)' },
                                { flag: '--pids-limit', desc: 'Limite de processus' }
                            ],
                            examples: [
                                { code: 'docker run -d --memory=512m --memory-swap=1g myapp', desc: 'Limite memoire' },
                                { code: 'docker run -d --cpus=2 --memory=1g myapp', desc: 'CPU et memoire' },
                                { code: 'docker run -d --pids-limit=100 myapp', desc: 'Limite processus' },
                                { code: 'docker stats --no-stream', desc: 'Voir utilisation ressources' }
                            ],
                            tips: ['Definissez toujours des limites en production', 'docker stats pour monitorer'],
                            warnings: ['Le conteneur est kill si depasse la memoire (OOM)']
                        }
                    },
                    {
                        cmd: 'Healthchecks',
                        desc: 'HEALTHCHECK, --health-cmd',
                        details: {
                            explanation: 'Verifie periodiquement la sante du conteneur.',
                            syntax: 'HEALTHCHECK [OPTIONS] CMD command',
                            options: [
                                { flag: '--interval', desc: 'Intervalle entre checks (defaut 30s)' },
                                { flag: '--timeout', desc: 'Timeout du check (defaut 30s)' },
                                { flag: '--retries', desc: 'Echecs avant unhealthy (defaut 3)' }
                            ],
                            examples: [
                                { code: '# Dockerfile\nHEALTHCHECK --interval=30s --timeout=10s --retries=3 \\\n  CMD curl -f http://localhost:8080/health || exit 1', desc: 'Healthcheck HTTP' },
                                { code: 'docker run -d --health-cmd="pg_isready -U postgres" \\\n  --health-interval=10s postgres:15', desc: 'PostgreSQL health' },
                                { code: 'docker inspect --format="{{.State.Health.Status}}" mycontainer', desc: 'Verifier status' }
                            ],
                            tips: ['Utilisez --start-period pour les apps lentes a demarrer', 'Les orchestrateurs utilisent le healthcheck'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'networking',
                title: 'üîó Configurer le Reseau',
                icon: 'fa-network-wired',
                color: 'border-l-4 border-cyan-500',
                commands: [
                    {
                        cmd: 'Creer un reseau personnalise',
                        desc: 'docker network create',
                        details: {
                            explanation: 'Cree un reseau Docker pour isoler et connecter les conteneurs.',
                            syntax: 'docker network create [OPTIONS] NETWORK',
                            options: [
                                { flag: '--driver, -d', desc: 'Driver (bridge, overlay, host)' },
                                { flag: '--subnet', desc: 'Subnet personnalise' },
                                { flag: '--internal', desc: 'Pas d\'acces externe' }
                            ],
                            examples: [
                                { code: 'docker network create mynetwork', desc: 'Reseau bridge simple' },
                                { code: 'docker network create --driver bridge --subnet 172.20.0.0/16 mynet', desc: 'Avec subnet' },
                                { code: 'docker network create --internal isolated', desc: 'Reseau interne' },
                                { code: 'docker network ls', desc: 'Lister les reseaux' }
                            ],
                            tips: ['Les conteneurs sur le meme reseau peuvent se joindre par nom'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Connecter conteneurs',
                        desc: '--network, bridge, overlay',
                        details: {
                            explanation: 'Connecte un conteneur a un ou plusieurs reseaux.',
                            syntax: 'docker run --network=NETWORK IMAGE\ndocker network connect NETWORK CONTAINER',
                            options: [
                                { flag: '--network', desc: 'Reseau au demarrage' },
                                { flag: 'bridge', desc: 'Reseau par defaut' },
                                { flag: 'host', desc: 'Reseau de l\'hote' },
                                { flag: 'none', desc: 'Pas de reseau' }
                            ],
                            examples: [
                                { code: 'docker run -d --network mynet --name web nginx', desc: 'Demarrer sur reseau' },
                                { code: 'docker network connect mynet existing_container', desc: 'Connecter existant' },
                                { code: 'docker run --network host nginx', desc: 'Mode host' }
                            ],
                            tips: ['Sur un meme reseau, les conteneurs se joignent par nom'],
                            warnings: ['Le mode host n\'isole pas les ports']
                        }
                    },
                    {
                        cmd: 'Exposer des ports',
                        desc: '-p host:container, EXPOSE',
                        details: {
                            explanation: 'Publie les ports du conteneur vers l\'hote.',
                            syntax: 'docker run -p [host_ip:]host_port:container_port IMAGE',
                            options: [
                                { flag: '-p 8080:80', desc: 'Port 8080 hote -> 80 conteneur' },
                                { flag: '-p 127.0.0.1:8080:80', desc: 'Localhost uniquement' },
                                { flag: '-P', desc: 'Publie tous les ports EXPOSE' }
                            ],
                            examples: [
                                { code: 'docker run -d -p 8080:80 nginx', desc: 'Nginx sur 8080' },
                                { code: 'docker run -d -p 127.0.0.1:5432:5432 postgres', desc: 'Localhost seulement' },
                                { code: 'docker port mycontainer', desc: 'Voir les mappings' }
                            ],
                            tips: ['EXPOSE ne publie pas, -p publie', 'Utilisez 127.0.0.1 pour limiter l\'acces'],
                            warnings: ['Par defaut, -p bind sur 0.0.0.0 (toutes interfaces)']
                        }
                    },
                    {
                        cmd: 'DNS et resolution de noms',
                        desc: '--dns, service discovery',
                        details: {
                            explanation: 'Configure le DNS et la resolution de noms dans les conteneurs.',
                            syntax: 'docker run --dns=8.8.8.8 IMAGE',
                            options: [
                                { flag: '--dns', desc: 'Serveur DNS personnalise' },
                                { flag: '--add-host', desc: 'Entree /etc/hosts' },
                                { flag: '--hostname', desc: 'Hostname du conteneur' }
                            ],
                            examples: [
                                { code: 'docker run --dns=8.8.8.8 myapp', desc: 'DNS Google' },
                                { code: 'docker run --add-host=myservice:192.168.1.100 myapp', desc: 'Entree hosts' },
                                { code: '# Service discovery sur reseau custom\ndocker run --network mynet --name api myapp\n# Autre conteneur: http://api:8080', desc: 'DNS automatique' }
                            ],
                            tips: ['Sur un reseau custom, les noms sont resolus automatiquement'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Inspecter le reseau',
                        desc: 'docker network inspect',
                        details: {
                            explanation: 'Examine la configuration et les conteneurs connectes a un reseau.',
                            syntax: 'docker network inspect NETWORK',
                            options: [
                                { flag: 'inspect', desc: 'Details complets (JSON)' },
                                { flag: '--format', desc: 'Format Go template' }
                            ],
                            examples: [
                                { code: 'docker network inspect mynet', desc: 'Details du reseau' },
                                { code: 'docker network inspect -f "{{range .Containers}}{{.Name}}{{end}}" mynet', desc: 'Conteneurs connectes' },
                                { code: 'docker inspect -f "{{json .NetworkSettings.Networks}}" mycontainer | jq', desc: 'Reseaux d\'un conteneur' }
                            ],
                            tips: ['Utile pour debugger les problemes de connectivite'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'volumes',
                title: 'üíæ Gerer les Volumes',
                icon: 'fa-hdd',
                color: 'border-l-4 border-yellow-500',
                commands: [
                    {
                        cmd: 'Creer un volume persistant',
                        desc: 'docker volume create',
                        details: {
                            explanation: 'Cree un volume Docker pour persister les donnees.',
                            syntax: 'docker volume create [OPTIONS] [VOLUME]',
                            options: [
                                { flag: '--name', desc: 'Nom du volume' },
                                { flag: '--driver', desc: 'Driver de stockage' }
                            ],
                            examples: [
                                { code: 'docker volume create mydata', desc: 'Volume simple' },
                                { code: 'docker volume ls', desc: 'Lister les volumes' },
                                { code: 'docker volume inspect mydata', desc: 'Details du volume' },
                                { code: 'docker volume rm mydata', desc: 'Supprimer un volume' }
                            ],
                            tips: ['Les volumes persistent meme si le conteneur est supprime'],
                            warnings: ['docker volume rm supprime les donnees definitivement']
                        }
                    },
                    {
                        cmd: 'Monter un dossier hote',
                        desc: '-v /host:/container, bind mounts',
                        details: {
                            explanation: 'Monte un repertoire de l\'hote dans le conteneur (bind mount).',
                            syntax: 'docker run -v /host/path:/container/path IMAGE',
                            options: [
                                { flag: '-v, --volume', desc: 'Syntaxe courte' },
                                { flag: '--mount', desc: 'Syntaxe explicite' },
                                { flag: ':ro', desc: 'Lecture seule' }
                            ],
                            examples: [
                                { code: 'docker run -v $(pwd):/app myapp', desc: 'Repertoire courant' },
                                { code: 'docker run -v /data/db:/var/lib/postgresql/data postgres', desc: 'Donnees DB' },
                                { code: 'docker run -v $(pwd)/config:/app/config:ro myapp', desc: 'Config read-only' }
                            ],
                            tips: ['Utilisez $(pwd) pour le chemin courant', ':ro protege les fichiers hote'],
                            warnings: ['Le chemin hote doit etre absolu']
                        }
                    },
                    {
                        cmd: 'Volumes nommes vs anonymes',
                        desc: 'Named volumes, data containers',
                        details: {
                            explanation: 'Difference entre volumes nommes (geres par Docker) et bind mounts.',
                            syntax: 'docker run -v volumename:/path IMAGE',
                            options: [
                                { flag: 'volume_name:/path', desc: 'Volume nomme' },
                                { flag: '/path', desc: 'Volume anonyme' },
                                { flag: '/host:/path', desc: 'Bind mount' }
                            ],
                            examples: [
                                { code: 'docker run -v postgres_data:/var/lib/postgresql/data postgres', desc: 'Volume nomme' },
                                { code: 'docker run -v /var/lib/mysql mysql', desc: 'Volume anonyme' },
                                { code: 'docker volume inspect postgres_data | jq ".[0].Mountpoint"', desc: 'Localisation' }
                            ],
                            tips: ['Volumes nommes: portables, geres par Docker'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Sauvegarder et restaurer',
                        desc: 'docker cp, backup strategies',
                        details: {
                            explanation: 'Copie des fichiers entre l\'hote et le conteneur, strategies de backup.',
                            syntax: 'docker cp CONTAINER:SRC_PATH DEST_PATH',
                            options: [
                                { flag: 'docker cp', desc: 'Copie fichiers' }
                            ],
                            examples: [
                                { code: 'docker cp mycontainer:/app/data ./backup/', desc: 'Copier depuis conteneur' },
                                { code: 'docker cp ./config.json mycontainer:/app/', desc: 'Copier vers conteneur' },
                                { code: '# Backup volume avec tar\ndocker run --rm -v mydata:/data -v $(pwd):/backup alpine \\\n  tar czf /backup/mydata.tar.gz -C /data .', desc: 'Backup volume' },
                                { code: 'docker exec db pg_dump -U postgres mydb > backup.sql', desc: 'Dump DB' }
                            ],
                            tips: ['Pour les DB, utilisez les outils natifs (pg_dump, mysqldump)'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'tmpfs et volumes en memoire',
                        desc: '--tmpfs, performance',
                        details: {
                            explanation: 'Monte un systeme de fichiers en memoire (RAM).',
                            syntax: 'docker run --tmpfs /path IMAGE',
                            options: [
                                { flag: '--tmpfs', desc: 'Monte tmpfs simple' },
                                { flag: 'size', desc: 'Taille max (ex: 100m)' }
                            ],
                            examples: [
                                { code: 'docker run --tmpfs /tmp myapp', desc: 'tmpfs simple' },
                                { code: 'docker run --mount type=tmpfs,target=/tmp,tmpfs-size=100m myapp', desc: 'tmpfs avec limite' }
                            ],
                            tips: ['Tres rapide (RAM)', 'Ideal pour les caches'],
                            warnings: ['Les donnees sont perdues a l\'arret']
                        }
                    }
                ]
            },
            {
                id: 'compose',
                title: 'üéº Orchestrer avec Docker Compose',
                icon: 'fa-layer-group',
                color: 'border-l-4 border-purple-500',
                commands: [
                    {
                        cmd: 'Structure docker-compose.yml',
                        desc: 'services, networks, volumes',
                        details: {
                            explanation: 'Definit une application multi-conteneurs dans un fichier YAML.',
                            syntax: 'services:\n  service_name:\n    image: ...\n    ports: [...]\nvolumes:\n  ...',
                            options: [
                                { flag: 'services', desc: 'Definition des conteneurs' },
                                { flag: 'networks', desc: 'Reseaux personnalises' },
                                { flag: 'volumes', desc: 'Volumes nommes' }
                            ],
                            examples: [
                                { code: 'services:\n  web:\n    image: nginx:alpine\n    ports:\n      - "8080:80"\n    depends_on:\n      - api\n  \n  api:\n    build: ./api\n    environment:\n      - DATABASE_URL=postgres://db:5432/app\n    depends_on:\n      - db\n  \n  db:\n    image: postgres:15\n    volumes:\n      - pgdata:/var/lib/postgresql/data\n\nvolumes:\n  pgdata:', desc: 'App complete' }
                            ],
                            tips: ['Utilisez des noms explicites pour les services'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Demarrer et arreter les services',
                        desc: 'docker compose up -d, down',
                        details: {
                            explanation: 'Demarre, arrete et gere les services.',
                            syntax: 'docker compose up [OPTIONS]\ndocker compose down [OPTIONS]',
                            options: [
                                { flag: 'up', desc: 'Demarre les services' },
                                { flag: '-d, --detach', desc: 'Mode arriere-plan' },
                                { flag: '--build', desc: 'Rebuild les images' },
                                { flag: 'down', desc: 'Arrete et supprime' },
                                { flag: '-v, --volumes', desc: 'Supprime aussi les volumes' }
                            ],
                            examples: [
                                { code: 'docker compose up -d', desc: 'Demarrer en arriere-plan' },
                                { code: 'docker compose up -d --build', desc: 'Rebuild et demarrer' },
                                { code: 'docker compose down', desc: 'Arreter et nettoyer' },
                                { code: 'docker compose down -v', desc: 'Supprimer volumes aussi' }
                            ],
                            tips: ['up --build force le rebuild des images'],
                            warnings: ['down -v supprime les donnees!']
                        }
                    },
                    {
                        cmd: 'Gerer plusieurs environnements',
                        desc: 'docker-compose.override.yml, -f',
                        details: {
                            explanation: 'Utilise plusieurs fichiers Compose pour dev, staging, production.',
                            syntax: 'docker compose -f base.yml -f override.yml up',
                            options: [
                                { flag: '-f, --file', desc: 'Fichier Compose specifique' },
                                { flag: '--profile', desc: 'Active un profil' },
                                { flag: '.override.yml', desc: 'Override automatique' }
                            ],
                            examples: [
                                { code: '# Dev (auto-merge override)\ndocker compose up -d\n\n# Production\ndocker compose -f docker-compose.yml -f docker-compose.prod.yml up -d', desc: 'Fichiers multiples' },
                                { code: 'services:\n  web:\n    image: myapp:${TAG:-latest}\n\n# Usage\nTAG=1.0.0 docker compose up -d', desc: 'Variables' }
                            ],
                            tips: ['.override.yml est merge automatiquement'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Dependances entre services',
                        desc: 'depends_on, healthcheck',
                        details: {
                            explanation: 'Controle l\'ordre de demarrage et attend que les services soient prets.',
                            syntax: 'depends_on:\n  service:\n    condition: service_healthy',
                            options: [
                                { flag: 'depends_on', desc: 'Ordre de demarrage' },
                                { flag: 'service_started', desc: 'Demarre (defaut)' },
                                { flag: 'service_healthy', desc: 'Attend healthcheck OK' }
                            ],
                            examples: [
                                { code: 'services:\n  api:\n    depends_on:\n      db:\n        condition: service_healthy\n  \n  db:\n    image: postgres:15\n    healthcheck:\n      test: pg_isready -U postgres\n      interval: 5s\n      retries: 5', desc: 'Avec healthcheck' }
                            ],
                            tips: ['service_healthy attend que la DB soit vraiment prete'],
                            warnings: ['depends_on simple n\'attend pas que le service soit pret']
                        }
                    },
                    {
                        cmd: 'Scaling et replicas',
                        desc: 'docker compose up --scale',
                        details: {
                            explanation: 'Lance plusieurs instances d\'un service pour la charge.',
                            syntax: 'docker compose up --scale SERVICE=NUM',
                            options: [
                                { flag: '--scale', desc: 'Nombre d\'instances CLI' },
                                { flag: 'deploy.replicas', desc: 'Replicas dans le fichier' }
                            ],
                            examples: [
                                { code: 'docker compose up -d --scale web=3', desc: 'Scale CLI' },
                                { code: 'services:\n  web:\n    deploy:\n      replicas: 3', desc: 'Replicas fichier' }
                            ],
                            tips: ['Utilisez un load balancer devant les replicas'],
                            warnings: ['Chaque replica a besoin d\'un port different si expose']
                        }
                    },
                    {
                        cmd: 'Logs et debugging',
                        desc: 'docker compose logs -f',
                        details: {
                            explanation: 'Affiche et suit les logs des services Compose.',
                            syntax: 'docker compose logs [OPTIONS] [SERVICE...]',
                            options: [
                                { flag: '-f, --follow', desc: 'Suit les logs en continu' },
                                { flag: '--tail', desc: 'Dernieres N lignes' }
                            ],
                            examples: [
                                { code: 'docker compose logs -f', desc: 'Tous les services' },
                                { code: 'docker compose logs -f api db', desc: 'Services specifiques' },
                                { code: 'docker compose logs --tail=100 api', desc: 'Dernieres 100 lignes' },
                                { code: 'docker compose ps', desc: 'Status des services' }
                            ],
                            tips: ['Ctrl+C pour arreter le suivi'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'debug-monitor',
                title: 'üîç Deboguer et Monitorer',
                icon: 'fa-bug',
                color: 'border-l-4 border-red-500',
                commands: [
                    {
                        cmd: 'Voir les logs d\'un conteneur',
                        desc: 'docker logs -f --tail',
                        details: {
                            explanation: 'Affiche les logs (stdout/stderr) d\'un conteneur.',
                            syntax: 'docker logs [OPTIONS] CONTAINER',
                            options: [
                                { flag: '-f, --follow', desc: 'Suit en temps reel' },
                                { flag: '--tail', desc: 'Dernieres N lignes' },
                                { flag: '--since', desc: 'Depuis (ex: 10m, 2h)' }
                            ],
                            examples: [
                                { code: 'docker logs mycontainer', desc: 'Tous les logs' },
                                { code: 'docker logs -f mycontainer', desc: 'Suivre en temps reel' },
                                { code: 'docker logs --tail 100 mycontainer', desc: 'Dernieres 100 lignes' },
                                { code: 'docker logs --since 1h mycontainer', desc: 'Derniere heure' }
                            ],
                            tips: ['Les logs sont stdout et stderr du PID 1'],
                            warnings: ['Les logs peuvent devenir tres volumineux']
                        }
                    },
                    {
                        cmd: 'Inspecter un conteneur',
                        desc: 'docker inspect, stats',
                        details: {
                            explanation: 'Examine la configuration complete et l\'etat d\'un conteneur.',
                            syntax: 'docker inspect CONTAINER\ndocker stats [CONTAINER...]',
                            options: [
                                { flag: 'inspect', desc: 'Configuration complete (JSON)' },
                                { flag: '--format', desc: 'Template Go' },
                                { flag: 'stats', desc: 'Ressources en temps reel' }
                            ],
                            examples: [
                                { code: 'docker inspect mycontainer', desc: 'Details complets' },
                                { code: 'docker inspect -f "{{.State.Status}}" mycontainer', desc: 'Status' },
                                { code: 'docker inspect -f "{{.NetworkSettings.IPAddress}}" mycontainer', desc: 'Adresse IP' },
                                { code: 'docker stats', desc: 'Ressources temps reel' }
                            ],
                            tips: ['jq est pratique pour parser le JSON'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Executer une commande dans un conteneur',
                        desc: 'docker exec -it bash',
                        details: {
                            explanation: 'Execute une commande dans un conteneur en cours d\'execution.',
                            syntax: 'docker exec [OPTIONS] CONTAINER COMMAND [ARG...]',
                            options: [
                                { flag: '-i, --interactive', desc: 'STDIN interactif' },
                                { flag: '-t, --tty', desc: 'Pseudo-terminal' },
                                { flag: '-u, --user', desc: 'Utilisateur' }
                            ],
                            examples: [
                                { code: 'docker exec -it mycontainer bash', desc: 'Shell bash' },
                                { code: 'docker exec -it mycontainer sh', desc: 'Shell sh (Alpine)' },
                                { code: 'docker exec mycontainer ls -la /app', desc: 'Commande simple' },
                                { code: 'docker exec -u root mycontainer apt-get update', desc: 'En tant que root' }
                            ],
                            tips: ['Utilisez sh si bash n\'est pas disponible'],
                            warnings: ['exec ne fonctionne que sur conteneurs running']
                        }
                    },
                    {
                        cmd: 'Surveiller les ressources',
                        desc: 'docker stats, ctop',
                        details: {
                            explanation: 'Monitore l\'utilisation CPU, memoire, reseau et I/O.',
                            syntax: 'docker stats [OPTIONS] [CONTAINER...]',
                            options: [
                                { flag: 'docker stats', desc: 'Stats temps reel' },
                                { flag: '--no-stream', desc: 'Une seule mesure' },
                                { flag: '--format', desc: 'Format personnalise' }
                            ],
                            examples: [
                                { code: 'docker stats', desc: 'Tous les conteneurs' },
                                { code: 'docker stats --format "table {{.Name}}\\t{{.CPUPerc}}\\t{{.MemPerc}}"', desc: 'Format table' },
                                { code: 'docker system df', desc: 'Espace disque Docker' }
                            ],
                            tips: ['ctop offre une interface type htop pour Docker'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Deboguer un build echoue',
                        desc: '--progress=plain, --no-cache',
                        details: {
                            explanation: 'Options pour diagnostiquer les problemes de build d\'image.',
                            syntax: 'docker build --progress=plain --no-cache .',
                            options: [
                                { flag: '--progress=plain', desc: 'Output complet' },
                                { flag: '--no-cache', desc: 'Sans cache' },
                                { flag: '--target', desc: 'Arrete a un stage' }
                            ],
                            examples: [
                                { code: 'docker build --progress=plain -t myapp .', desc: 'Output detaille' },
                                { code: 'docker build --no-cache -t myapp .', desc: 'Sans cache' },
                                { code: 'docker build --target builder -t myapp:debug .', desc: 'Jusqu\'au stage builder' }
                            ],
                            tips: ['--progress=plain montre les commandes RUN completes'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'security',
                title: 'üîê Securiser les Conteneurs',
                icon: 'fa-shield-alt',
                color: 'border-l-4 border-orange-500',
                commands: [
                    {
                        cmd: 'Utilisateur non-root',
                        desc: 'USER directive, --user',
                        details: {
                            explanation: 'Execute le conteneur avec un utilisateur non-privilegie.',
                            syntax: 'USER username\ndocker run --user 1000:1000 IMAGE',
                            options: [
                                { flag: 'USER', desc: 'Directive Dockerfile' },
                                { flag: '--user, -u', desc: 'Override au runtime' }
                            ],
                            examples: [
                                { code: '# Dockerfile\nFROM python:3.11-slim\nRUN useradd -m -u 1000 appuser\nWORKDIR /app\nCOPY --chown=appuser:appuser . .\nUSER appuser\nCMD ["python", "app.py"]', desc: 'Utilisateur dans Dockerfile' },
                                { code: 'docker run --user 1000:1000 myapp', desc: 'Override runtime' },
                                { code: 'docker run --user $(id -u):$(id -g) myapp', desc: 'UID/GID de l\'hote' }
                            ],
                            tips: ['Toujours utiliser un user non-root en production'],
                            warnings: ['Certaines images requierent root']
                        }
                    },
                    {
                        cmd: 'Scanner les vulnerabilites',
                        desc: 'docker scout, trivy',
                        details: {
                            explanation: 'Analyse les images pour detecter les CVE.',
                            syntax: 'docker scout cves IMAGE\ntrivy image IMAGE',
                            options: [
                                { flag: 'docker scout', desc: 'Scanner integre Docker' },
                                { flag: 'trivy', desc: 'Scanner open source' }
                            ],
                            examples: [
                                { code: 'docker scout cves myapp:latest', desc: 'Docker Scout' },
                                { code: 'trivy image myapp:latest', desc: 'Trivy scan' },
                                { code: 'trivy image --severity HIGH,CRITICAL myapp:latest', desc: 'Trivy severite' },
                                { code: 'trivy image --exit-code 1 --severity CRITICAL myapp:latest', desc: 'Fail si critique' }
                            ],
                            tips: ['Integrez le scan dans votre CI/CD'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Secrets et configs',
                        desc: 'docker secret, configs',
                        details: {
                            explanation: 'Gere les donnees sensibles de maniere securisee.',
                            syntax: 'docker secret create NAME FILE',
                            options: [
                                { flag: 'secret', desc: 'Donnees sensibles (chiffrees)' },
                                { flag: 'config', desc: 'Fichiers de configuration' }
                            ],
                            examples: [
                                { code: 'services:\n  db:\n    environment:\n      POSTGRES_PASSWORD_FILE: /run/secrets/db_password\n    secrets:\n      - db_password\n\nsecrets:\n  db_password:\n    file: ./secrets/db_password.txt', desc: 'Secret depuis fichier' }
                            ],
                            tips: ['Les secrets sont montes dans /run/secrets/'],
                            warnings: ['Ne commitez jamais les fichiers de secrets']
                        }
                    },
                    {
                        cmd: 'Capacites et permissions',
                        desc: '--cap-drop, --read-only',
                        details: {
                            explanation: 'Reduit les privileges et capacites Linux du conteneur.',
                            syntax: 'docker run --cap-drop=ALL --cap-add=NEEDED IMAGE',
                            options: [
                                { flag: '--cap-drop', desc: 'Retire une capacite' },
                                { flag: '--cap-add', desc: 'Ajoute une capacite' },
                                { flag: '--read-only', desc: 'Filesystem read-only' }
                            ],
                            examples: [
                                { code: 'docker run --cap-drop=ALL --cap-add=NET_BIND_SERVICE myapp', desc: 'Minimum de caps' },
                                { code: 'docker run --read-only --tmpfs /tmp myapp', desc: 'Read-only avec tmpfs' },
                                { code: 'docker run --security-opt=no-new-privileges myapp', desc: 'Pas de privilege escalation' }
                            ],
                            tips: ['--cap-drop=ALL puis ajoutez seulement le necessaire'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'publish',
                title: 'üì§ Publier et Distribuer',
                icon: 'fa-cloud-upload-alt',
                color: 'border-l-4 border-indigo-500',
                commands: [
                    {
                        cmd: 'Se connecter a un registry',
                        desc: 'docker login',
                        details: {
                            explanation: 'Authentifie Docker aupres d\'un registry.',
                            syntax: 'docker login [OPTIONS] [SERVER]',
                            options: [
                                { flag: '-u, --username', desc: 'Nom d\'utilisateur' },
                                { flag: '--password-stdin', desc: 'Lit le password depuis stdin' }
                            ],
                            examples: [
                                { code: 'docker login', desc: 'Docker Hub (interactif)' },
                                { code: 'docker login ghcr.io', desc: 'GitHub Container Registry' },
                                { code: 'echo $DOCKER_TOKEN | docker login -u username --password-stdin', desc: 'Non-interactif (CI)' },
                                { code: 'docker logout', desc: 'Se deconnecter' }
                            ],
                            tips: ['Utilisez --password-stdin en CI'],
                            warnings: ['Ne passez jamais le password en argument -p']
                        }
                    },
                    {
                        cmd: 'Pousser une image',
                        desc: 'docker push',
                        details: {
                            explanation: 'Envoie une image locale vers un registry distant.',
                            syntax: 'docker push [OPTIONS] NAME[:TAG]',
                            options: [
                                { flag: '-a, --all-tags', desc: 'Pousse tous les tags' }
                            ],
                            examples: [
                                { code: 'docker tag myapp:latest username/myapp:latest\ndocker push username/myapp:latest', desc: 'Docker Hub' },
                                { code: 'docker tag myapp:latest ghcr.io/username/myapp:1.0.0\ndocker push ghcr.io/username/myapp:1.0.0', desc: 'GitHub GHCR' }
                            ],
                            tips: ['Taggez avec le nom complet du registry avant push'],
                            warnings: ['Le tag doit correspondre au registry cible']
                        }
                    },
                    {
                        cmd: 'Registry prive',
                        desc: 'Harbor, AWS ECR, Azure ACR',
                        details: {
                            explanation: 'Configure et utilise des registries prives.',
                            syntax: 'docker login REGISTRY_URL\ndocker push REGISTRY_URL/image:tag',
                            options: [
                                { flag: 'Harbor', desc: 'Registry open source' },
                                { flag: 'AWS ECR', desc: 'Elastic Container Registry' },
                                { flag: 'Azure ACR', desc: 'Azure Container Registry' }
                            ],
                            examples: [
                                { code: 'aws ecr get-login-password | docker login --username AWS --password-stdin 123456789.dkr.ecr.eu-west-1.amazonaws.com', desc: 'AWS ECR' },
                                { code: 'az acr login --name myregistry\ndocker push myregistry.azurecr.io/myapp:latest', desc: 'Azure ACR' }
                            ],
                            tips: ['Utilisez les outils cloud pour l\'authentification'],
                            warnings: ['Les tokens ECR expirent apres 12h']
                        }
                    },
                    {
                        cmd: 'Sauvegarder/charger images',
                        desc: 'docker save, docker load',
                        details: {
                            explanation: 'Exporte et importe des images comme fichiers tar.',
                            syntax: 'docker save -o file.tar IMAGE\ndocker load -i file.tar',
                            options: [
                                { flag: 'save', desc: 'Exporte image vers tar' },
                                { flag: 'load', desc: 'Importe image depuis tar' }
                            ],
                            examples: [
                                { code: 'docker save -o myapp.tar myapp:latest', desc: 'Sauvegarder' },
                                { code: 'docker save myapp:latest | gzip > myapp.tar.gz', desc: 'Compresse' },
                                { code: 'docker load -i myapp.tar', desc: 'Charger' },
                                { code: 'gunzip -c myapp.tar.gz | docker load', desc: 'Charger compresse' }
                            ],
                            tips: ['Utile pour les environnements sans acces internet'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'cleanup',
                title: 'üßπ Nettoyer et Optimiser',
                icon: 'fa-broom',
                color: 'border-l-4 border-teal-500',
                commands: [
                    {
                        cmd: 'Supprimer conteneurs arretes',
                        desc: 'docker container prune',
                        details: {
                            explanation: 'Supprime tous les conteneurs qui ne sont pas en cours d\'execution.',
                            syntax: 'docker container prune [OPTIONS]',
                            options: [
                                { flag: '-f, --force', desc: 'Sans confirmation' },
                                { flag: '--filter', desc: 'Filtre (ex: until=24h)' }
                            ],
                            examples: [
                                { code: 'docker container prune', desc: 'Interactif' },
                                { code: 'docker container prune -f', desc: 'Sans confirmation' },
                                { code: 'docker container prune --filter "until=24h"', desc: 'Plus de 24h' }
                            ],
                            tips: ['Utilisez --filter pour etre selectif'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Supprimer images inutilisees',
                        desc: 'docker image prune -a',
                        details: {
                            explanation: 'Supprime les images non utilisees par des conteneurs.',
                            syntax: 'docker image prune [OPTIONS]',
                            options: [
                                { flag: 'prune', desc: 'Images dangling (sans tag)' },
                                { flag: '-a, --all', desc: 'Toutes les images inutilisees' },
                                { flag: '-f, --force', desc: 'Sans confirmation' }
                            ],
                            examples: [
                                { code: 'docker image prune', desc: 'Images dangling' },
                                { code: 'docker image prune -a', desc: 'Toutes inutilisees' },
                                { code: 'docker image prune -a --filter "until=168h"', desc: 'Plus d\'une semaine' }
                            ],
                            tips: ['-a supprime aussi les images taggees non utilisees'],
                            warnings: ['prune -a peut supprimer des images que vous voulez garder']
                        }
                    },
                    {
                        cmd: 'Nettoyer tout',
                        desc: 'docker system prune',
                        details: {
                            explanation: 'Supprime toutes les ressources Docker non utilisees.',
                            syntax: 'docker system prune [OPTIONS]',
                            options: [
                                { flag: '-a, --all', desc: 'Inclut images non utilisees' },
                                { flag: '--volumes', desc: 'Inclut les volumes' },
                                { flag: '-f, --force', desc: 'Sans confirmation' }
                            ],
                            examples: [
                                { code: 'docker system prune', desc: 'Nettoyage de base' },
                                { code: 'docker system prune -a', desc: 'Avec images' },
                                { code: 'docker system prune -a --volumes', desc: 'Tout (ATTENTION!)' }
                            ],
                            tips: ['Ideal pour recuperer de l\'espace disque rapidement'],
                            warnings: ['--volumes supprime les donnees des volumes!']
                        }
                    },
                    {
                        cmd: 'Analyser l\'espace disque',
                        desc: 'docker system df',
                        details: {
                            explanation: 'Affiche l\'utilisation de l\'espace disque par Docker.',
                            syntax: 'docker system df [OPTIONS]',
                            options: [
                                { flag: 'df', desc: 'Resume de l\'espace' },
                                { flag: '-v, --verbose', desc: 'Details par ressource' }
                            ],
                            examples: [
                                { code: 'docker system df', desc: 'Resume' },
                                { code: 'docker system df -v', desc: 'Details' },
                                { code: 'docker images --format "{{.Size}}\\t{{.Repository}}:{{.Tag}}" | sort -h', desc: 'Images par taille' }
                            ],
                            tips: ['RECLAIMABLE montre ce que prune peut liberer'],
                            warnings: []
                        }
                    }
                ]
            },
            {
                id: 'project-app',
                title: 'üéØ Projet: App Multi-Services',
                icon: 'fa-project-diagram',
                color: 'border-l-4 border-emerald-500',
                commands: [
                    {
                        cmd: 'Etape 1: Backend (Python/Node)',
                        desc: 'Dockerfile, requirements/package.json',
                        details: {
                            explanation: 'Dockerise une application backend Python ou Node.js.',
                            syntax: 'FROM python:3.11-slim\nFROM node:20-alpine',
                            options: [],
                            examples: [
                                { code: '# Dockerfile.backend (Python FastAPI)\nFROM python:3.11-slim\nWORKDIR /app\nCOPY requirements.txt .\nRUN pip install --no-cache-dir -r requirements.txt\nCOPY . .\nRUN useradd -m appuser && chown -R appuser:appuser /app\nUSER appuser\nEXPOSE 8000\nCMD ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "8000"]', desc: 'Python FastAPI' },
                                { code: '# Dockerfile.backend (Node.js Express)\nFROM node:20-alpine\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci --only=production\nCOPY . .\nRUN adduser -D appuser && chown -R appuser:appuser /app\nUSER appuser\nEXPOSE 3000\nCMD ["node", "server.js"]', desc: 'Node.js Express' }
                            ],
                            tips: ['Copiez les fichiers de dependances en premier pour le cache'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Etape 2: Frontend (React/Vue)',
                        desc: 'Multi-stage build, nginx',
                        details: {
                            explanation: 'Build le frontend et sert les fichiers statiques avec Nginx.',
                            syntax: 'FROM node AS builder\nFROM nginx:alpine',
                            options: [],
                            examples: [
                                { code: '# Dockerfile.frontend (React)\nFROM node:20-alpine AS builder\nWORKDIR /app\nCOPY package*.json ./\nRUN npm ci\nCOPY . .\nRUN npm run build\n\nFROM nginx:alpine\nCOPY --from=builder /app/dist /usr/share/nginx/html\nCOPY nginx.conf /etc/nginx/conf.d/default.conf\nEXPOSE 80\nCMD ["nginx", "-g", "daemon off;"]', desc: 'React multi-stage' },
                                { code: '# nginx.conf\nserver {\n    listen 80;\n    root /usr/share/nginx/html;\n    location / {\n        try_files $uri $uri/ /index.html;\n    }\n    location /api/ {\n        proxy_pass http://api:8000/;\n    }\n}', desc: 'nginx.conf' }
                            ],
                            tips: ['Multi-stage: node pour build, nginx pour servir'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Etape 3: Base de donnees',
                        desc: 'PostgreSQL/MySQL, volumes',
                        details: {
                            explanation: 'Configure la base de donnees avec persistance des donnees.',
                            syntax: 'image: postgres:15\nvolumes:\n  - pgdata:/var/lib/postgresql/data',
                            options: [],
                            examples: [
                                { code: 'services:\n  db:\n    image: postgres:15-alpine\n    environment:\n      POSTGRES_USER: app\n      POSTGRES_PASSWORD_FILE: /run/secrets/db_password\n      POSTGRES_DB: appdb\n    volumes:\n      - pgdata:/var/lib/postgresql/data\n    healthcheck:\n      test: pg_isready -U app -d appdb\n      interval: 10s\n      retries: 5\n    secrets:\n      - db_password\n\nsecrets:\n  db_password:\n    file: ./secrets/db_password.txt', desc: 'PostgreSQL' },
                                { code: '  redis:\n    image: redis:7-alpine\n    command: redis-server --appendonly yes\n    volumes:\n      - redisdata:/data', desc: 'Redis' }
                            ],
                            tips: ['Utilisez healthcheck pour depends_on condition'],
                            warnings: ['Protegez toujours le mot de passe de la DB']
                        }
                    },
                    {
                        cmd: 'Etape 4: Compose orchestration',
                        desc: 'docker-compose.yml complet',
                        details: {
                            explanation: 'Assemble tous les services dans un fichier docker-compose.yml.',
                            syntax: 'docker compose up -d',
                            options: [],
                            examples: [
                                { code: 'services:\n  frontend:\n    build: ./frontend\n    ports:\n      - "80:80"\n    depends_on:\n      - api\n    networks:\n      - frontend\n\n  api:\n    build: ./backend\n    environment:\n      DATABASE_URL: postgres://app:${DB_PASSWORD}@db:5432/appdb\n      REDIS_URL: redis://redis:6379\n    depends_on:\n      db:\n        condition: service_healthy\n    networks:\n      - frontend\n      - backend\n\n  db:\n    image: postgres:15-alpine\n    volumes:\n      - pgdata:/var/lib/postgresql/data\n    healthcheck:\n      test: pg_isready -U app -d appdb\n      interval: 10s\n    networks:\n      - backend\n\n  redis:\n    image: redis:7-alpine\n    networks:\n      - backend\n\nnetworks:\n  frontend:\n  backend:\n\nvolumes:\n  pgdata:', desc: 'Compose complet' }
                            ],
                            tips: ['Separarez les reseaux frontend/backend pour l\'isolation'],
                            warnings: []
                        }
                    },
                    {
                        cmd: 'Etape 5: CI/CD integration',
                        desc: 'GitHub Actions, GitLab CI',
                        details: {
                            explanation: 'Automatise le build et le deploiement avec CI/CD.',
                            syntax: 'workflow ou .gitlab-ci.yml',
                            options: [],
                            examples: [
                                { code: '# .github/workflows/deploy.yml\nname: Build and Deploy\n\non:\n  push:\n    branches: [main]\n\njobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v4\n      \n      - name: Login to Registry\n        uses: docker/login-action@v3\n        with:\n          registry: ghcr.io\n          username: ${{ github.actor }}\n          password: ${{ secrets.GITHUB_TOKEN }}\n      \n      - name: Build and push\n        uses: docker/build-push-action@v5\n        with:\n          context: .\n          push: true\n          tags: |\n            ghcr.io/${{ github.repository }}:${{ github.sha }}\n            ghcr.io/${{ github.repository }}:latest', desc: 'GitHub Actions' },
                                { code: '# .gitlab-ci.yml\nstages:\n  - build\n  - deploy\n\nbuild:\n  stage: build\n  image: docker:24\n  services:\n    - docker:24-dind\n  script:\n    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY\n    - docker build -t $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA .\n    - docker push $CI_REGISTRY_IMAGE:$CI_COMMIT_SHA', desc: 'GitLab CI' }
                            ],
                            tips: ['Taggez avec le SHA du commit pour la tracabilite'],
                            warnings: ['Ne stockez jamais de secrets dans le code']
                        }
                    }
                ]
            }
        ];
    </script>
    <script src="../js/cheatsheet.js"></script>
</body>
</html>
